import{ah as y,B as c,aj as w,ak as e,ao as d,aG as C,aH as A,aI as _,aJ as S,an as U,aK as k}from"./index-CPERY6Kl.js";import{u as F}from"./permissions-C8EIoUeu.js";import{C as P}from"./calendar-a85ssUeG.js";import{F as L}from"./folder-open-DzDBH55X.js";const T=()=>{const{user:h}=y(),{canViewActivities:p}=F(h),[x,g]=c.useState([]),[j,m]=c.useState(!0),[l,u]=c.useState({target:"",action:"",search:""}),[t,n]=c.useState({current:1,pages:1,total:0});c.useEffect(()=>{v()},[l,t.current]);const v=async()=>{try{m(!0);const s=new URLSearchParams({page:t.current,limit:20,...l}),a=await w.get(`/api/activities?${s}`);g(a.data.activities),n(a.data.pagination)}catch(s){console.error("Error fetching activities:",s)}finally{m(!1)}},i=(s,a)=>{u(r=>({...r,[s]:a})),n(r=>({...r,current:1}))},o=s=>{n(a=>({...a,current:s}))},b=s=>s.includes("employee")||s.includes("telecaller")?e.jsx(U,{className:"h-5 w-5 text-blue-500"}):s.includes("project")?e.jsx(L,{className:"h-5 w-5 text-green-500"}):s==="login"||s==="logout"?e.jsx(k,{className:"h-5 w-5 text-purple-500"}):e.jsx(d,{className:"h-5 w-5 text-gray-500"}),f=s=>{switch(s){case"user_created":case"project_created":return"text-green-600 bg-green-100";case"user_updated":case"project_updated":case"project_status_changed":return"text-blue-600 bg-blue-100";case"user_deleted":case"project_deleted":return"text-red-600 bg-red-100";case"login":return"text-purple-600 bg-purple-100";case"logout":return"text-gray-600 bg-gray-100";default:return"text-gray-600 bg-gray-100"}},N=s=>typeof s!="string"||s.length===0?"":s.charAt(0).toUpperCase()+s.slice(1);return p?e.jsxs("div",{className:"max-w-7xl pb-4 mx-auto px-4 sm:px-6 lg:px-8 animate-fade-in",children:[e.jsxs("div",{className:"mb-8",children:[e.jsx("h1",{className:"text-3xl font-bold text-gray-900 mb-2",children:"Activity Log"}),e.jsx("p",{className:"text-gray-600",children:"Track all system activities and user actions"})]}),e.jsx("div",{className:"card mb-6",children:e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"form-label",children:"Search"}),e.jsxs("div",{className:"relative",children:[e.jsx(C,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400",size:16}),e.jsx("input",{type:"text",className:"form-input pl-10",placeholder:"Search activities...",value:l.search,onChange:s=>i("search",s.target.value)})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"form-label",children:"Target"}),e.jsxs("select",{className:"form-select",value:l.target,onChange:s=>i("target",s.target.value),children:[e.jsx("option",{value:"",children:"All Targets"}),e.jsx("option",{value:"user",children:"Users"}),e.jsx("option",{value:"project",children:"Projects"}),e.jsx("option",{value:"system",children:"System"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"form-label",children:"Action"}),e.jsxs("select",{className:"form-select",value:l.action,onChange:s=>i("action",s.target.value),children:[e.jsx("option",{value:"",children:"All Actions"}),e.jsx("option",{value:"user_created",children:"User Created"}),e.jsx("option",{value:"user_updated",children:"User Updated"}),e.jsx("option",{value:"user_deleted",children:"User Deleted"}),e.jsx("option",{value:"project_created",children:"Project Created"}),e.jsx("option",{value:"project_updated",children:"Project Updated"}),e.jsx("option",{value:"project_deleted",children:"Project Deleted"}),e.jsx("option",{value:"project_status_changed",children:"Status Changed"}),e.jsx("option",{value:"login",children:"Login"}),e.jsx("option",{value:"logout",children:"Logout"})]})]}),e.jsx("div",{className:"flex items-end",children:e.jsxs("button",{onClick:()=>{u({target:"",action:"",search:""}),n(s=>({...s,current:1}))},className:"btn btn-secondary w-full",children:[e.jsx(A,{size:16}),"Clear Filters"]})})]})}),e.jsx("div",{className:"card",children:j?e.jsx("div",{className:"flex items-center justify-center py-12",children:e.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-primary-600"})}):x.length===0?e.jsxs("div",{className:"text-center py-12",children:[e.jsx(d,{className:"mx-auto h-12 w-12 text-gray-400 mb-4"}),e.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:"No Activities Found"}),e.jsx("p",{className:"text-gray-500",children:"Try adjusting your filters to see more results."})]}):e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"space-y-4",children:x.map(s=>e.jsxs("div",{className:"flex items-start space-x-4 p-4 border border-gray-200 rounded-lg hover:bg-gray-50 transition-colors",children:[e.jsx("div",{className:"flex-shrink-0 mt-1",children:b(s.action)}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("span",{className:`px-2 py-1 rounded-full text-xs font-medium ${f(s.action)}`,children:s.action.replace("_"," ").toUpperCase()}),e.jsxs("span",{className:"text-sm text-gray-500",children:["by ",s.user?.name||"Unknown User"]})]}),e.jsxs("div",{className:"flex items-center text-xs text-gray-500",children:[e.jsx(P,{size:12,className:"mr-1"}),new Date(s.createdAt).toLocaleString()]})]}),e.jsx("p",{className:"text-sm text-gray-900 mb-2",children:N(s.description)}),s.metadata&&Object.keys(s.metadata).length>0&&e.jsxs("div",{className:"text-xs text-gray-500 bg-gray-100 rounded p-2",children:[e.jsx("strong",{children:"Details:"})," ",JSON.stringify(s.metadata,null,2)]})]})]},s.id))}),t.pages>1&&e.jsxs("div",{className:"flex items-center justify-between mt-6 pt-6 border-t border-gray-200",children:[e.jsxs("div",{className:"text-sm text-gray-700",children:["Showing page ",t.current," of ",t.pages," (",t.total," total activities)"]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsxs("button",{onClick:()=>o(t.current-1),disabled:t.current===1,className:"btn btn-secondary disabled:opacity-50 disabled:cursor-not-allowed",children:[e.jsx(_,{size:16}),"Previous"]}),e.jsx("div",{className:"flex items-center space-x-1",children:Array.from({length:Math.min(5,t.pages)},(s,a)=>{const r=a+1;return e.jsx("button",{onClick:()=>o(r),className:`px-3 py-1 rounded text-sm ${r===t.current?"bg-primary-600 text-white":"bg-gray-200 text-gray-700 hover:bg-gray-300"}`,children:r},r)})}),e.jsxs("button",{onClick:()=>o(t.current+1),disabled:t.current===t.pages,className:"btn btn-secondary disabled:opacity-50 disabled:cursor-not-allowed",children:["Next",e.jsx(S,{size:16})]})]})]})]})})]}):e.jsx("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:e.jsxs("div",{className:"text-center py-12",children:[e.jsx(d,{className:"mx-auto h-12 w-12 text-gray-400 mb-4"}),e.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:"Access Restricted"}),e.jsx("p",{className:"text-gray-500",children:"You don't have permission to view activity logs."})]})})};export{T as default};
//# sourceMappingURL=Activities-mAXcavCd.js.map
