import{c as O,ah as xe,B as r,ak as e,al as me,ap as G,aT as ie,aO as K,am as Q,ao as ge,aB as R,aU as he,aI as W,aJ as Z,aF as pe,an as ue,aV as ye}from"./index-CPERY6Kl.js";import{P as be,C as fe}from"./phone-DTKNWmnz.js";import{e as je,E as Ne,f as we,p as ve,L as ee}from"./helpers-DVpO63iy.js";import{a as Se,b as ke,u as Ce,f as z,c as le,d as Y}from"./helpers-CK_3Qtj6.js";import{c as Pe,d as Me,e as De,a as Re,f as ze,b as Ee}from"./useMautic-CVm8zvix.js";import{C as Fe}from"./calendar-a85ssUeG.js";const Le=[["path",{d:"M10 12h4",key:"a56b0p"}],["path",{d:"M10 8h4",key:"1sr2af"}],["path",{d:"M14 21v-3a2 2 0 0 0-4 0v3",key:"1rgiei"}],["path",{d:"M6 10H4a2 2 0 0 0-2 2v7a2 2 0 0 0 2 2h16a2 2 0 0 0 2-2V9a2 2 0 0 0-2-2h-2",key:"secmi2"}],["path",{d:"M6 21V5a2 2 0 0 1 2-2h8a2 2 0 0 1 2 2v16",key:"16ra0t"}]],Te=O("building-2",Le);const Ae=[["path",{d:"M14 4.1 12 6",key:"ita8i4"}],["path",{d:"m5.1 8-2.9-.8",key:"1go3kf"}],["path",{d:"m6 12-1.9 2",key:"mnht97"}],["path",{d:"M7.2 2.2 8 5.1",key:"1cfko1"}],["path",{d:"M9.037 9.69a.498.498 0 0 1 .653-.653l11 4.5a.5.5 0 0 1-.074.949l-4.349 1.041a1 1 0 0 0-.74.739l-1.04 4.35a.5.5 0 0 1-.95.074z",key:"s0h3yz"}]],$e=O("mouse-pointer-click",Ae);const Ie=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["circle",{cx:"12",cy:"12",r:"6",key:"1vlfrh"}],["circle",{cx:"12",cy:"12",r:"2",key:"1c9p78"}]],ne=O("target",Ie);const _e=[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["line",{x1:"17",x2:"22",y1:"8",y2:"13",key:"3nzzx3"}],["line",{x1:"22",x2:"17",y1:"8",y2:"13",key:"1swrse"}]],Ue=O("user-x",_e),Ve="https://dev.hcddev.com",Be=({campaigns:i})=>{const{user:d}=xe(),[l,c]=r.useState([]),[o,x]=r.useState(0),[s,j]=r.useState(1),[h,b]=r.useState(!1),[a,_]=r.useState({totalVoicemailsSent:0,successfulDeliveries:0,deliveryRate:0,failedDeliveries:0,failureRate:0,otherStatus:0,otherStatusRate:0,totalCampaignCost:0});r.useEffect(()=>{try{const t=window.localStorage.getItem("dc_records_page");if(t){const n=parseInt(t,10);!Number.isNaN(n)&&n>=1&&j(n)}}catch{}},[]),r.useEffect(()=>{const t=(()=>{try{return parseInt(window.localStorage.getItem("dc_records_page"),10)||1}catch{return 1}})();D(t)},[]);const v=r.useRef(null),U=r.useRef(0),A=r.useRef(!1),[F,E]=r.useState(!0),[L,$]=r.useState(""),[S,k]=r.useState("all"),[m,f]=r.useState("all"),[p,C]=r.useState({startDate:"",endDate:""}),[P,V]=r.useState(!1),[I,T]=r.useState(""),w=50,B=({compact:t=!1})=>e.jsxs("tr",{className:"opacity-100 animate-pulse",children:[e.jsx("td",{className:"sticky left-0 bg-white px-3 py-3 border-r border-gray-200 z-10",children:e.jsx("div",{className:"h-3 bg-gray-200 rounded w-20"})}),e.jsx("td",{className:"px-3 py-3",children:e.jsx("div",{className:"h-3 bg-gray-200 rounded w-32"})}),e.jsx("td",{className:"px-3 py-3 whitespace-nowrap",children:e.jsx("div",{className:"h-3 bg-gray-200 rounded w-24"})}),e.jsx("td",{className:"px-3 py-3 whitespace-nowrap",children:e.jsx("div",{className:"h-3 bg-gray-200 rounded w-20"})}),e.jsx("td",{className:"px-3 py-3 whitespace-nowrap",children:e.jsx("div",{className:"h-3 bg-gray-200 rounded w-16"})}),e.jsx("td",{className:"px-3 py-3",children:e.jsx("div",{className:"h-3 bg-gray-200 rounded w-16"})}),e.jsx("td",{className:"px-3 py-3",children:e.jsx("div",{className:"h-3 bg-gray-200 rounded w-16"})}),e.jsx("td",{className:"px-3 py-3",children:e.jsx("div",{className:"h-3 bg-gray-200 rounded w-28"})})]});r.useEffect(()=>{if(i&&i.length>0&&l.length===0){const t=i.flatMap(n=>n.records.map(y=>({...y,campaignName:n.campaignName,client:n.client||"Unknown"})));c(t.slice(0,w)),x(t.length)}},[i]);const u=Array.from(new Set(l.map(t=>t.client||"Unknown").concat((i||[]).map(t=>t.client||"Unknown")))).filter(Boolean).sort((t,n)=>t.localeCompare(n));r.useEffect(()=>{const t=v.current;E(!1);const n=setTimeout(()=>{if(E(!0),t)try{if(A.current){const y=Math.max(0,t.scrollHeight-t.clientHeight);t.scrollTop=Math.round(U.current*y)}else t.scrollTo({top:0,behavior:"smooth"})}catch{}},60);return()=>clearTimeout(n)},[s]);const H=l,M=Math.max(1,Math.ceil(o/w)),de=t=>{const n=t?.toLowerCase()||"";return["sent","success","delivered"].includes(n)?e.jsx("span",{className:"px-2 py-1 text-xs font-medium rounded-full bg-green-100 text-green-800",children:"Delivered"}):["failed","failure","error"].includes(n)?e.jsx("span",{className:"px-2 py-1 text-xs font-medium rounded-full bg-red-100 text-red-800",children:"Failed"}):e.jsx("span",{className:"px-2 py-1 text-xs font-medium rounded-full bg-gray-100 text-gray-800",children:t||"Unknown"})};r.useEffect(()=>{D(1)},[L,S,p]),r.useEffect(()=>{D(1)},[m]);const[q,te]=r.useState(""),[se,J]=r.useState(!1),ae=()=>{const t=parseInt(q,10);if(Number.isNaN(t))return;if(t<1||t>M){J(!0);return}const n=t;D(n),te(""),J(!1);try{window.localStorage.setItem("dc_records_page",String(n))}catch{}};r.useEffect(()=>{se&&J(!1)},[q]),r.useEffect(()=>{try{window.localStorage.setItem("dc_records_page",String(s))}catch{}},[s]);async function D(t=1){b(!0);const n=w,y=new URLSearchParams;y.set("limit",String(n)),y.set("page",String(t)),m&&m!=="all"&&y.set("client",m),p.startDate&&y.set("startDate",p.startDate),p.endDate&&y.set("endDate",p.endDate),S&&S!=="all"&&y.set("status",S),L&&y.set("q",L);try{const N=await(await fetch(`${Ve}/api/dropcowboy/records?${y.toString()}`)).json();if(N.success){const X=N.data&&Array.isArray(N.data.records)?N.data.records:[],ce=N.data&&N.data.pagination&&N.data.pagination.totalRecords||X.length;N.data&&N.data.metrics&&_(N.data.metrics);const oe=X.map(g=>({campaignName:g.campaignName||"",client:g.client||"Unknown",phoneNumber:g.phoneNumber||g.phone_number||g.phone||g.phone_num||"",firstName:g.firstName||g.first_name||g.first||"",lastName:g.lastName||g.last_name||g.last||"",email:g.email||g.email_address||"",status:g.status||g.state||"",date:g.date||g.created_at||g.timestamp||"",__raw:g}));c(oe),x(ce||0),j(t)}else console.error("Failed to fetch records:",N.error)}catch(re){console.error("Error fetching records:",re)}finally{b(!1)}}return e.jsxs("div",{className:"bg-white rounded-xl shadow-sm border border-gray-200",children:[e.jsxs("div",{className:"px-6 py-5 border-b border-gray-200 bg-gradient-to-r from-gray-50 to-white",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsx("h3",{className:"text-xl font-bold text-gray-900",children:"Voicemail Campaign Records"}),e.jsx("button",{onClick:async()=>{try{V(!0),T("Refreshing data..."),await D(s||1),T("Data refreshed successfully")}catch(t){T("Error: "+(t.message||"unknown"))}finally{V(!1),setTimeout(()=>T(""),3e3)}},disabled:P,className:"inline-flex items-center gap-2 px-4 py-2 text-sm font-medium rounded-lg text-white bg-blue-600 hover:bg-blue-700 disabled:bg-gray-300 disabled:text-gray-500 disabled:cursor-not-allowed transition-colors shadow-sm",children:P?e.jsx(me,{className:"animate-spin",size:16}):"Refresh Data"})]}),e.jsxs("div",{className:"flex items-center gap-3 flex-wrap",children:[e.jsx("input",{type:"text",placeholder:"Search by phone, name, email, campaign...",value:L,onChange:t=>$(t.target.value),className:"flex-1 min-w-[250px] px-4 py-2.5 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 text-sm"}),e.jsxs("select",{value:S,onChange:t=>k(t.target.value),className:"px-4 py-2.5 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 text-sm bg-white",children:[e.jsx("option",{value:"all",children:"All Status"}),e.jsx("option",{value:"success",children:"Delivered"}),e.jsx("option",{value:"failed",children:"Failed"}),e.jsx("option",{value:"other",children:"Other"})]}),e.jsxs("select",{value:m,onChange:t=>f(t.target.value),className:"px-4 py-2.5 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 text-sm bg-white",children:[e.jsx("option",{value:"all",children:"All Clients"}),u.map(t=>e.jsx("option",{value:t,children:t},t))]}),e.jsx("input",{type:"date",value:p.startDate,onChange:t=>C(n=>({...n,startDate:t.target.value})),className:"px-3 py-2.5 border border-gray-300 rounded-lg text-sm focus:ring-2 focus:ring-blue-500 focus:border-blue-500","aria-label":"Start date"}),e.jsx("span",{className:"text-sm text-gray-500 font-medium",children:"to"}),e.jsx("input",{type:"date",value:p.endDate,onChange:t=>C(n=>({...n,endDate:t.target.value})),className:"px-3 py-2.5 border border-gray-300 rounded-lg text-sm focus:ring-2 focus:ring-blue-500 focus:border-blue-500","aria-label":"End date"}),(p.startDate||p.endDate)&&e.jsx("button",{onClick:()=>C({startDate:"",endDate:""}),className:"px-3 py-2.5 text-sm font-medium text-gray-700 bg-gray-100 rounded-lg hover:bg-gray-200 transition-colors",title:"Clear dates",children:"Clear"})]}),e.jsxs("div",{className:"mt-4 flex items-center justify-between",children:[e.jsx("div",{className:"flex flex-wrap gap-4 text-sm text-gray-600",children:h?e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"h-4 w-32 bg-gray-200 rounded animate-pulse"}),e.jsx("div",{className:"h-4 w-20 bg-gray-200 rounded animate-pulse"})]}):e.jsxs(e.Fragment,{children:[e.jsxs("span",{children:["Total:"," ",e.jsx("strong",{className:"text-blue-600 font-semibold",children:o.toLocaleString()})," ","records"]}),e.jsx("span",{className:"text-gray-400",children:"â€¢"}),e.jsxs("span",{children:["Page:"," ",e.jsxs("strong",{className:"text-blue-600 font-semibold",children:[s,"/",M]})]}),e.jsx("span",{className:"text-gray-400",children:"â€¢"}),e.jsxs("span",{children:["Showing:"," ",e.jsx("strong",{className:"text-blue-600 font-semibold",children:H.length})," ","per page"]})]})}),I&&e.jsx("div",{className:"text-sm text-green-600 font-medium bg-green-50 px-3 py-1 rounded-lg",children:I})]})]}),e.jsxs("div",{className:"px-6 py-5 bg-gradient-to-r from-blue-50/50 to-indigo-50/50 border-b border-gray-200",children:[e.jsx("h4",{className:"text-sm font-bold text-gray-700 uppercase tracking-wide mb-4",children:"Filtered Campaign Metrics"}),e.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4",children:[e.jsxs("div",{className:"bg-white rounded-lg p-4 shadow-sm border border-gray-200 hover:shadow-md transition-shadow",children:[e.jsx("div",{className:"text-xs font-medium text-gray-500 uppercase tracking-wide mb-1",children:"Total Voicemails Sent"}),e.jsx("div",{className:"text-2xl font-bold text-gray-900",children:a.totalVoicemailsSent.toLocaleString()}),e.jsx("div",{className:"text-xs text-gray-500 mt-1",children:"Ringless voicemails"})]}),e.jsxs("div",{className:"bg-white rounded-lg p-4 shadow-sm border border-green-200 hover:shadow-md transition-shadow",children:[e.jsx("div",{className:"text-xs font-medium text-gray-500 uppercase tracking-wide mb-1",children:"Successful Deliveries"}),e.jsx("div",{className:"text-2xl font-bold text-green-600",children:a.successfulDeliveries.toLocaleString()}),e.jsxs("div",{className:"text-xs text-green-600 font-semibold mt-1",children:[a.deliveryRate,"% delivery rate"]})]}),e.jsxs("div",{className:"bg-white rounded-lg p-4 shadow-sm border border-red-200 hover:shadow-md transition-shadow",children:[e.jsx("div",{className:"text-xs font-medium text-gray-500 uppercase tracking-wide mb-1",children:"Failed Deliveries"}),e.jsx("div",{className:"text-2xl font-bold text-red-600",children:a.failedDeliveries.toLocaleString()}),e.jsxs("div",{className:"text-xs text-red-600 font-semibold mt-1",children:[a.failureRate,"% failure rate"]})]}),e.jsxs("div",{className:"bg-white rounded-lg p-4 shadow-sm border border-gray-200 hover:shadow-md transition-shadow",children:[e.jsx("div",{className:"text-xs font-medium text-gray-500 uppercase tracking-wide mb-1",children:"Other Status"}),e.jsx("div",{className:"text-2xl font-bold text-gray-600",children:a.otherStatus.toLocaleString()}),e.jsxs("div",{className:"text-xs text-gray-500 font-semibold mt-1",children:[a.otherStatusRate,"% other status"]})]})]}),d&&d.role==="superadmin"&&e.jsx("div",{className:"mt-4 bg-white rounded-lg p-4 shadow-sm border border-blue-200 hover:shadow-md transition-shadow",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("div",{className:"text-xs font-medium text-gray-500 uppercase tracking-wide",children:"Total Campaign Cost"}),e.jsxs("div",{className:"text-2xl font-bold text-blue-600",children:["$",a.totalCampaignCost.toFixed(2)]})]})})]}),e.jsxs("div",{className:"overflow-x-auto overflow-y-auto max-h-[65vh] relative",ref:v,children:[e.jsxs("table",{className:"w-full min-w-max",children:[e.jsx("thead",{className:"bg-gradient-to-r from-gray-50 to-gray-100 border-b-2 border-gray-300",children:e.jsxs("tr",{children:[e.jsx("th",{className:"sticky top-0 left-0 bg-gradient-to-r from-gray-50 to-gray-100 px-3 py-3 text-left text-xs font-bold text-gray-700 uppercase tracking-wide border-r border-gray-200 z-30 min-w-[100px] max-w-[120px]",children:"Client"}),e.jsx("th",{className:"sticky top-0 bg-gradient-to-r from-gray-50 to-gray-100 px-3 py-3 text-left text-xs font-bold text-gray-700 uppercase tracking-wide whitespace-nowrap z-20 min-w-[180px] max-w-[200px]",children:"Campaign"}),e.jsx("th",{className:"sticky top-0 bg-gradient-to-r from-gray-50 to-gray-100 px-3 py-3 text-left text-xs font-bold text-gray-700 uppercase tracking-wide whitespace-nowrap z-20 min-w-[130px] max-w-[140px]",children:"Phone"}),e.jsx("th",{className:"sticky top-0 bg-gradient-to-r from-gray-50 to-gray-100 px-3 py-3 text-left text-xs font-bold text-gray-700 uppercase tracking-wide z-20 min-w-[110px] max-w-[120px]",children:"Status"}),e.jsx("th",{className:"sticky top-0 bg-gradient-to-r from-gray-50 to-gray-100 px-3 py-3 text-left text-xs font-bold text-gray-700 uppercase tracking-wide z-20 min-w-[100px] max-w-[110px]",children:"Date"}),e.jsx("th",{className:"sticky top-0 bg-gradient-to-r from-gray-50 to-gray-100 px-3 py-3 text-left text-xs font-bold text-gray-700 uppercase tracking-wide whitespace-nowrap z-20 min-w-[100px] max-w-[120px]",children:"First Name"}),e.jsx("th",{className:"sticky top-0 bg-gradient-to-r from-gray-50 to-gray-100 px-3 py-3 text-left text-xs font-bold text-gray-700 uppercase tracking-wide whitespace-nowrap z-20 min-w-[100px] max-w-[120px]",children:"Last Name"}),e.jsx("th",{className:"sticky top-0 bg-gradient-to-r from-gray-50 to-gray-100 px-3 py-3 text-left text-xs font-bold text-gray-700 uppercase tracking-wide z-20 min-w-[180px] max-w-[220px]",children:"Email"})]})}),e.jsx("tbody",{className:"bg-white divide-y divide-gray-100",children:P?[...Array(w)].map((t,n)=>e.jsx(B,{},`skeleton-fetch-${n}`)):h?[...Array(Math.min(w,10))].map((t,n)=>e.jsx(B,{compact:!0},`skeleton-page-${n}`)):H.length===0?e.jsx("tr",{children:e.jsx("td",{colSpan:"9",className:"px-6 py-16 text-center",children:e.jsxs("div",{className:"text-gray-400 text-sm",children:[e.jsx("div",{className:"text-4xl mb-2",children:"ðŸ“­"}),e.jsx("div",{className:"font-medium",children:"No records found"}),e.jsx("div",{className:"text-xs mt-1",children:"Try adjusting your filters"})]})})}):H.map((t,n)=>e.jsxs("tr",{className:`hover:bg-blue-50/50 transition-all duration-200 ${F?"opacity-100":"opacity-0"} border-b border-gray-100 last:border-0`,children:[e.jsx("td",{className:"sticky left-0 bg-white hover:bg-blue-50/50 px-3 py-3 border-r border-gray-100 z-10",children:e.jsxs("div",{className:"flex items-center gap-1.5",children:[e.jsx(Te,{size:13,className:"text-gray-400 flex-shrink-0"}),e.jsx("div",{className:"text-xs text-gray-900 font-semibold overflow-hidden truncate",title:t.client,children:t.client||"-"})]})}),e.jsx("td",{className:"px-3 py-3",children:e.jsx("div",{className:"text-xs text-gray-900 font-medium overflow-hidden truncate",title:t.campaignName,children:t.campaignName||"-"})}),e.jsx("td",{className:"px-3 py-3 whitespace-nowrap",children:e.jsxs("div",{className:"flex items-center gap-1.5 text-xs text-gray-900 font-mono",children:[e.jsx(be,{size:12,className:"text-blue-500 flex-shrink-0"}),e.jsx("span",{className:"overflow-hidden truncate",children:t.phoneNumber||"-"})]})}),e.jsx("td",{className:"px-3 py-3 whitespace-nowrap",children:de(t.status)}),e.jsx("td",{className:"px-3 py-3 whitespace-nowrap",children:e.jsxs("div",{className:"flex items-center gap-1.5 text-xs text-gray-700",children:[e.jsx(fe,{size:12,className:"text-gray-400 flex-shrink-0"}),e.jsx("span",{className:"font-medium",children:t.date?new Date(t.date).toLocaleDateString("en-US",{month:"short",day:"numeric"}):"-"})]})}),e.jsx("td",{className:"px-3 py-3",children:e.jsx("div",{className:"text-xs text-gray-700 font-medium overflow-hidden truncate",title:t.firstName,children:t.firstName||"-"})}),e.jsx("td",{className:"px-3 py-3",children:e.jsx("div",{className:"text-xs text-gray-700 font-medium overflow-hidden truncate",title:t.lastName,children:t.lastName||"-"})}),e.jsx("td",{className:"px-3 py-3",children:e.jsxs("div",{className:"flex items-center gap-1.5 text-xs text-gray-600",children:[e.jsx(G,{size:12,className:"text-gray-400 flex-shrink-0"}),e.jsx("span",{className:"overflow-hidden truncate",title:t.email,children:t.email||"-"})]})})]},n))})]}),o>w&&e.jsxs("div",{className:"sticky bottom-0 left-0 right-0 bg-gradient-to-r from-gray-50 to-white backdrop-blur-sm border-t-2 border-gray-200 px-6 py-4 flex items-center justify-between z-10 shadow-lg",children:[e.jsxs("div",{className:"text-sm text-gray-700 font-medium",children:["Showing"," ",e.jsx("span",{className:"font-bold text-blue-600",children:(s-1)*w+1})," ","to"," ",e.jsx("span",{className:"font-bold text-blue-600",children:Math.min(s*w,o)})," ","of"," ",e.jsx("span",{className:"font-bold text-blue-600",children:o.toLocaleString()})," ","records"]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("button",{onClick:()=>D(1),disabled:s===1,className:"px-3 py-2 text-sm font-semibold text-gray-700 bg-white border border-gray-300 rounded-lg hover:bg-blue-50 hover:border-blue-300 disabled:opacity-40 disabled:cursor-not-allowed transition-all shadow-sm",title:"First Page",children:"Â«Â«"}),e.jsx("button",{onClick:()=>D(Math.max(1,s-1)),disabled:s===1,className:"px-4 py-2 text-sm font-semibold text-gray-700 bg-white border border-gray-300 rounded-lg hover:bg-blue-50 hover:border-blue-300 disabled:opacity-40 disabled:cursor-not-allowed transition-all shadow-sm",children:"Previous"}),e.jsxs("div",{className:"px-4 py-2 text-sm font-bold text-gray-900 bg-blue-50 border border-blue-200 rounded-lg",title:`Total pages: ${M}`,children:["Page ",s," of ",M]}),e.jsx("button",{onClick:()=>D(Math.min(M,s+1)),disabled:s===M,className:"px-4 py-2 text-sm font-semibold text-gray-700 bg-white border border-gray-300 rounded-lg hover:bg-blue-50 hover:border-blue-300 disabled:opacity-40 disabled:cursor-not-allowed transition-all shadow-sm",children:"Next"}),e.jsx("button",{onClick:()=>D(M),disabled:s===M,className:"px-3 py-2 text-sm font-semibold text-gray-700 bg-white border border-gray-300 rounded-lg hover:bg-blue-50 hover:border-blue-300 disabled:opacity-40 disabled:cursor-not-allowed transition-all shadow-sm",title:"Last Page",children:"Â»Â»"}),e.jsxs("div",{className:"flex items-center gap-2 ml-3 pl-3 border-l-2 border-gray-300",children:[e.jsx("span",{className:"text-xs text-gray-600 font-medium",children:"Jump to:"}),e.jsx("input",{type:"number",min:"1",max:M,value:q,onChange:t=>te(t.target.value),onKeyDown:t=>{t.key==="Enter"&&ae()},placeholder:"Page #",className:`w-20 px-3 py-2 rounded-lg text-sm font-medium border focus:ring-2 focus:ring-blue-500 ${se?"border-red-500 ring-1 ring-red-300":"border-gray-300"}`}),e.jsx("button",{onClick:ae,className:"px-4 py-2 text-sm font-semibold bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors shadow-sm",children:"Go"})]})]})]})]})]})};function Oe({clientCampaigns:i=null,clientName:d=null}){const[l,c]=r.useState("All"),[o,x]=r.useState(["All"]),[s,j]=r.useState(""),[h,b]=r.useState("all"),[a,_]=r.useState("all"),[v,U]=r.useState({startDate:"",endDate:""}),[A,F]=r.useState(s);r.useEffect(()=>{const u=setTimeout(()=>F(s),300);return()=>clearTimeout(u)},[s]);const E=ie.useMemo(()=>({searchTerm:A,statusFilter:h,clientFilter:a,dateFilters:v}),[A,h,a,v]),[L,$]=r.useState({totalRecords:0,currentPage:1,totalPages:1,currentRecordsLength:0,loadingPage:!1,fetchMessage:""}),S=i?{campaignIds:i}:{},{metrics:k,loading:m,error:f,refetch:p}=Se(S),{syncLogs:C,refetch:P}=ke(10),{triggerFetch:V,isFetching:I,error:T}=Ce();r.useEffect(()=>{if(k?.campaigns){const u=je(k.campaigns);x(u)}},[k]),r.useEffect(()=>{const u=setInterval(()=>{p(),P()},3e6);return()=>clearInterval(u)},[p,P]);const w=async()=>{R.info("Starting SFTP sync... This may take 30-60 seconds.",{autoClose:3e3});const u=await V();u.success?(await p(),await P(),u.data?.warning?R.warning(u.data.warning,{autoClose:5e3}):u.data?.filesDownloaded>0?R.success(`Successfully fetched ${u.data.filesDownloaded} files from SFTP!`,{autoClose:5e3}):R.info("Sync completed - using existing data.",{autoClose:3e3})):R.error("Failed to fetch data: "+(u.error||"Unknown error"),{autoClose:5e3})},B=k?.campaigns?.filter(u=>l==="All"||u.client===l)||[];return e.jsx(Ne,{children:e.jsxs("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-6 sm:py-8",children:[e.jsx("div",{className:"mb-6",children:e.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:"Ringless Voicemail Dashboard"})}),(f||T)&&e.jsxs("div",{className:"mb-6 bg-red-50 border border-red-200 rounded-lg p-4 flex items-start",children:[e.jsx(K,{className:"text-red-600 mr-3 flex-shrink-0 mt-0.5",size:18}),e.jsx("p",{className:"text-sm text-red-800 leading-relaxed",children:f||T})]}),e.jsxs("div",{className:"mb-6 flex items-center justify-between gap-4 bg-white p-3 rounded-lg shadow-sm border border-gray-200",children:[e.jsx("div",{className:"flex items-center gap-4",children:C.length>0&&C[0]&&e.jsxs("div",{className:"text-xs text-gray-500",children:["Last sync: ",we(ve(C[0].timestamp),"MMM dd, h:mm a")]})}),e.jsx("div",{className:"flex items-center gap-2",children:e.jsxs("button",{onClick:w,disabled:I,className:"flex items-center gap-2 px-3 py-1.5 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors disabled:opacity-50 disabled:cursor-not-allowed text-sm",children:[e.jsx(Q,{className:`w-4 h-4 ${I?"animate-spin":""}`}),I?"Fetching...":"Fetch from SFTP"]})})]}),m&&!k?e.jsx("div",{className:"flex items-center justify-center h-96",children:e.jsxs("div",{className:"text-center",children:[e.jsx(ge,{className:"animate-spin mx-auto mb-4 text-blue-600",size:40}),e.jsx("p",{className:"text-gray-600 text-sm font-medium",children:"Loading dashboard..."})]})}):e.jsx("div",{className:"space-y-6",children:e.jsx(Be,{campaigns:B,filters:E,onMetaChange:u=>$(u)})})]})})}function Ge({metrics:i}){const{overview:d,emailStats:l}=i,c=[{title:"Total Emails",value:z(d.totalEmails),icon:G,color:"bg-indigo-500",subtitle:`${z(l.totalSent)} sent to contacts`},{title:"Total Campaigns",value:z(d.totalCampaigns||0),icon:he,color:"bg-purple-500",subtitle:"Marketing campaigns"},{title:"Total Segments",value:z(d.totalSegments),icon:ee,color:"bg-green-500",subtitle:`Across ${d.clients} client${d.clients!==1?"s":""}`}];return e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:c.map((o,x)=>{const s=o.icon;return e.jsx("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200 p-6 hover:shadow-md transition-shadow",children:e.jsxs("div",{className:"flex items-start justify-between",children:[e.jsxs("div",{className:"flex-1",children:[e.jsx("p",{className:"text-sm font-medium text-gray-600 mb-1",children:o.title}),e.jsx("p",{className:"text-3xl font-bold text-gray-900",children:o.value}),e.jsx("p",{className:"text-xs text-gray-500 mt-2",children:o.subtitle})]}),e.jsx("div",{className:`${o.color} p-3 rounded-lg`,children:e.jsx(s,{className:"text-white",size:24})})]})},x)})})}function He({clients:i,selectedClientId:d,onChange:l}){return e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("label",{className:"text-sm font-medium text-gray-700",children:"Client:"}),e.jsxs("select",{value:d||"",onChange:c=>l(c.target.value?parseInt(c.target.value):null),className:"px-3 py-1.5 border border-gray-300 rounded-lg text-sm focus:outline-none focus:ring-2 focus:ring-blue-500",children:[e.jsx("option",{value:"",children:"All Clients"}),i.map(c=>e.jsx("option",{value:c.id,children:c.name},c.id))]})]})}function qe({clientId:i,refreshKey:d}){const[l,c]=r.useState(1),[o]=r.useState(20),{campaigns:x,pagination:s,loading:j,error:h,refetch:b}=Pe({clientId:i,page:l,limit:o});return r.useEffect(()=>{c(1)},[i]),r.useEffect(()=>{d&&b()},[d]),j?e.jsx("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200 p-8",children:e.jsxs("div",{className:"flex items-center justify-center",children:[e.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600"}),e.jsx("span",{className:"ml-3 text-gray-600",children:"Loading campaigns..."})]})}):h?e.jsx("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200 p-8",children:e.jsxs("div",{className:"text-center text-red-600",children:[e.jsx("p",{className:"font-medium",children:"Error loading campaigns"}),e.jsx("p",{className:"text-sm mt-1",children:h}),e.jsx("button",{onClick:b,className:"mt-4 px-4 py-2 bg-red-600 text-white rounded-lg hover:bg-red-700",children:"Retry"})]})}):e.jsxs("div",{className:"space-y-4",children:[e.jsx("div",{className:"flex items-center justify-between",children:e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"Marketing Campaigns"}),e.jsxs("p",{className:"text-sm text-gray-500 mt-1",children:[s?.total||0," total campaigns"]})]})}),e.jsxs("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200 overflow-hidden",children:[e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"min-w-full divide-y divide-gray-200",children:[e.jsx("thead",{className:"bg-gray-50",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"ID"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Campaign Name"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Client"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Category"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Status"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Created"})]})}),e.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:x&&x.length>0?x.map(a=>e.jsxs("tr",{className:"hover:bg-gray-50",children:[e.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:e.jsx("div",{className:"text-sm font-mono text-gray-900",children:a.mauticCampaignId})}),e.jsx("td",{className:"px-6 py-4",children:e.jsxs("div",{children:[e.jsx("div",{className:"text-sm font-medium text-gray-900",children:a.name}),a.description&&e.jsx("div",{className:"text-xs text-gray-500 mt-1 max-w-md truncate",children:a.description})]})}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:e.jsx("div",{className:"text-sm text-gray-900",children:a.client?.name||"N/A"})}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:e.jsx("div",{className:"text-sm text-gray-600",children:a.category||"Uncategorized"})}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:a.isPublished?e.jsx("span",{className:"inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-green-100 text-green-800",children:"Published"}):e.jsx("span",{className:"inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-gray-100 text-gray-800",children:"Draft"})}),e.jsxs("td",{className:"px-6 py-4 whitespace-nowrap",children:[e.jsxs("div",{className:"flex items-center text-sm text-gray-600",children:[e.jsx(Fe,{className:"w-4 h-4 mr-1"}),le(a.dateAdded)]}),a.createdBy&&e.jsxs("div",{className:"text-xs text-gray-500 mt-1",children:["by ",a.createdBy]})]})]},a.id)):e.jsx("tr",{children:e.jsxs("td",{colSpan:"6",className:"px-6 py-12 text-center",children:[e.jsx(ne,{className:"w-12 h-12 text-gray-300 mx-auto mb-3"}),e.jsx("p",{className:"text-gray-500 font-medium",children:"No campaigns found"}),e.jsx("p",{className:"text-sm text-gray-400 mt-1",children:"Campaigns will appear here after syncing"})]})})})]})}),s&&s.totalPages>1&&e.jsx("div",{className:"bg-gray-50 px-6 py-4 border-t border-gray-200",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"text-sm text-gray-600",children:["Showing ",(s.page-1)*s.limit+1," to"," ",Math.min(s.page*s.limit,s.total)," of"," ",s.total," campaigns"]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsxs("button",{onClick:()=>c(a=>Math.max(1,a-1)),disabled:s.page===1,className:"inline-flex items-center gap-1 px-3 py-2 text-sm font-medium text-gray-700 bg-white border border-gray-300 rounded-md hover:bg-gray-50 disabled:opacity-50 disabled:cursor-not-allowed",children:[e.jsx(W,{className:"w-4 h-4"}),"Previous"]}),e.jsxs("span",{className:"text-sm text-gray-600",children:["Page ",s.page," of ",s.totalPages]}),e.jsxs("button",{onClick:()=>c(a=>Math.min(s.totalPages,a+1)),disabled:s.page===s.totalPages,className:"inline-flex items-center gap-1 px-3 py-2 text-sm font-medium text-gray-700 bg-white border border-gray-300 rounded-md hover:bg-gray-50 disabled:opacity-50 disabled:cursor-not-allowed",children:["Next",e.jsx(Z,{className:"w-4 h-4"})]})]})]})})]})]})}function Je({clientId:i,refreshKey:d}){const[l,c]=r.useState(1),[o]=r.useState(20),{emails:x,pagination:s,loading:j,error:h,refetch:b}=Me({clientId:i||void 0,page:l,limit:o});return r.useEffect(()=>{c(1)},[i]),r.useEffect(()=>{d&&b()},[d]),j?e.jsx("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200 p-8",children:e.jsxs("div",{className:"flex items-center justify-center",children:[e.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600"}),e.jsx("span",{className:"ml-3 text-gray-600",children:"Loading campaigns..."})]})}):h?e.jsx("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200 p-8",children:e.jsx("p",{className:"text-red-600 text-center",children:h})}):e.jsxs("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200",children:[e.jsx("div",{className:"px-6 py-4 border-b border-gray-200",children:e.jsx("div",{className:"flex items-center justify-between",children:e.jsxs("div",{children:[e.jsxs("h3",{className:"text-lg font-semibold text-gray-900 flex items-center gap-2",children:[e.jsx(G,{className:"text-purple-600",size:20}),"Email Campaigns"]}),e.jsxs("p",{className:"text-sm text-gray-600 mt-1",children:[s?.total||0," total campaigns"]})]})})}),e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"min-w-full divide-y divide-gray-200",children:[e.jsx("thead",{className:"bg-gray-50",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Campaign Name"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Client"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Status"}),e.jsx("th",{className:"px-6 py-3 text-right text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Sent"}),e.jsx("th",{className:"px-6 py-3 text-right text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Open Rate"}),e.jsx("th",{className:"px-6 py-3 text-right text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Click Rate"}),e.jsx("th",{className:"px-6 py-3 text-right text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Unsubscribe"})]})}),e.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:x&&x.length>0?x.map(a=>e.jsxs("tr",{className:"hover:bg-gray-50",children:[e.jsx("td",{className:"px-6 py-4",children:e.jsxs("div",{children:[e.jsx("div",{className:"text-sm font-medium text-gray-900",children:a.name}),a.subject&&e.jsx("div",{className:"text-xs text-gray-500 mt-1",children:a.subject})]})}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:e.jsx("div",{className:"text-sm text-gray-900",children:a.client?.name||"N/A"})}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:a.isPublished?e.jsx("span",{className:"inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-green-100 text-green-800",children:"Published"}):e.jsx("span",{className:"inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-gray-100 text-gray-800",children:"Draft"})}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-right",children:e.jsx("div",{className:"text-sm text-gray-900",children:z(a.sentCount)})}),e.jsxs("td",{className:"px-6 py-4 whitespace-nowrap text-right",children:[e.jsxs("div",{className:"flex items-center justify-end gap-1",children:[e.jsx(pe,{size:14,className:"text-gray-400"}),e.jsx("span",{className:"text-sm font-medium text-gray-900",children:Y(a.readRate)})]}),e.jsxs("div",{className:"text-xs text-gray-500",children:[z(a.readCount)," opens"]})]}),e.jsxs("td",{className:"px-6 py-4 whitespace-nowrap text-right",children:[e.jsxs("div",{className:"flex items-center justify-end gap-1",children:[e.jsx($e,{size:14,className:"text-gray-400"}),e.jsx("span",{className:"text-sm font-medium text-gray-900",children:Y(a.clickRate)})]}),e.jsxs("div",{className:"text-xs text-gray-500",children:[z(a.clickedCount)," clicks"]})]}),e.jsxs("td",{className:"px-6 py-4 whitespace-nowrap text-right",children:[e.jsxs("div",{className:"flex items-center justify-end gap-1",children:[e.jsx(Ue,{size:14,className:"text-red-400"}),e.jsx("span",{className:"text-sm font-medium text-gray-900",children:Y(a.unsubscribeRate)})]}),e.jsxs("div",{className:"text-xs text-gray-500",children:[z(a.unsubscribed)," unsubs"]})]})]},a.id)):e.jsx("tr",{children:e.jsx("td",{colSpan:"7",className:"px-6 py-8 text-center text-gray-500",children:"No campaigns found"})})})]})}),s&&s.totalPages>1&&e.jsxs("div",{className:"px-6 py-4 border-t border-gray-200 flex items-center justify-between",children:[e.jsxs("div",{className:"text-sm text-gray-700",children:["Showing ",(s.page-1)*s.limit+1," to"," ",Math.min(s.page*s.limit,s.total)," of"," ",s.total," campaigns"]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("button",{onClick:()=>c(l-1),disabled:l===1,className:"px-3 py-1 border border-gray-300 rounded-md text-sm font-medium text-gray-700 bg-white hover:bg-gray-50 disabled:opacity-50 disabled:cursor-not-allowed",children:e.jsx(W,{size:16})}),e.jsxs("span",{className:"text-sm text-gray-700",children:["Page ",s.page," of ",s.totalPages]}),e.jsx("button",{onClick:()=>c(l+1),disabled:l===s.totalPages,className:"px-3 py-1 border border-gray-300 rounded-md text-sm font-medium text-gray-700 bg-white hover:bg-gray-50 disabled:opacity-50 disabled:cursor-not-allowed",children:e.jsx(Z,{size:16})})]})]})]})}function Xe({clientId:i,refreshKey:d}){const[l,c]=r.useState(1),[o]=r.useState(20),{segments:x,pagination:s,loading:j,error:h,refetch:b}=De({clientId:i||void 0,page:l,limit:o});return r.useEffect(()=>{c(1)},[i]),r.useEffect(()=>{d&&b()},[d]),j?e.jsx("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200 p-8",children:e.jsxs("div",{className:"flex items-center justify-center",children:[e.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600"}),e.jsx("span",{className:"ml-3 text-gray-600",children:"Loading segments..."})]})}):h?e.jsx("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200 p-8",children:e.jsx("p",{className:"text-red-600 text-center",children:h})}):e.jsxs("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200",children:[e.jsx("div",{className:"px-6 py-4 border-b border-gray-200",children:e.jsx("div",{className:"flex items-center justify-between",children:e.jsxs("div",{children:[e.jsxs("h3",{className:"text-lg font-semibold text-gray-900 flex items-center gap-2",children:[e.jsx(ee,{className:"text-green-600",size:20}),"Segments & Lists"]}),e.jsxs("p",{className:"text-sm text-gray-600 mt-1",children:[s?.total||0," total segments"]})]})})}),e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"min-w-full divide-y divide-gray-200",children:[e.jsx("thead",{className:"bg-gray-50",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Segment Name"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Client"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Type"}),e.jsx("th",{className:"px-6 py-3 text-right text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Contacts"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Status"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Created"})]})}),e.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:x&&x.length>0?x.map(a=>e.jsxs("tr",{className:"hover:bg-gray-50",children:[e.jsx("td",{className:"px-6 py-4",children:e.jsxs("div",{children:[e.jsx("div",{className:"text-sm font-medium text-gray-900",children:a.name}),a.description&&e.jsx("div",{className:"text-xs text-gray-500 mt-1 max-w-md truncate",children:a.description})]})}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:e.jsx("div",{className:"text-sm text-gray-900",children:a.client?.name||"N/A"})}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:e.jsx("span",{className:"inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-blue-100 text-blue-800",children:a.isGlobal?"Global":"Regular"})}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-right",children:e.jsxs("div",{className:"flex items-center justify-end gap-1",children:[e.jsx(ue,{size:14,className:"text-gray-400"}),e.jsx("span",{className:"text-sm font-medium text-gray-900",children:z(a.contactCount)})]})}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:a.isPublished?e.jsx("span",{className:"inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-green-100 text-green-800",children:"Published"}):e.jsx("span",{className:"inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-gray-100 text-gray-800",children:"Draft"})}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:e.jsx("div",{className:"text-sm text-gray-900",children:a.dateAdded?le(a.dateAdded):"N/A"})})]},a.id)):e.jsx("tr",{children:e.jsx("td",{colSpan:"6",className:"px-6 py-8 text-center text-gray-500",children:"No segments found"})})})]})}),s&&s.totalPages>1&&e.jsxs("div",{className:"px-6 py-4 border-t border-gray-200 flex items-center justify-between",children:[e.jsxs("div",{className:"text-sm text-gray-700",children:["Showing ",(s.page-1)*s.limit+1," to"," ",Math.min(s.page*s.limit,s.total)," of"," ",s.total," segments"]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("button",{onClick:()=>c(l-1),disabled:l===1,className:"px-3 py-1 border border-gray-300 rounded-md text-sm font-medium text-gray-700 bg-white hover:bg-gray-50 disabled:opacity-50 disabled:cursor-not-allowed",children:e.jsx(W,{size:16})}),e.jsxs("span",{className:"text-sm text-gray-700",children:["Page ",s.page," of ",s.totalPages]}),e.jsx("button",{onClick:()=>c(l+1),disabled:l===s.totalPages,className:"px-3 py-1 border border-gray-300 rounded-md text-sm font-medium text-gray-700 bg-white hover:bg-gray-50 disabled:opacity-50 disabled:cursor-not-allowed",children:e.jsx(Z,{size:16})})]})]})]})}function Ye({clientId:i=null,clientName:d=null}){const[l,c]=r.useState(i),[o,x]=r.useState("campaigns"),{clients:s,loading:j,refetch:h}=Re(),{metrics:b,loading:a,error:_,refetch:v}=ze(l||i),{syncAllClients:U,syncClient:A,isSyncing:F}=Ee(),[E,L]=r.useState(Date.now()),$=i!==null,S=async()=>{if(l){if(!window.confirm("This will sync data from the selected client. Depending on the data size, this may take 1-2 minutes. Continue?"))return;R.info("Starting Mautic sync... Please wait.",{autoClose:3e3})}else{const f=s.filter(P=>P.isActive).length,p=Math.ceil(f/5),C=`This will sync ${f} active client${f!==1?"s":""} in parallel batches.

Estimated time: ${p}-${p+2} minutes.

Continue?`;if(!window.confirm(C))return;R.info(`Syncing ${f} clients... This may take ${p}-${p+2} minutes.`,{autoClose:5e3})}const m=l?await A(l):await U();if(m.success){const f=m.data?.results?`Sync completed! ${m.data.results.successful}/${m.data.results.totalClients} clients synced successfully.`:m.message||"Sync completed successfully!";R.success(f,{autoClose:5e3}),v(),h()}else R.error(m.error||m.message||"Sync failed. Please try again.",{autoClose:5e3})},k=m=>{c(m)};return ie.useEffect(()=>{const m=f=>{h(),v(),L(Date.now())};return window.addEventListener("mautic:sync-complete",m),()=>window.removeEventListener("mautic:sync-complete",m)},[h,v]),a||j?e.jsxs("div",{className:"flex items-center justify-center h-64",children:[e.jsx(Q,{className:"animate-spin text-blue-600",size:32}),e.jsx("span",{className:"ml-3 text-gray-600",children:"Loading dashboard..."})]}):e.jsxs("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-6 sm:py-8",children:[e.jsxs("div",{className:"mb-6",children:[e.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:"Autovation  Dashboard"}),e.jsx("p",{className:"mt-1 text-sm text-gray-600",children:"Monitor your Autovation performance and email campaigns"})]}),s.length===0&&e.jsxs("div",{className:"mb-6 bg-yellow-50 border border-yellow-200 rounded-lg p-6 text-center",children:[e.jsx(K,{className:"text-yellow-600 mx-auto mb-3",size:48}),e.jsx("h3",{className:"text-lg font-semibold text-yellow-900 mb-2",children:"No Autovation Clients Configured"}),e.jsx("p",{className:"text-sm text-yellow-800 mb-4",children:"You need to add at least one Mautic client to start syncing data."})]}),_&&e.jsxs("div",{className:"mb-6 bg-red-50 border border-red-200 rounded-lg p-4 flex items-start",children:[e.jsx(K,{className:"text-red-600 mr-3 flex-shrink-0 mt-0.5",size:18}),e.jsx("p",{className:"text-sm text-red-800 leading-relaxed",children:_})]}),e.jsxs("div",{className:"mb-6 flex items-center justify-between gap-4 bg-white p-3 rounded-lg shadow-sm border border-gray-200",children:[e.jsxs("div",{className:"flex items-center gap-4",children:[!$&&e.jsx(He,{clients:s,selectedClientId:l,onChange:k}),$&&d&&e.jsxs("div",{className:"px-4 py-2 bg-blue-100 text-blue-800 rounded-lg font-medium",children:["Viewing: ",d]})]}),e.jsxs("button",{onClick:S,disabled:F||s.length===0,className:"flex items-center gap-2 px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 disabled:opacity-50 disabled:cursor-not-allowed transition-colors",title:s.length===0?"Add a client first":"Sync data from Mautic (may take 1-3 minutes)",children:[e.jsx(Q,{className:F?"animate-spin":"",size:16}),F?"Syncing... Please wait":"Sync Now"]})]}),b&&s.length>0&&e.jsxs(e.Fragment,{children:[e.jsx(Ge,{metrics:b}),e.jsx("div",{className:"bg-white rounded-lg shadow-sm mb-6 mt-6",children:e.jsx("div",{className:"border-b border-gray-200",children:e.jsxs("nav",{className:"flex space-x-8 px-6","aria-label":"Tabs",children:[e.jsxs("button",{onClick:()=>x("campaigns"),className:`
                    flex items-center space-x-2 py-4 px-1 border-b-2 font-medium text-sm transition-colors
                    ${o==="campaigns"?"border-blue-500 text-blue-600":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300"}
                  `,children:[e.jsx(ne,{className:"w-4 h-4"}),e.jsx("span",{children:"Campaigns"})]}),e.jsxs("button",{onClick:()=>x("emails"),className:`
                    flex items-center space-x-2 py-4 px-1 border-b-2 font-medium text-sm transition-colors
                    ${o==="emails"?"border-blue-500 text-blue-600":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300"}
                  `,children:[e.jsx(G,{className:"w-4 h-4"}),e.jsx("span",{children:"Emails"})]}),e.jsxs("button",{onClick:()=>x("segments"),className:`
                    flex items-center space-x-2 py-4 px-1 border-b-2 font-medium text-sm transition-colors
                    ${o==="segments"?"border-blue-500 text-blue-600":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300"}
                  `,children:[e.jsx(ee,{className:"w-4 h-4"}),e.jsx("span",{children:"Segments"})]})]})})}),e.jsxs("div",{className:"bg-white rounded-lg shadow-sm p-6",children:[o==="campaigns"&&e.jsx(qe,{clientId:l,refreshKey:E}),o==="emails"&&e.jsx(Je,{clientId:l,refreshKey:E}),o==="segments"&&e.jsx(Xe,{clientId:l,refreshKey:E})]})]})]})}function st(){const[i,d]=r.useState(()=>localStorage.getItem("selectedService")||"dropcowboy");return r.useEffect(()=>{localStorage.setItem("selectedService",i)},[i]),e.jsxs("div",{className:"min-h-screen bg-gray-50",children:[e.jsx("div",{className:"bg-white border-b border-gray-200 sticky top-16 z-40",children:e.jsx("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"text-sm font-medium text-gray-500 py-4",children:"Services:"}),e.jsxs("nav",{className:"flex space-x-4","aria-label":"Services",children:[e.jsxs("button",{onClick:()=>d("dropcowboy"),className:`
                  flex items-center gap-2 px-4 py-4 border-b-2 font-medium text-sm transition-colors
                  ${i==="dropcowboy"?"border-blue-500 text-blue-600":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300"}
                `,children:[e.jsx("span",{className:"text-lg"}),e.jsx("span",{children:"Ringless Voicemail"})]}),e.jsxs("button",{onClick:()=>d("mautic"),className:`
                  flex items-center gap-2 px-4 py-4 border-b-2 font-medium text-sm transition-colors
                  ${i==="mautic"?"border-blue-500 text-blue-600":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300"}
                `,children:[e.jsx("span",{className:"text-lg"}),e.jsx("span",{children:"Autovation"})]}),e.jsxs("button",{onClick:()=>d("vicidial"),className:`
                  flex items-center gap-2 px-4 py-4 border-b-2 font-medium text-sm transition-colors
                  ${i==="vicidial"?"border-blue-500 text-blue-600":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300"}
                `,children:[e.jsx("span",{className:"text-lg"}),e.jsx("span",{children:"Vici Dial"})]})]})]})})}),e.jsxs("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8",children:[i==="dropcowboy"&&e.jsx(Oe,{}),i==="mautic"&&e.jsx(Ye,{}),i==="vicidial"&&e.jsx(ye,{})]})]})}export{st as default};
//# sourceMappingURL=Services-Bwr4xWz6.js.map
