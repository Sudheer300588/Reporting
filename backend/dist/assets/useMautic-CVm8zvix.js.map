{"version":3,"file":"useMautic-CVm8zvix.js","sources":["../../src/services/mautic/api.js","../../src/services/mautic/mauticService.js","../../src/hooks/mautic/useMautic.js"],"sourcesContent":["/**\n * Mautic API Client\n *\n * Axios-based API client for Mautic module endpoints\n */\n\nimport axios from \"axios\";\n\nconst baseURL = import.meta.env.VITE_API_URL || \"\";\n\nconst mauticAPI = axios.create({\n  baseURL: `${baseURL}/api/mautic`,\n  headers: {\n    \"Content-Type\": \"application/json\",\n  },\n  timeout: 120000, // 2 minutes for large data operations\n});\n\nmauticAPI.interceptors.request.use((config) => {\n  const token = localStorage.getItem(\"token\");\n  if (token) {\n    config.headers.Authorization = `Bearer ${token}`;\n  }\n  return config;\n});\n\n// ============================================\n// CLIENT MANAGEMENT\n// ============================================\n\nexport const fetchClients = () => mauticAPI.get(\"/clients\");\n\nexport const createClient = (clientData) =>\n  mauticAPI.post(\"/clients\", clientData);\n\nexport const updateClient = (clientId, clientData) =>\n  mauticAPI.put(`/clients/${clientId}`, clientData);\n\n// Soft-delete: toggle active state\nexport const deleteClient = (clientId) =>\n  mauticAPI.patch(`/clients/${clientId}/toggle`);\n\n// Hard-delete: permanently remove client and all associated data\nexport const hardDeleteClient = (clientId) =>\n  mauticAPI.delete(`/clients/${clientId}/permanent`);\n\nexport const testConnection = (credentials) =>\n  mauticAPI.post(\"/clients/test-connection\", credentials);\n\n// ============================================\n// DASHBOARD & METRICS\n// ============================================\n\nexport const fetchDashboardMetrics = (clientId = null) =>\n  mauticAPI.get(\"/dashboard\", { params: { clientId } });\n\nexport const fetchContacts = (params = {}) =>\n  mauticAPI.get(\"/contacts\", { params });\n\nexport const fetchEmails = (params = {}) =>\n  mauticAPI.get(\"/emails\", { params });\n\nexport const fetchSegments = (clientId) =>\n  mauticAPI.get(\"/segments\", { params: { clientId } });\n\nexport const fetchCampaigns = ({ clientId, page = 1, limit = 50 }) =>\n  mauticAPI.get(\"/campaigns\", { params: { clientId, page, limit } });\n\n// ============================================\n// SYNC OPERATIONS\n// ============================================\n\nexport const syncAllClients = () => mauticAPI.post(\"/sync/all\");\n\nexport const syncClient = (clientId) => mauticAPI.post(`/sync/${clientId}`);\n\nexport default mauticAPI;\n","/**\n * Mautic Service\n * \n * Centralized service layer for all Mautic API interactions.\n * This service abstracts the API layer and provides clean methods for data operations.\n */\n\nimport mauticAPI, {\n  fetchClients as apiFetchClients,\n  createClient as apiCreateClient,\n  updateClient as apiUpdateClient,\n  deleteClient as apiDeleteClient,\n  hardDeleteClient as apiHardDeleteClient,\n  testConnection as apiTestConnection,\n  fetchDashboardMetrics as apiFetchDashboardMetrics,\n  fetchContacts as apiFetchContacts,\n  fetchEmails as apiFetchEmails,\n  fetchSegments as apiFetchSegments,\n  fetchCampaigns as apiFetchCampaigns,\n  syncAllClients as apiSyncAllClients,\n  syncClient as apiSyncClient\n} from './api';\n\nclass MauticService {\n  /**\n   * Get all clients\n   * @returns {Promise<Object>} Clients data\n   */\n  async getClients() {\n    try {\n      const response = await apiFetchClients();\n      return {\n        success: true,\n        data: response.data.data,\n        error: null\n      };\n    } catch (error) {\n      console.error('Error fetching clients:', error);\n      return {\n        success: false,\n        data: null,\n        error: error.response?.data?.message || error.message || 'Failed to fetch clients'\n      };\n    }\n  }\n\n  /**\n   * Create a new client\n   * @param {Object} clientData - { name, mauticUrl, username, password }\n   * @returns {Promise<Object>} Result\n   */\n  async createClient(clientData) {\n    try {\n      const response = await apiCreateClient(clientData);\n      return {\n        success: true,\n        data: response.data.data,\n        message: response.data.message,\n        error: null\n      };\n    } catch (error) {\n      console.error('Error creating client:', error);\n      return {\n        success: false,\n        data: null,\n        error: error.response?.data?.message || error.message || 'Failed to create client'\n      };\n    }\n  }\n\n  /**\n   * Update a client\n   * @param {number} clientId - Client ID\n   * @param {Object} clientData - Updated fields\n   * @returns {Promise<Object>} Result\n   */\n  async updateClient(clientId, clientData) {\n    try {\n      const response = await apiUpdateClient(clientId, clientData);\n      return {\n        success: true,\n        data: response.data.data,\n        message: response.data.message,\n        error: null\n      };\n    } catch (error) {\n      console.error('Error updating client:', error);\n      return {\n        success: false,\n        data: null,\n        error: error.response?.data?.message || error.message || 'Failed to update client'\n      };\n    }\n  }\n\n  /**\n   * Delete a client\n   * @param {number} clientId - Client ID\n   * @returns {Promise<Object>} Result\n   */\n  async deleteClient(clientId) {\n    try {\n      const response = await apiDeleteClient(clientId);\n      return {\n        success: true,\n        message: response.data.message,\n        error: null\n      };\n    } catch (error) {\n      console.error('Error deleting client:', error);\n      return {\n        success: false,\n        error: error.response?.data?.message || error.message || 'Failed to delete client'\n      };\n    }\n  }\n\n  /**\n   * Permanently delete a client and all associated data\n   * @param {number} clientId - Client ID\n   * @returns {Promise<Object>} Result\n   */\n  async hardDeleteClient(clientId) {\n    try {\n      const response = await apiHardDeleteClient(clientId);\n      return {\n        success: true,\n        message: response.data.message,\n        error: null\n      };\n    } catch (error) {\n      console.error('Error permanently deleting client:', error);\n      return {\n        success: false,\n        error: error.response?.data?.message || error.message || 'Failed to permanently delete client'\n      };\n    }\n  }\n\n  /**\n   * Test Mautic connection\n   * @param {Object} credentials - { mauticUrl, username, password }\n   * @returns {Promise<Object>} Test result\n   */\n  async testConnection(credentials) {\n    try {\n      const response = await apiTestConnection(credentials);\n      return {\n        success: response.data.success,\n        message: response.data.message,\n        error: null\n      };\n    } catch (error) {\n      console.error('Error testing connection:', error);\n      return {\n        success: false,\n        message: error.response?.data?.message || error.message || 'Connection test failed',\n        error: error.response?.data?.message || error.message\n      };\n    }\n  }\n\n  /**\n   * Get dashboard metrics\n   * @param {number|null} clientId - Client ID (optional)\n   * @returns {Promise<Object>} Dashboard metrics\n   */\n  async getDashboardMetrics(clientId = null) {\n    try {\n      const response = await apiFetchDashboardMetrics(clientId);\n      return {\n        success: true,\n        data: response.data.data,\n        error: null\n      };\n    } catch (error) {\n      console.error('Error fetching dashboard metrics:', error);\n      return {\n        success: false,\n        data: null,\n        error: error.response?.data?.message || error.message || 'Failed to fetch dashboard metrics'\n      };\n    }\n  }\n\n  /**\n   * Get contacts with pagination\n   * @param {Object} params - { clientId, page, limit, search }\n   * @returns {Promise<Object>} Contacts data\n   */\n  async getContacts(params = {}) {\n    try {\n      const response = await apiFetchContacts(params);\n      return {\n        success: true,\n        data: response.data.data,\n        error: null\n      };\n    } catch (error) {\n      console.error('Error fetching contacts:', error);\n      return {\n        success: false,\n        data: null,\n        error: error.response?.data?.message || error.message || 'Failed to fetch contacts'\n      };\n    }\n  }\n\n  /**\n   * Get emails with pagination\n   * @param {Object} params - { clientId, page, limit }\n   * @returns {Promise<Object>} Emails data\n   */\n  async getEmails(params = {}) {\n    try {\n      const response = await apiFetchEmails(params);\n      return {\n        success: true,\n        data: response.data.data,\n        error: null\n      };\n    } catch (error) {\n      console.error('Error fetching emails:', error);\n      return {\n        success: false,\n        data: null,\n        error: error.response?.data?.message || error.message || 'Failed to fetch emails'\n      };\n    }\n  }\n\n  /**\n   * Get segments\n   * @param {number|null} clientId - Client ID (optional)\n   * @returns {Promise<Object>} Segments data\n   */\n  async getSegments(clientId = null) {\n    try {\n      const response = await apiFetchSegments(clientId);\n      return {\n        success: true,\n        data: response.data.data,\n        error: null\n      };\n    } catch (error) {\n      console.error('Error fetching segments:', error);\n      return {\n        success: false,\n        data: null,\n        error: error.response?.data?.message || error.message || 'Failed to fetch segments'\n      };\n    }\n  }\n\n  /**\n   * Get campaigns with pagination\n   * @param {Object} params - { clientId, page, limit }\n   * @returns {Promise<Object>} Campaigns data\n   */\n  async getCampaigns(params = {}) {\n    try {\n      const response = await apiFetchCampaigns(params);\n      return {\n        success: true,\n        data: response.data.data.campaigns,\n        pagination: response.data.data.pagination,\n        error: null\n      };\n    } catch (error) {\n      console.error('Error fetching campaigns:', error);\n      return {\n        success: false,\n        data: null,\n        pagination: null,\n        error: error.response?.data?.message || error.message || 'Failed to fetch campaigns'\n      };\n    }\n  }\n\n  /**\n   * Sync all clients\n   * @returns {Promise<Object>} Sync result\n   */\n  async syncAllClients() {\n    try {\n      const response = await apiSyncAllClients();\n      return {\n        success: response.data.success,\n        data: response.data.results,\n        message: response.data.message,\n        error: null\n      };\n    } catch (error) {\n      console.error('Error syncing all clients:', error);\n      \n      // Handle 409 Conflict (sync already in progress)\n      if (error.response?.status === 409) {\n        return {\n          success: false,\n          data: null,\n          isSyncing: true,\n          message: error.response?.data?.message || 'Sync already in progress',\n          error: error.response?.data?.message || 'Sync already in progress'\n        };\n      }\n      \n      return {\n        success: false,\n        data: null,\n        error: error.response?.data?.message || error.message || 'Failed to sync clients'\n      };\n    }\n  }\n\n  /**\n   * Sync specific client\n   * @param {number} clientId - Client ID\n   * @returns {Promise<Object>} Sync result\n   */\n  async syncClient(clientId) {\n    try {\n      const response = await apiSyncClient(clientId);\n      return {\n        success: response.data.success,\n        data: response.data.data,\n        message: response.data.message,\n        error: null\n      };\n    } catch (error) {\n      console.error('Error syncing client:', error);\n      \n      // Handle 409 Conflict (sync already in progress)\n      if (error.response?.status === 409) {\n        return {\n          success: false,\n          data: null,\n          isSyncing: true,\n          message: error.response?.data?.message || 'Sync already in progress',\n          error: error.response?.data?.message || 'Sync already in progress'\n        };\n      }\n      \n      return {\n        success: false,\n        data: null,\n        error: error.response?.data?.message || error.message || 'Failed to sync client'\n      };\n    }\n  }\n\n  /**\n   * Get current sync status\n   * @returns {Promise<Object>} Sync status\n   */\n  async getSyncStatus() {\n    try {\n      const response = await mauticAPI.get('/sync/status');\n      return {\n        success: true,\n        data: response.data.data,\n        error: null\n      };\n    } catch (error) {\n      console.error('Error fetching sync status:', error);\n      return {\n        success: false,\n        data: { isSyncing: false },\n        error: error.response?.data?.message || error.message || 'Failed to fetch sync status'\n      };\n    }\n  }\n}\n\nexport default new MauticService();\n","\n/**\n * Mautic Custom Hooks\n * \n * React hooks for Mautic data fetching and state management\n */\n\nimport { useState, useEffect, useCallback, useRef } from 'react';\nimport mauticService from '../../services/mautic/mauticService';\n\n/**\n * Hook for fetching dashboard metrics\n * @param {number|null} clientId - Client ID (optional)\n * @returns {Object} { metrics, loading, error, refetch }\n */\nexport function useDashboardMetrics(clientId = null) {\n    const [metrics, setMetrics] = useState(null);\n    const [loading, setLoading] = useState(true);\n    const [error, setError] = useState(null);\n\n    const fetchMetrics = useCallback(async () => {\n        setLoading(true);\n        setError(null);\n\n        const result = await mauticService.getDashboardMetrics(clientId);\n\n        if (result.success) {\n            setMetrics(result.data);\n        } else {\n            setError(result.error);\n        }\n\n        setLoading(false);\n    }, [clientId]);\n\n    useEffect(() => {\n        fetchMetrics();\n    }, [fetchMetrics]);\n\n    return { metrics, loading, error, refetch: fetchMetrics };\n}\n\n/**\n * Hook for fetching clients\n * @returns {Object} { clients, loading, error, refetch }\n */\nexport function useClients() {\n    const [clients, setClients] = useState([]);\n    const [loading, setLoading] = useState(true);\n    const [error, setError] = useState(null);\n\n    const fetchClients = useCallback(async () => {\n        setLoading(true);\n        setError(null);\n\n        const result = await mauticService.getClients();\n\n        if (result.success) {\n            setClients(result.data);\n        } else {\n            setError(result.error);\n        }\n\n        setLoading(false);\n    }, []);\n\n    useEffect(() => {\n        fetchClients();\n    }, [fetchClients]);\n\n    return { clients, loading, error, refetch: fetchClients };\n}\n\n/**\n * Hook for managing client operations\n * @returns {Object} Client management functions\n */\nexport function useClientManagement() {\n    const [isCreating, setIsCreating] = useState(false);\n    const [isUpdating, setIsUpdating] = useState(false);\n    const [isDeleting, setIsDeleting] = useState(false);\n    const [isTesting, setIsTesting] = useState(false);\n    const [error, setError] = useState(null);\n\n    const createClient = useCallback(async (clientData) => {\n        setIsCreating(true);\n        setError(null);\n\n        const result = await mauticService.createClient(clientData);\n\n        setIsCreating(false);\n        return result;\n    }, []);\n\n    const updateClient = useCallback(async (clientId, clientData) => {\n        setIsUpdating(true);\n        setError(null);\n\n        const result = await mauticService.updateClient(clientId, clientData);\n\n        setIsUpdating(false);\n        return result;\n    }, []);\n\n    const deleteClient = useCallback(async (clientId) => {\n        setIsDeleting(true);\n        setError(null);\n\n        const result = await mauticService.deleteClient(clientId);\n\n        setIsDeleting(false);\n        return result;\n    }, []);\n\n    const hardDeleteClient = useCallback(async (clientId) => {\n        setIsDeleting(true);\n        setError(null);\n\n        const result = await mauticService.hardDeleteClient(clientId);\n\n        setIsDeleting(false);\n        return result;\n    }, []);\n\n    const testConnection = useCallback(async (credentials) => {\n        setIsTesting(true);\n        setError(null);\n\n        const result = await mauticService.testConnection(credentials);\n\n        setIsTesting(false);\n        return result;\n    }, []);\n\n    return {\n        createClient,\n        updateClient,\n        deleteClient,\n        hardDeleteClient,\n        testConnection,\n        isCreating,\n        isUpdating,\n        isDeleting,\n        isTesting,\n        error\n    };\n}\n\n/**\n * Hook for fetching contacts with pagination\n * @param {Object} params - { clientId, page, limit, search }\n * @returns {Object} { contacts, pagination, loading, error, refetch }\n */\nexport function useContacts(params = {}) {\n    const [contacts, setContacts] = useState([]);\n    const [pagination, setPagination] = useState(null);\n    const [loading, setLoading] = useState(true);\n    const [error, setError] = useState(null);\n\n    const fetchContacts = useCallback(async () => {\n        setLoading(true);\n        setError(null);\n\n        const result = await mauticService.getContacts(params);\n\n        if (result.success) {\n            setContacts(result.data.contacts);\n            setPagination(result.data.pagination);\n        } else {\n            setError(result.error);\n        }\n\n        setLoading(false);\n    }, [JSON.stringify(params)]);\n\n    useEffect(() => {\n        fetchContacts();\n    }, [fetchContacts]);\n\n    return { contacts, pagination, loading, error, refetch: fetchContacts };\n}\n\n/**\n * Hook for fetching emails with pagination\n * @param {Object} params - { clientId, page, limit }\n * @returns {Object} { emails, pagination, loading, error, refetch }\n */\nexport function useEmails(params = {}) {\n    const [emails, setEmails] = useState([]);\n    const [pagination, setPagination] = useState(null);\n    const [loading, setLoading] = useState(true);\n    const [error, setError] = useState(null);\n\n    const fetchEmails = useCallback(async () => {\n        setLoading(true);\n        setError(null);\n\n        const result = await mauticService.getEmails(params);\n\n        if (result.success) {\n            setEmails(result.data.emails);\n            setPagination(result.data.pagination);\n        } else {\n            setError(result.error);\n        }\n\n        setLoading(false);\n    }, [JSON.stringify(params)]);\n\n    useEffect(() => {\n        fetchEmails();\n    }, [fetchEmails]);\n\n    return { emails, pagination, loading, error, refetch: fetchEmails };\n}\n\n/**\n * Hook for fetching segments with pagination\n * @param {Object} params - { clientId, page, limit }\n * @returns {Object} { segments, pagination, loading, error, refetch }\n */\nexport function useSegments(params = {}) {\n    const [segments, setSegments] = useState([]);\n    const [pagination, setPagination] = useState(null);\n    const [loading, setLoading] = useState(true);\n    const [error, setError] = useState(null);\n\n    const fetchSegments = useCallback(async () => {\n        setLoading(true);\n        setError(null);\n\n        const result = await mauticService.getSegments(params.clientId);\n\n        if (result.success) {\n            setSegments(result.data);\n            // Backend doesn't paginate segments yet, so create mock pagination\n            const total = result.data.length;\n            const page = params.page || 1;\n            const limit = params.limit || 20;\n            const start = (page - 1) * limit;\n            const end = start + limit;\n\n            setSegments(result.data.slice(start, end));\n            setPagination({\n                page,\n                limit,\n                total,\n                totalPages: Math.ceil(total / limit)\n            });\n        } else {\n            setError(result.error);\n        }\n\n        setLoading(false);\n    }, [JSON.stringify(params)]);\n\n    useEffect(() => {\n        fetchSegments();\n    }, [fetchSegments]);\n\n    return { segments, pagination, loading, error, refetch: fetchSegments };\n}\n\n/**\n * Hook for fetching campaigns with pagination\n * @param {Object} params - { clientId, page, limit }\n * @returns {Object} { campaigns, pagination, loading, error, refetch }\n */\nexport function useCampaigns(params = {}) {\n    const [campaigns, setCampaigns] = useState([]);\n    const [pagination, setPagination] = useState(null);\n    const [loading, setLoading] = useState(true);\n    const [error, setError] = useState(null);\n\n    const fetchCampaigns = useCallback(async () => {\n        setLoading(true);\n        setError(null);\n\n        const result = await mauticService.getCampaigns({\n            clientId: params.clientId,\n            page: params.page || 1,\n            limit: params.limit || 20\n        });\n\n        if (result.success) {\n            setCampaigns(result.data);\n            setPagination(result.pagination);\n        } else {\n            setError(result.error);\n        }\n\n        setLoading(false);\n    }, [JSON.stringify(params)]);\n\n    useEffect(() => {\n        fetchCampaigns();\n    }, [fetchCampaigns]);\n\n    return { campaigns, pagination, loading, error, refetch: fetchCampaigns };\n}\n\n/**\n * Hook for syncing data\n * @returns {Object} Sync functions and state\n */\nexport function useSync() {\n    const [isSyncing, setIsSyncing] = useState(false);\n    const [error, setError] = useState(null);\n    const [success, setSuccess] = useState(false);\n    const syncRef = useRef(false); // Track if sync is running\n\n    // Check sync status on mount and periodically\n    useEffect(() => {\n        const checkSyncStatus = async () => {\n            try {\n                const result = await mauticService.getSyncStatus();\n                if (result.success && result.data.isSyncing) {\n                    setIsSyncing(true);\n                    syncRef.current = true;\n                } else if (syncRef.current && !result.data.isSyncing) {\n                    // Sync completed since last check\n                    setIsSyncing(false);\n                    syncRef.current = false;\n                }\n            } catch (err) {\n                console.error('Failed to check sync status:', err);\n            }\n        };\n\n        // Check immediately on mount\n        checkSyncStatus();\n\n        // Check every 3 seconds while syncing\n        const interval = setInterval(() => {\n            if (isSyncing || syncRef.current) {\n                checkSyncStatus();\n            }\n        }, 3000);\n\n        // Cleanup on unmount\n        return () => {\n            clearInterval(interval);\n            syncRef.current = false;\n        };\n    }, [isSyncing]);\n\n    const syncAllClients = useCallback(async () => {\n        try {\n            setIsSyncing(true);\n            syncRef.current = true;\n            setError(null);\n            setSuccess(false);\n\n            const result = await mauticService.syncAllClients();\n\n            if (result.success) {\n                setSuccess(true);\n            } else {\n                setError(result.error || 'Sync failed');\n            }\n\n            return result;\n        } catch (err) {\n            const errorMsg = err.message || 'Failed to sync';\n            setError(errorMsg);\n            return { success: false, error: errorMsg };\n        } finally {\n            if (syncRef.current) { // Only update state if component is still mounted\n                // Small delay to ensure smooth UI transition\n                setTimeout(() => {\n                    setIsSyncing(false);\n                    syncRef.current = false;\n                }, 500);\n            }\n        }\n    }, []);\n\n    const syncClient = useCallback(async (clientId) => {\n        try {\n            setIsSyncing(true);\n            syncRef.current = true;\n            setError(null);\n            setSuccess(false);\n\n            const result = await mauticService.syncClient(clientId);\n\n            if (result.success) {\n                setSuccess(true);\n            } else {\n                setError(result.error || 'Sync failed');\n            }\n\n            return result;\n        } catch (err) {\n            const errorMsg = err.message || 'Failed to sync';\n            setError(errorMsg);\n            return { success: false, error: errorMsg };\n        } finally {\n            if (syncRef.current) { // Only update state if component is still mounted\n                // Small delay to ensure smooth UI transition\n                setTimeout(() => {\n                    setIsSyncing(false);\n                    syncRef.current = false;\n                }, 500);\n            }\n        }\n    }, []);\n\n    return {\n        syncAllClients,\n        syncClient,\n        isSyncing,\n        error,\n        success\n    };\n}\n"],"names":["baseURL","mauticAPI","axios","config","token","fetchClients","createClient","clientData","updateClient","clientId","deleteClient","hardDeleteClient","testConnection","credentials","fetchDashboardMetrics","fetchContacts","params","fetchEmails","fetchSegments","fetchCampaigns","page","limit","syncAllClients","syncClient","MauticService","apiFetchClients","error","response","apiCreateClient","apiUpdateClient","apiDeleteClient","apiHardDeleteClient","apiTestConnection","apiFetchDashboardMetrics","apiFetchContacts","apiFetchEmails","apiFetchSegments","apiFetchCampaigns","apiSyncAllClients","apiSyncClient","mauticService","useDashboardMetrics","metrics","setMetrics","useState","loading","setLoading","setError","fetchMetrics","useCallback","result","useEffect","useClients","clients","setClients","useClientManagement","isCreating","setIsCreating","isUpdating","setIsUpdating","isDeleting","setIsDeleting","isTesting","setIsTesting","useEmails","emails","setEmails","pagination","setPagination","useSegments","segments","setSegments","total","start","end","useCampaigns","campaigns","setCampaigns","useSync","isSyncing","setIsSyncing","success","setSuccess","syncRef","useRef","checkSyncStatus","err","interval","errorMsg"],"mappings":"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"}