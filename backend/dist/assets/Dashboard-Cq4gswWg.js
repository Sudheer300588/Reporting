import{c as Te,a as E,p as q,b as Qe,i as Xe,s as V,d as Je,e as Ye,f as Me,g as ea,h as aa,j as F,k as ta,l as ra,m as sa,n as na,o as Le,q as ia,r as la,t as oa,u as ca,v as da,w as ua,x as _e,y as ma,z as le,A as Ke,B as l,R as pa,S as va,D as $e,C as Be,E as W,F as ga,G as oe,L as G,Z as Fe,H as ce,I as fa,J as ha,K as xa,M as ya,N as ge,O as fe,P as Q,Q as re,T as ba,U as ja,V as Pa,W as Aa,X as Ca,Y as Ea,_ as wa,$ as Na,a0 as Oa,a1 as Sa,a2 as Ra,a3 as Ia,a4 as ka,a5 as U,a6 as he,a7 as Da,a8 as Ta,a9 as Ma,aa as La,ab as _a,ac as Ka,ad as $a,ae as Ba,af as Fa,ag as za,ah as Va,ai as Ga,aj as L,ak as s,al as Wa,am as xe,an as ye,ao as se,ap as be,aq as ne,ar as Ua,as as X,at as je,au as qa,av as Ha,aw as Za,ax as Qa,ay as Pe,az as Ae,aA as Xa}from"./index-CPERY6Kl.js";import{u as Ja}from"./permissions-C8EIoUeu.js";import{F as Ce}from"./folder-open-DzDBH55X.js";import{P as Ee,C as Ya}from"./phone-DTKNWmnz.js";const et=[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"m12 5 7 7-7 7",key:"xquz4c"}]],we=Te("arrow-right",et);const at=[["path",{d:"M4 14a1 1 0 0 1-.78-1.63l9.9-10.2a.5.5 0 0 1 .86.46l-1.92 6.02A1 1 0 0 0 13 10h7a1 1 0 0 1 .78 1.63l-9.9 10.2a.5.5 0 0 1-.86-.46l1.92-6.02A1 1 0 0 0 11 14z",key:"1xq2db"}]],tt=Te("zap",at);var ze=e=>e.graphicalItems.polarItems,rt=E([q,Qe],Xe),J=E([ze,V,rt],Je),st=E([J],Ye),Y=E([st,Me],ea),nt=E([Y,V,J],aa);E([Y,V,J],(e,a,t)=>t.length>0?e.flatMap(r=>t.flatMap(n=>{var o,u=F(r,(o=a.dataKey)!==null&&o!==void 0?o:n.dataKey);return{value:u,errorDomain:[]}})).filter(Boolean):a?.dataKey!=null?e.map(r=>({value:F(r,a.dataKey),errorDomain:[]})):e.map(r=>({value:r,errorDomain:[]})));var Ne=()=>{},it=E([Y,V,J,ta,q],ra),lt=E([V,sa,na,Ne,it,Ne,Le,q],ia),Ve=E([V,Le,Y,nt,la,q,lt],oa),ot=E([Ve,V,ca],da);E([V,Ve,ot,q],ua);function Oe(e,a){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);a&&(r=r.filter(function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable})),t.push.apply(t,r)}return t}function Se(e){for(var a=1;a<arguments.length;a++){var t=arguments[a]!=null?arguments[a]:{};a%2?Oe(Object(t),!0).forEach(function(r){ct(e,r,t[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):Oe(Object(t)).forEach(function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(t,r))})}return e}function ct(e,a,t){return(a=dt(a))in e?Object.defineProperty(e,a,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[a]=t,e}function dt(e){var a=ut(e,"string");return typeof a=="symbol"?a:a+""}function ut(e,a){if(typeof e!="object"||!e)return e;var t=e[Symbol.toPrimitive];if(t!==void 0){var r=t.call(e,a);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(a==="string"?String:Number)(e)}var mt=(e,a)=>a,de=E([ze,mt],(e,a)=>e.filter(t=>t.type==="pie").find(t=>t.id===a)),pt=[],ue=(e,a,t)=>t?.length===0?pt:t,Ge=E([Me,de,ue],(e,a,t)=>{var{chartData:r}=e;if(a!=null){var n;if(a?.data!=null&&a.data.length>0?n=a.data:n=r,(!n||!n.length)&&t!=null&&(n=t.map(o=>Se(Se({},a.presentationProps),o.props))),n!=null)return n}}),vt=E([Ge,de,ue],(e,a,t)=>{if(!(e==null||a==null))return e.map((r,n)=>{var o,u=F(r,a.nameKey,a.name),m;return t!=null&&(o=t[n])!==null&&o!==void 0&&(o=o.props)!==null&&o!==void 0&&o.fill?m=t[n].props.fill:typeof r=="object"&&r!=null&&"fill"in r?m=r.fill:m=a.fill,{value:_e(u,a.dataKey),color:m,payload:r,type:a.legendType}})}),gt=E([Ge,de,ue,ma],(e,a,t,r)=>{if(!(a==null||e==null))return Lt({offset:r,pieSettings:a,displayedData:e,cells:t})}),ft=["key"],ht=["onMouseEnter","onClick","onMouseLeave"],xt=["id"],yt=["id"];function Re(e,a){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);a&&(r=r.filter(function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable})),t.push.apply(t,r)}return t}function f(e){for(var a=1;a<arguments.length;a++){var t=arguments[a]!=null?arguments[a]:{};a%2?Re(Object(t),!0).forEach(function(r){bt(e,r,t[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):Re(Object(t)).forEach(function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(t,r))})}return e}function bt(e,a,t){return(a=jt(a))in e?Object.defineProperty(e,a,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[a]=t,e}function jt(e){var a=Pt(e,"string");return typeof a=="symbol"?a:a+""}function Pt(e,a){if(typeof e!="object"||!e)return e;var t=e[Symbol.toPrimitive];if(t!==void 0){var r=t.call(e,a);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(a==="string"?String:Number)(e)}function z(){return z=Object.assign?Object.assign.bind():function(e){for(var a=1;a<arguments.length;a++){var t=arguments[a];for(var r in t)({}).hasOwnProperty.call(t,r)&&(e[r]=t[r])}return e},z.apply(null,arguments)}function ee(e,a){if(e==null)return{};var t,r,n=At(e,a);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(r=0;r<o.length;r++)t=o[r],a.indexOf(t)===-1&&{}.propertyIsEnumerable.call(e,t)&&(n[t]=e[t])}return n}function At(e,a){if(e==null)return{};var t={};for(var r in e)if({}.hasOwnProperty.call(e,r)){if(a.indexOf(r)!==-1)continue;t[r]=e[r]}return t}function Ct(e){var a=l.useMemo(()=>Be(e.children,ce),[e.children]),t=W(r=>vt(r,e.id,a));return t==null?null:l.createElement(ga,{legendPayload:t})}var Et=l.memo(e=>{var{dataKey:a,nameKey:t,sectors:r,stroke:n,strokeWidth:o,fill:u,name:m,hide:y,tooltipType:c,id:j}=e,p={dataDefinedOnItem:r.map(d=>d.tooltipPayload),positions:r.map(d=>d.tooltipPosition),settings:{stroke:n,strokeWidth:o,fill:u,dataKey:a,nameKey:t,name:_e(m,a),hide:y,type:c,color:u,unit:"",graphicalItemId:j}};return l.createElement(fa,{tooltipEntrySettings:p})}),wt=(e,a)=>e>a?"start":e<a?"end":"middle",Nt=(e,a,t)=>typeof a=="function"?U(a(e),t,t*.8):U(a,t,t*.8),Ot=(e,a,t)=>{var{top:r,left:n,width:o,height:u}=a,m=ka(o,u),y=n+U(e.cx,o,o/2),c=r+U(e.cy,u,u/2),j=U(e.innerRadius,m,0),p=Nt(t,e.outerRadius,m),d=e.maxRadius||Math.sqrt(o*o+u*u)/2;return{cx:y,cy:c,innerRadius:j,outerRadius:p,maxRadius:d}},St=(e,a)=>{var t=Q(a-e),r=Math.min(Math.abs(a-e),360);return t*r};function Rt(e){return e&&typeof e=="object"&&"className"in e&&typeof e.className=="string"?e.className:""}var It=(e,a)=>{if(l.isValidElement(e))return l.cloneElement(e,a);if(typeof e=="function")return e(a);var t=oe("recharts-pie-label-line",typeof e!="boolean"?e.className:""),{key:r}=a,n=ee(a,ft);return l.createElement(Da,z({},n,{type:"linear",className:t}))},kt=(e,a,t)=>{if(l.isValidElement(e))return l.cloneElement(e,a);var r=t;if(typeof e=="function"&&(r=e(a),l.isValidElement(r)))return r;var n=oe("recharts-pie-label-text",Rt(e));return l.createElement(Ta,z({},a,{alignmentBaseline:"middle",className:n}),r)};function Dt(e){var{sectors:a,props:t,showLabels:r}=e,{label:n,labelLine:o,dataKey:u}=t;if(!r||!n||!a)return null;var m=Ke(t),y=he(n),c=he(o),j=typeof n=="object"&&"offsetRadius"in n&&typeof n.offsetRadius=="number"&&n.offsetRadius||20,p=a.map((d,b)=>{var R=(d.startAngle+d.endAngle)/2,A=re(d.cx,d.cy,d.outerRadius+j,R),I=f(f(f(f({},m),d),{},{stroke:"none"},y),{},{index:b,textAnchor:wt(A.x,d.cx)},A),v=f(f(f(f({},m),d),{},{fill:"none",stroke:d.fill},c),{},{index:b,points:[re(d.cx,d.cy,d.outerRadius,R),A],key:"line"});return l.createElement(Fe,{zIndex:$e.label,key:"label-".concat(d.startAngle,"-").concat(d.endAngle,"-").concat(d.midAngle,"-").concat(b)},l.createElement(G,null,o&&It(o,v),kt(n,I,F(d,u))))});return l.createElement(G,{className:"recharts-pie-labels"},p)}function Tt(e){var{sectors:a,props:t,showLabels:r}=e,{label:n}=t;return typeof n=="object"&&n!=null&&"position"in n?l.createElement(Ia,{label:n}):l.createElement(Dt,{sectors:a,props:t,showLabels:r})}function Mt(e){var{sectors:a,activeShape:t,inactiveShape:r,allOtherPieProps:n,shape:o,id:u}=e,m=W(ja),y=W(Pa),c=W(Aa),{onMouseEnter:j,onClick:p,onMouseLeave:d}=n,b=ee(n,ht),R=Ca(j,n.dataKey,u),A=Ea(d),I=wa(p,n.dataKey,u);return a==null||a.length===0?null:l.createElement(l.Fragment,null,a.map((v,w)=>{if(v?.startAngle===0&&v?.endAngle===0&&a.length!==1)return null;var M=c==null||c===u,k=String(w)===m&&(y==null||n.dataKey===y)&&M,D=m?r:null,h=t&&k?t:D,P=f(f({},v),{},{stroke:v.stroke,tabIndex:-1,[Oa]:w,[Na]:u});return l.createElement(G,z({key:"sector-".concat(v?.startAngle,"-").concat(v?.endAngle,"-").concat(v.midAngle,"-").concat(w),tabIndex:-1,className:"recharts-pie-sector"},Sa(b,v,w),{onMouseEnter:R(v,w),onMouseLeave:A(v,w),onClick:I(v,w)}),l.createElement(Ra,z({option:o??h,index:w,shapeType:"sector",isActive:k},P)))}))}function Lt(e){var a,{pieSettings:t,displayedData:r,cells:n,offset:o}=e,{cornerRadius:u,startAngle:m,endAngle:y,dataKey:c,nameKey:j,tooltipType:p}=t,d=Math.abs(t.minAngle),b=St(m,y),R=Math.abs(b),A=r.length<=1?0:(a=t.paddingAngle)!==null&&a!==void 0?a:0,I=r.filter(h=>F(h,c,0)!==0).length,v=(R>=360?I:I-1)*A,w=R-I*d-v,M=r.reduce((h,P)=>{var x=F(P,c,0);return h+(fe(x)?x:0)},0),k;if(M>0){var D;k=r.map((h,P)=>{var x=F(h,c,0),_=F(h,j,P),N=Ot(t,o,h),K=(fe(x)?x:0)/M,i,g=f(f({},h),n&&n[P]&&n[P].props);P?i=D.endAngle+Q(b)*A*(x!==0?1:0):i=m;var C=i+Q(b)*((x!==0?d:0)+K*w),O=(i+C)/2,T=(N.innerRadius+N.outerRadius)/2,ae=[{name:_,value:x,payload:g,dataKey:c,type:p,graphicalItemId:t.id}],$=re(N.cx,N.cy,T,O);return D=f(f(f(f({},t.presentationProps),{},{percent:K,cornerRadius:typeof u=="string"?parseFloat(u):u,name:_,tooltipPayload:ae,midAngle:O,middleRadius:T,tooltipPosition:$},g),N),{},{value:x,dataKey:c,startAngle:i,endAngle:C,payload:g,paddingAngle:Q(b)*A}),D})}return k}function _t(e){var{showLabels:a,sectors:t,children:r}=e,n=l.useMemo(()=>!a||!t?[]:t.map(o=>({value:o.value,payload:o.payload,clockWise:!1,parentViewBox:void 0,viewBox:{cx:o.cx,cy:o.cy,innerRadius:o.innerRadius,outerRadius:o.outerRadius,startAngle:o.startAngle,endAngle:o.endAngle,clockWise:!1},fill:o.fill})),[t,a]);return l.createElement(ba,{value:a?n:void 0},r)}function Kt(e){var{props:a,previousSectorsRef:t,id:r}=e,{sectors:n,isAnimationActive:o,animationBegin:u,animationDuration:m,animationEasing:y,activeShape:c,inactiveShape:j,onAnimationStart:p,onAnimationEnd:d}=a,b=ha(a,"recharts-pie-"),R=t.current,[A,I]=l.useState(!1),v=l.useCallback(()=>{typeof d=="function"&&d(),I(!1)},[d]),w=l.useCallback(()=>{typeof p=="function"&&p(),I(!0)},[p]);return l.createElement(_t,{showLabels:!A,sectors:n},l.createElement(xa,{animationId:b,begin:u,duration:m,isActive:o,easing:y,onAnimationStart:w,onAnimationEnd:v,key:b},M=>{var k=[],D=n&&n[0],h=D?.startAngle;return n?.forEach((P,x)=>{var _=R&&R[x],N=x>0?ya(P,"paddingAngle",0):0;if(_){var K=ge(_.endAngle-_.startAngle,P.endAngle-P.startAngle,M),i=f(f({},P),{},{startAngle:h+N,endAngle:h+K+N});k.push(i),h=i.endAngle}else{var{endAngle:g,startAngle:C}=P,O=ge(0,g-C,M),T=f(f({},P),{},{startAngle:h+N,endAngle:h+O+N});k.push(T),h=T.endAngle}}),t.current=k,l.createElement(G,null,l.createElement(Mt,{sectors:k,activeShape:c,inactiveShape:j,allOtherPieProps:a,shape:a.shape,id:r}))}),l.createElement(Tt,{showLabels:!A,sectors:n,props:a}),a.children)}var $t={animationBegin:400,animationDuration:1500,animationEasing:"ease",cx:"50%",cy:"50%",dataKey:"value",endAngle:360,fill:"#808080",hide:!1,innerRadius:0,isAnimationActive:"auto",label:!1,labelLine:!0,legendType:"rect",minAngle:0,nameKey:"name",outerRadius:"80%",paddingAngle:0,rootTabIndex:0,startAngle:0,stroke:"#fff",zIndex:$e.area};function Bt(e){var{id:a}=e,t=ee(e,xt),{hide:r,className:n,rootTabIndex:o}=e,u=l.useMemo(()=>Be(e.children,ce),[e.children]),m=W(j=>gt(j,a,u)),y=l.useRef(null),c=oe("recharts-pie",n);return r||m==null?(y.current=null,l.createElement(G,{tabIndex:o,className:c})):l.createElement(Fe,{zIndex:e.zIndex},l.createElement(Et,{dataKey:e.dataKey,nameKey:e.nameKey,sectors:m,stroke:e.stroke,strokeWidth:e.strokeWidth,fill:e.fill,name:e.name,hide:e.hide,tooltipType:e.tooltipType,id:a}),l.createElement(G,{tabIndex:o,className:c},l.createElement(Kt,{props:f(f({},t),{},{sectors:m}),previousSectorsRef:y,id:a})))}function We(e){var a=le(e,$t),{id:t}=a,r=ee(a,yt),n=Ke(r);return l.createElement(pa,{id:t,type:"pie"},o=>l.createElement(l.Fragment,null,l.createElement(va,{type:"pie",id:o,data:r.data,dataKey:r.dataKey,hide:r.hide,angleAxisId:0,radiusAxisId:0,name:r.name,nameKey:r.nameKey,tooltipType:r.tooltipType,legendType:r.legendType,fill:r.fill,cx:r.cx,cy:r.cy,startAngle:r.startAngle,endAngle:r.endAngle,paddingAngle:r.paddingAngle,minAngle:r.minAngle,innerRadius:r.innerRadius,outerRadius:r.outerRadius,cornerRadius:r.cornerRadius,presentationProps:n,maxRadius:a.maxRadius}),l.createElement(Ct,z({},r,{id:o})),l.createElement(Bt,z({},r,{id:o}))))}We.displayName="Pie";function Ft(e){var a=Ma();return l.useEffect(()=>{a(La(e))},[a,e]),null}var zt=["layout"];function ie(){return ie=Object.assign?Object.assign.bind():function(e){for(var a=1;a<arguments.length;a++){var t=arguments[a];for(var r in t)({}).hasOwnProperty.call(t,r)&&(e[r]=t[r])}return e},ie.apply(null,arguments)}function Vt(e,a){if(e==null)return{};var t,r,n=Gt(e,a);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(r=0;r<o.length;r++)t=o[r],a.indexOf(t)===-1&&{}.propertyIsEnumerable.call(e,t)&&(n[t]=e[t])}return n}function Gt(e,a){if(e==null)return{};var t={};for(var r in e)if({}.hasOwnProperty.call(e,r)){if(a.indexOf(r)!==-1)continue;t[r]=e[r]}return t}var Wt={top:5,right:5,bottom:5,left:5},Ue={accessibilityLayer:!0,stackOffset:"none",barCategoryGap:"10%",barGap:4,margin:Wt,reverseStackOrder:!1,syncMethod:"index",layout:"radial",responsive:!1,cx:"50%",cy:"50%",innerRadius:0,outerRadius:"80%"},Ut=l.forwardRef(function(a,t){var r,n=le(a.categoricalChartProps,Ue),{layout:o}=n,u=Vt(n,zt),{chartName:m,defaultTooltipEventType:y,validateTooltipEventTypes:c,tooltipPayloadSearcher:j}=a,p={chartName:m,defaultTooltipEventType:y,validateTooltipEventTypes:c,tooltipPayloadSearcher:j,eventEmitter:void 0};return l.createElement(_a,{preloadedState:{options:p},reduxStoreName:(r=n.id)!==null&&r!==void 0?r:m},l.createElement(Ka,{chartData:n.data}),l.createElement($a,{layout:o,margin:n.margin}),l.createElement(Ba,{baseValue:void 0,accessibilityLayer:n.accessibilityLayer,barCategoryGap:n.barCategoryGap,maxBarSize:n.maxBarSize,stackOffset:n.stackOffset,barGap:n.barGap,barSize:n.barSize,syncId:n.syncId,syncMethod:n.syncMethod,className:n.className,reverseStackOrder:n.reverseStackOrder}),l.createElement(Ft,{cx:n.cx,cy:n.cy,startAngle:n.startAngle,endAngle:n.endAngle,innerRadius:n.innerRadius,outerRadius:n.outerRadius}),l.createElement(Fa,ie({},u,{ref:t})))});function Ie(e,a){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);a&&(r=r.filter(function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable})),t.push.apply(t,r)}return t}function ke(e){for(var a=1;a<arguments.length;a++){var t=arguments[a]!=null?arguments[a]:{};a%2?Ie(Object(t),!0).forEach(function(r){qt(e,r,t[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):Ie(Object(t)).forEach(function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(t,r))})}return e}function qt(e,a,t){return(a=Ht(a))in e?Object.defineProperty(e,a,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[a]=t,e}function Ht(e){var a=Zt(e,"string");return typeof a=="symbol"?a:a+""}function Zt(e,a){if(typeof e!="object"||!e)return e;var t=e[Symbol.toPrimitive];if(t!==void 0){var r=t.call(e,a);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(a==="string"?String:Number)(e)}var Qt=["item"],Xt=ke(ke({},Ue),{},{layout:"centric",startAngle:0,endAngle:360}),Jt=l.forwardRef((e,a)=>{var t=le(e,Xt);return l.createElement(Ut,{chartName:"PieChart",defaultTooltipEventType:"item",validateTooltipEventTypes:Qt,tooltipPayloadSearcher:za,categoricalChartProps:t,ref:a})});const nr=()=>{const{user:e}=Va(),a=Ga(),{hasFullAccess:t,canViewClients:r,canViewUsers:n}=Ja(e),[o,u]=l.useState(!0),[m,y]=l.useState({totalEmployees:0,totalClients:0,totalManagers:0,totalAdmins:0}),[c,j]=l.useState(null),[p,d]=l.useState(null),[b,R]=l.useState({mautic:null,dropCowboy:null}),[A,I]=l.useState([]);l.useEffect(()=>{v()},[]);const v=async()=>{u(!0);try{await Promise.all([w(),M(),k(),D()])}catch(i){console.error("Error fetching dashboard data:",i)}finally{u(!1)}},w=async()=>{try{const i=[];n()?i.push(L.get("/api/users").catch(()=>({data:{users:[]}}))):i.push(Promise.resolve({data:{users:[]}})),i.push(L.get("/api/clients").catch(()=>({data:[]}))),i.push(L.get("/api/mautic/clients").catch(()=>({data:{data:[]}})));const[g,C,O]=await Promise.all(i),T=g.data.users||[],ae=C.data||[],$=O.data?.data||[],me=S=>S?.customRoleId?S?.customRole?.fullAccess||S?.customRole?.isTeamManager:["superadmin","admin","manager"].includes(S?.role),qe=T.filter(me).length,He=T.filter(S=>!me(S)).length,Ze=T.filter(S=>S?.customRole?.fullAccess||!S?.customRoleId&&S?.role==="admin").length;let pe=$.length;t()||(pe=$.filter(S=>(S.client?.assignments||[]).some(ve=>(ve.userId||ve.user?.id)===e.id)||S.client?.createdById===e.id).length),y({totalEmployees:t()?He:0,totalClients:pe,totalManagers:t()?qe:0,totalAdmins:t()?Ze:0})}catch(i){console.error("Error fetching stats:",i)}},M=async()=>{try{const i=await L.get("/api/mautic/dashboard");i.data&&(j(i.data),h(i.data,"email"))}catch(i){console.error("Error fetching email metrics:",i)}},k=async()=>{try{const i=await L.get("/api/dropcowboy/metrics");i.data?.success&&(d(i.data.data),h(i.data.data,"voicemail"))}catch(i){console.error("Error fetching voicemail metrics:",i)}},D=async()=>{try{const[i,g]=await Promise.all([L.get("/api/mautic/sync/status").catch(()=>({data:null})),L.get("/api/dropcowboy/sync-status").catch(()=>({data:null}))]);R({mautic:i.data,dropCowboy:g.data})}catch(i){console.error("Error fetching sync status:",i)}},h=(i,g)=>{const C=[];if(g==="email"&&i&&(i.avgReadRate&&parseFloat(i.avgReadRate)<20&&C.push({id:"email-open-rate",type:"warning",title:"Low Email Open Rates",description:`Average open rate is ${i.avgReadRate}%. Consider optimizing subject lines.`,action:"View Emails",link:"/services"}),i.totalBounced>100&&C.push({id:"email-bounce",type:"error",title:"High Bounce Rate",description:`${i.totalBounced} emails bounced. Review email list quality.`,action:"Review",link:"/services"})),g==="voicemail"&&i?.overall){const O=parseFloat(i.overall.averageSuccessRate||0);O<70&&i.overall.totalSent>0&&C.push({id:"voicemail-delivery",type:"warning",title:"Voicemail Delivery Issues",description:`Only ${O}% delivery success. Check phone number quality.`,action:"View Records",link:"/services"})}C.length>0&&I(O=>{const T=new Set(C.map($=>$.id));return[...O.filter($=>!T.has($.id)),...C]})},P=()=>{const i=new Date().getHours();return i<12?"Good morning":i<18?"Good afternoon":"Good evening"},x=i=>i>=1e6?(i/1e6).toFixed(1)+"M":i>=1e3?(i/1e3).toFixed(1)+"K":i?.toString()||"0",_=i=>new Intl.NumberFormat("en-US",{style:"currency",currency:"USD",minimumFractionDigits:2}).format(i||0),N=l.useMemo(()=>c?.topEmails?c.topEmails.slice(0,7).map((i,g)=>({name:i.name?.substring(0,15)||`Email ${g+1}`,sent:i.sentCount||0,opened:i.readCount||0,rate:parseFloat(i.readRate||0)})):[],[c]);l.useMemo(()=>p?.campaigns?p.campaigns.slice(0,6).map(i=>({name:i.campaignName?.substring(0,12)||"Campaign",sent:i.totalSent||0,delivered:i.successfulDeliveries||0,rate:parseFloat(i.successRate||0)})):[],[p]);const K=l.useMemo(()=>{if(!p?.overall)return[];const{successfulDeliveries:i,failedSends:g,otherStatus:C}=p.overall;return[{name:"Delivered",value:i||0,color:"#10B981"},{name:"Failed",value:g||0,color:"#EF4444"},{name:"Other",value:C||0,color:"#6B7280"}].filter(O=>O.value>0)},[p]);return o?s.jsx("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:s.jsx("div",{className:"flex items-center justify-center h-64",children:s.jsx(Wa,{className:"h-12 w-12 animate-spin text-primary-600"})})}):s.jsxs("div",{className:"max-w-7xl pb-8 mx-auto px-4 sm:px-6 lg:px-8 animate-fade-in",children:[s.jsx("div",{className:"card mb-6",children:s.jsxs("div",{className:"flex justify-between items-start",children:[s.jsxs("div",{children:[s.jsxs("h1",{className:"text-2xl md:text-3xl font-bold text-gray-900 mb-2",children:[P(),", ",e.name,"!"]}),s.jsx("p",{className:"text-gray-600 text-sm",children:"Welcome to your dashboard. Here's an overview of your business."})]}),s.jsxs("button",{onClick:v,className:"flex items-center gap-2 px-3 py-2 text-sm bg-gray-100 hover:bg-gray-200 rounded-lg transition-colors",children:[s.jsx(xe,{size:16}),"Refresh"]})]})}),t()&&s.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-3 mb-6",children:[s.jsx(De,{label:"Mautic",status:b.mautic,lastSync:b.mautic?.lastSyncAt||b.mautic?.lastSync}),s.jsx(De,{label:"DropCowboy",status:b.dropCowboy,lastSync:b.dropCowboy?.lastSyncAt||p?.lastUpdated})]}),s.jsxs("div",{className:"grid grid-cols-2 lg:grid-cols-4 gap-4 mb-6",children:[s.jsx(H,{title:n()?"Team Members":"My Team",value:m.totalEmployees,icon:ye,color:"primary",onClick:()=>a("/employees")}),s.jsx(H,{title:r()?"Total Clients":"My Clients",value:m.totalClients,icon:Ce,color:"secondary",onClick:()=>a("/clients")}),t()&&s.jsxs(s.Fragment,{children:[s.jsx(H,{title:"Managers",value:m.totalManagers,icon:se,color:"purple",onClick:()=>a("/employees")}),s.jsx(H,{title:"Admins",value:m.totalAdmins,icon:tt,color:"accent",onClick:()=>a("/employees")})]})]}),A.length>0&&s.jsxs("div",{className:"mb-6",children:[s.jsx("h2",{className:"text-lg font-semibold text-gray-900 mb-3",children:"Insights & Alerts"}),s.jsx("div",{className:"grid gap-3",children:A.map((i,g)=>s.jsx(Yt,{insight:i,onClick:()=>a(i.link)},g))})]}),s.jsxs("div",{className:"grid lg:grid-cols-2 gap-6 mb-6",children:[c&&s.jsxs("div",{className:"card",children:[s.jsxs("div",{className:"flex items-center justify-between mb-4",children:[s.jsxs("h2",{className:"text-lg font-semibold text-gray-900 flex items-center gap-2",children:[s.jsx(be,{className:"text-blue-600",size:20}),"Email Performance"]}),s.jsxs("button",{onClick:()=>a("/services"),className:"text-sm text-primary-600 hover:text-primary-700 flex items-center gap-1",children:["View All ",s.jsx(we,{size:14})]})]}),s.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4 mb-4",children:[s.jsx(B,{label:"Total Sent",value:x(c.totalSent),icon:be}),s.jsx(B,{label:"Opened",value:x(c.totalRead),icon:ne,color:"green"}),s.jsx(B,{label:"Clicked",value:x(c.totalClicked),icon:Ua,color:"blue"}),s.jsx(B,{label:"Bounced",value:x(c.totalBounced),icon:X,color:"red"})]}),s.jsxs("div",{className:"grid grid-cols-3 gap-2 mb-4",children:[s.jsx(te,{label:"Open Rate",value:c.avgReadRate}),s.jsx(te,{label:"Click Rate",value:c.avgClickRate}),s.jsx(te,{label:"Unsub Rate",value:c.avgUnsubscribeRate,isNegative:!0})]}),N.length>0&&s.jsx("div",{className:"h-48",children:s.jsx(je,{width:"100%",height:"100%",children:s.jsxs(qa,{data:N,children:[s.jsx(Ha,{strokeDasharray:"3 3",stroke:"#E5E7EB"}),s.jsx(Za,{dataKey:"name",tick:{fontSize:10}}),s.jsx(Qa,{tick:{fontSize:10}}),s.jsx(Pe,{}),s.jsx(Ae,{dataKey:"sent",fill:"#94A3B8",name:"Sent",radius:[4,4,0,0]}),s.jsx(Ae,{dataKey:"opened",fill:"#3B82F6",name:"Opened",radius:[4,4,0,0]})]})})})]}),p?.overall&&s.jsxs("div",{className:"card",children:[s.jsxs("div",{className:"flex items-center justify-between mb-4",children:[s.jsxs("h2",{className:"text-lg font-semibold text-gray-900 flex items-center gap-2",children:[s.jsx(Ee,{className:"text-green-600",size:20}),"Voicemail Performance"]}),s.jsxs("button",{onClick:()=>a("/services"),className:"text-sm text-primary-600 hover:text-primary-700 flex items-center gap-1",children:["View All ",s.jsx(we,{size:14})]})]}),s.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4 mb-4",children:[s.jsx(B,{label:"Total Sent",value:x(p.overall.totalSent),icon:Ee}),s.jsx(B,{label:"Delivered",value:x(p.overall.successfulDeliveries),icon:ne,color:"green"}),s.jsx(B,{label:"Failed",value:x(p.overall.failedSends),icon:X,color:"red"}),s.jsx(B,{label:"Total Cost",value:_(p.overall.totalCost),icon:Xa,color:"purple"})]}),s.jsx("div",{className:"flex items-center justify-between mb-4",children:s.jsxs("div",{className:"flex-1",children:[s.jsx("div",{className:"text-sm text-gray-600 mb-1",children:"Success Rate"}),s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx("div",{className:"flex-1 bg-gray-200 rounded-full h-3",children:s.jsx("div",{className:"bg-green-500 h-3 rounded-full transition-all duration-500",style:{width:`${Math.min(p.overall.averageSuccessRate,100)}%`}})}),s.jsxs("span",{className:"text-lg font-semibold text-green-600",children:[p.overall.averageSuccessRate,"%"]})]})]})}),K.length>0&&s.jsx("div",{className:"h-40 flex items-center justify-center",children:s.jsx(je,{width:"100%",height:"100%",children:s.jsxs(Jt,{children:[s.jsx(We,{data:K,cx:"50%",cy:"50%",innerRadius:40,outerRadius:60,dataKey:"value",label:({name:i,percent:g})=>`${i} ${(g*100).toFixed(0)}%`,children:K.map((i,g)=>s.jsx(ce,{fill:i.color},`cell-${g}`))}),s.jsx(Pe,{})]})})})]})]}),t()&&s.jsxs("div",{className:"card",children:[s.jsx("h2",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Quick Actions"}),s.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-3",children:[s.jsx(Z,{icon:xe,label:"Sync All Data",onClick:()=>{L.post("/api/mautic/sync/all").catch(()=>{}),L.post("/api/dropcowboy/fetch").catch(()=>{}),v()}}),s.jsx(Z,{icon:Ce,label:"Manage Clients",onClick:()=>a("/clients")}),s.jsx(Z,{icon:ye,label:"Manage Users",onClick:()=>a("/employees")}),s.jsx(Z,{icon:se,label:"View Activity",onClick:()=>a("/activities")})]})]})]})},H=({title:e,value:a,icon:t,color:r,onClick:n})=>{const o={primary:"from-primary-500 to-primary-700",secondary:"from-secondary-500 to-secondary-700",purple:"from-purple-500 to-purple-700",accent:"from-accent-500 to-accent-700"};return s.jsxs("div",{onClick:n,className:`stats-card bg-gradient-to-br ${o[r]} cursor-pointer transform hover:scale-105 transition-transform`,children:[s.jsx("div",{className:"text-3xl font-bold mb-2",children:a}),s.jsxs("div",{className:"flex items-center text-sm opacity-90",children:[s.jsx(t,{size:16,className:"mr-2"}),e]})]})},B=({label:e,value:a,icon:t,color:r="gray"})=>{const n={gray:"text-gray-600",green:"text-green-600",blue:"text-blue-600",red:"text-red-600",purple:"text-purple-600"};return s.jsxs("div",{className:"bg-gray-50 rounded-lg p-3 text-center",children:[s.jsx(t,{size:18,className:`mx-auto mb-1 ${n[r]}`}),s.jsx("div",{className:"text-lg font-semibold text-gray-900",children:a}),s.jsx("div",{className:"text-xs text-gray-500",children:e})]})},te=({label:e,value:a,isNegative:t=!1})=>{const r=parseFloat(a||0),n=t?r>5?"text-red-600":"text-green-600":r>20?"text-green-600":r>10?"text-yellow-600":"text-red-600";return s.jsxs("div",{className:"bg-gray-50 rounded-lg p-2 text-center",children:[s.jsxs("div",{className:`text-lg font-semibold ${n}`,children:[r.toFixed(1),"%"]}),s.jsx("div",{className:"text-xs text-gray-500",children:e})]})},De=({label:e,status:a,lastSync:t})=>{const r=t&&new Date-new Date(t)<36e5;return s.jsxs("div",{className:"bg-white rounded-lg border border-gray-200 p-3 flex items-center gap-3",children:[s.jsx("div",{className:`w-2 h-2 rounded-full ${r?"bg-green-500":"bg-yellow-500"}`}),s.jsxs("div",{className:"flex-1 min-w-0",children:[s.jsx("div",{className:"text-sm font-medium text-gray-900",children:e}),s.jsxs("div",{className:"text-xs text-gray-500 flex items-center gap-1",children:[s.jsx(Ya,{size:10}),t?new Date(t).toLocaleString():"Never synced"]})]})]})},Yt=({insight:e,onClick:a})=>{const t={warning:{bg:"bg-yellow-50",border:"border-yellow-200",icon:X,iconColor:"text-yellow-600"},error:{bg:"bg-red-50",border:"border-red-200",icon:X,iconColor:"text-red-600"},success:{bg:"bg-green-50",border:"border-green-200",icon:ne,iconColor:"text-green-600"},info:{bg:"bg-blue-50",border:"border-blue-200",icon:se,iconColor:"text-blue-600"}},r=t[e.type]||t.info,n=r.icon;return s.jsxs("div",{className:`${r.bg} ${r.border} border rounded-lg p-4 flex items-center justify-between`,children:[s.jsxs("div",{className:"flex items-center gap-3",children:[s.jsx(n,{className:r.iconColor,size:20}),s.jsxs("div",{children:[s.jsx("div",{className:"font-medium text-gray-900",children:e.title}),s.jsx("div",{className:"text-sm text-gray-600",children:e.description})]})]}),e.action&&s.jsx("button",{onClick:a,className:"px-3 py-1.5 text-sm bg-white border border-gray-300 rounded-lg hover:bg-gray-50 transition-colors",children:e.action})]})},Z=({icon:e,label:a,onClick:t})=>s.jsxs("button",{onClick:t,className:"flex flex-col items-center gap-2 p-4 bg-gray-50 hover:bg-gray-100 rounded-lg transition-colors",children:[s.jsx(e,{size:24,className:"text-primary-600"}),s.jsx("span",{className:"text-sm font-medium text-gray-700",children:a})]});export{nr as default};
//# sourceMappingURL=Dashboard-Cq4gswWg.js.map
