{"version":3,"file":"permissions-C8EIoUeu.js","sources":["../../src/utils/permissions.js"],"sourcesContent":["export const createPermissionHelpers = (user) => {\n  const hasFullAccess = () => {\n    if (user?.customRole?.fullAccess === true) return true\n    if (!user?.customRoleId && ['superadmin', 'admin'].includes(user?.role)) return true\n    return false\n  }\n\n  const hasPermission = (module, action) => {\n    if (hasFullAccess()) return true\n    const modulePerms = user?.customRole?.permissions?.[module]\n    if (Array.isArray(modulePerms)) {\n      if (modulePerms.includes(action)) return true\n    } else if (modulePerms && typeof modulePerms === 'object') {\n      if (modulePerms[action] === true) return true\n    }\n    // Backward compatibility for legacy manager without customRole\n    if (!user?.customRoleId && user?.role === 'manager') {\n      if (module === 'Users' && ['Create', 'Read', 'Update'].includes(action)) return true\n      if (module === 'Clients' && ['Create', 'Read', 'Update', 'Delete'].includes(action)) return true\n      if (module === 'Activities' && action === 'Read') return true\n    }\n    return false\n  }\n\n  const isTeamManager = () => {\n    if (hasFullAccess()) return true\n    if (user?.customRole?.isTeamManager === true) return true\n    if (!user?.customRoleId && user?.role === 'manager') return true\n    return false\n  }\n\n  const canViewClients = () => hasFullAccess() || hasPermission('Clients', 'Read')\n  const canViewUsers = () => hasFullAccess() || hasPermission('Users', 'Read')\n  const canEditClients = () => hasFullAccess() || hasPermission('Clients', 'Update')\n  const canCreateClients = () => hasFullAccess() || hasPermission('Clients', 'Create')\n  const canDeleteClients = () => hasFullAccess() || hasPermission('Clients', 'Delete')\n  const canEditUsers = () => hasFullAccess() || hasPermission('Users', 'Update')\n  const canCreateUsers = () => hasFullAccess() || hasPermission('Users', 'Create')\n  const canDeleteUsers = () => hasFullAccess() || hasPermission('Users', 'Delete')\n  const canViewActivities = () => hasFullAccess() || hasPermission('Activities', 'Read')\n  const canViewSettings = () => hasFullAccess() || hasPermission('Settings', 'Read')\n  const canEditSettings = () => hasFullAccess() || hasPermission('Settings', 'Update')\n\n  return {\n    hasFullAccess,\n    hasPermission,\n    isTeamManager,\n    canViewClients,\n    canViewUsers,\n    canEditClients,\n    canCreateClients,\n    canDeleteClients,\n    canEditUsers,\n    canCreateUsers,\n    canDeleteUsers,\n    canViewActivities,\n    canViewSettings,\n    canEditSettings\n  }\n}\n\nexport const usePermissions = (user) => {\n  return createPermissionHelpers(user)\n}\n"],"names":["createPermissionHelpers","user","hasFullAccess","hasPermission","module","action","modulePerms","usePermissions"],"mappings":"AAAO,MAAMA,EAA2BC,GAAS,CAC/C,MAAMC,EAAgB,IAChB,GAAAD,GAAM,YAAY,aAAe,IACjC,CAACA,GAAM,cAAgB,CAAC,aAAc,OAAO,EAAE,SAASA,GAAM,IAAI,GAIlEE,EAAgB,CAACC,EAAQC,IAAW,CACxC,GAAIH,EAAa,EAAI,MAAO,GAC5B,MAAMI,EAAcL,GAAM,YAAY,cAAcG,CAAM,EAC1D,GAAI,MAAM,QAAQE,CAAW,GAC3B,GAAIA,EAAY,SAASD,CAAM,EAAG,MAAO,WAChCC,GAAe,OAAOA,GAAgB,UAC3CA,EAAYD,CAAM,IAAM,GAAM,MAAO,GAG3C,MAAI,IAACJ,GAAM,cAAgBA,GAAM,OAAS,YACpCG,IAAW,SAAW,CAAC,SAAU,OAAQ,QAAQ,EAAE,SAASC,CAAM,GAClED,IAAW,WAAa,CAAC,SAAU,OAAQ,SAAU,QAAQ,EAAE,SAASC,CAAM,GAC9ED,IAAW,cAAgBC,IAAW,QAG9C,EAqBA,MAAO,CACL,cAAAH,EACA,cAAAC,EACA,cAtBoB,IAChB,GAAAD,EAAa,GACbD,GAAM,YAAY,gBAAkB,IACpC,CAACA,GAAM,cAAgBA,GAAM,OAAS,WAoB1C,eAhBqB,IAAMC,EAAa,GAAMC,EAAc,UAAW,MAAM,EAiB7E,aAhBmB,IAAMD,EAAa,GAAMC,EAAc,QAAS,MAAM,EAiBzE,eAhBqB,IAAMD,EAAa,GAAMC,EAAc,UAAW,QAAQ,EAiB/E,iBAhBuB,IAAMD,EAAa,GAAMC,EAAc,UAAW,QAAQ,EAiBjF,iBAhBuB,IAAMD,EAAa,GAAMC,EAAc,UAAW,QAAQ,EAiBjF,aAhBmB,IAAMD,EAAa,GAAMC,EAAc,QAAS,QAAQ,EAiB3E,eAhBqB,IAAMD,EAAa,GAAMC,EAAc,QAAS,QAAQ,EAiB7E,eAhBqB,IAAMD,EAAa,GAAMC,EAAc,QAAS,QAAQ,EAiB7E,kBAhBwB,IAAMD,EAAa,GAAMC,EAAc,aAAc,MAAM,EAiBnF,gBAhBsB,IAAMD,EAAa,GAAMC,EAAc,WAAY,MAAM,EAiB/E,gBAhBsB,IAAMD,EAAa,GAAMC,EAAc,WAAY,QAAQ,CAiBrF,CACA,EAEaI,EAAkBN,GACtBD,EAAwBC,CAAI"}