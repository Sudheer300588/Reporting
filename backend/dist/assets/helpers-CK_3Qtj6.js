import{aj as h,B as a}from"./index-CPERY6Kl.js";const m="",g=h.create({baseURL:`${m}/api/dropcowboy`,headers:{"Content-Type":"application/json"}});g.interceptors.request.use(r=>{const e=localStorage.getItem("token");return e&&(r.headers.Authorization=`Bearer ${e}`),r});const S=async(r={})=>{try{const e=new URLSearchParams;return r.startDate&&e.append("startDate",r.startDate),r.endDate&&e.append("endDate",r.endDate),r.campaignName&&e.append("campaignName",r.campaignName),r.campaignIds&&Array.isArray(r.campaignIds)&&e.append("campaignIds",r.campaignIds.join(",")),(await g.get(`/metrics?${e.toString()}`)).data}catch(e){throw console.error("Error fetching metrics:",e),e}},w=async()=>{try{return(await g.post("/fetch")).data}catch(r){throw console.error("Error triggering manual fetch:",r),r}},F=async(r=20)=>{try{return(await g.get(`/sync-logs?limit=${r}`)).data}catch(e){throw console.error("Error fetching sync logs:",e),e}},E=async r=>{try{return(await g.get(`/campaigns/${r}`)).data}catch(e){throw console.error("Error fetching campaign details:",e),e}};class D{async getMetrics(e={}){try{return{success:!0,data:(await S(e)).data,error:null}}catch(s){return console.error("Error fetching metrics:",s),{success:!1,data:null,error:s.response?.data?.message||s.message||"Failed to fetch metrics"}}}async triggerFetch(){try{return{success:!0,data:(await w()).data,error:null}}catch(e){return console.error("Error triggering manual fetch:",e),e.response?.status===409?{success:!1,data:null,isSyncing:!0,message:e.response?.data?.message||"Sync already in progress",error:e.response?.data?.message||"Sync already in progress"}:{success:!1,data:null,error:e.response?.data?.message||e.message||"Failed to trigger fetch"}}}async getSyncLogs(e=10){try{return{success:!0,data:(await F(e)).data,error:null}}catch(s){return console.error("Error fetching sync logs:",s),{success:!1,data:null,error:s.response?.data?.message||s.message||"Failed to fetch sync logs"}}}async getCampaignDetails(e){try{return{success:!0,data:(await E(e)).data,error:null}}catch(s){return console.error("Error fetching campaign details:",s),{success:!1,data:null,error:s.response?.data?.message||s.message||"Failed to fetch campaign details"}}}async getSyncStatus(){try{return{success:!0,data:(await g.get("/sync-status")).data.data,error:null}}catch(e){return console.error("Error fetching sync status:",e),{success:!1,data:{isSyncing:!1},error:e.response?.data?.message||e.message||"Failed to fetch sync status"}}}}const f=new D;function b(r={}){const[e,s]=a.useState(null),[c,l]=a.useState(!0),[o,i]=a.useState(null),[t,u]=a.useState(r),n=a.useCallback(async(y=t)=>{try{l(!0),i(null);const d=await f.getMetrics(y);d.success?s(d.data):i(d.error)}catch(d){i(d.message||"Failed to fetch metrics")}finally{l(!1)}},[t]);a.useEffect(()=>{n()},[n]);const p=a.useCallback(()=>{n(t)},[n,t]);return{metrics:e,loading:c,error:o,refetch:p,setFilters:u,filters:t}}function C(r=10){const[e,s]=a.useState([]),[c,l]=a.useState(!0),[o,i]=a.useState(null),t=a.useCallback(async()=>{try{l(!0),i(null);const n=await f.getSyncLogs(r);n.success?s(n.data||[]):i(n.error)}catch(n){i(n.message||"Failed to fetch sync logs")}finally{l(!1)}},[r]);a.useEffect(()=>{t()},[t]);const u=a.useCallback(()=>{t()},[t]);return{syncLogs:e,loading:c,error:o,refetch:u}}function I(){const[r,e]=a.useState(!1),[s,c]=a.useState(null),[l,o]=a.useState(!1);return a.useEffect(()=>{const t=async()=>{try{const n=await f.getSyncStatus();n.success&&n.data.isSyncing&&e(!0)}catch(n){console.error("Failed to check sync status:",n)}};t();const u=setInterval(()=>{r&&t()},3e3);return()=>clearInterval(u)},[r]),{triggerFetch:a.useCallback(async()=>{try{e(!0),c(null),o(!1);const t=await f.triggerFetch();return!t.success&&t.isSyncing?(c(t.message||"Sync already in progress"),{success:!1,error:t.message}):t.success?(o(!0),{success:!0,data:t.data}):(c(t.error),o(!1),{success:!1,error:t.error})}catch(t){const u=t.message||"Failed to trigger fetch";return c(u),o(!1),{success:!1,error:u}}finally{setTimeout(()=>e(!1),500)}},[]),isFetching:r,error:s,success:l}}function k(r){return r==null?"0":r.toLocaleString()}function M(r,e=2){return r==null?"0%":`${parseFloat(r).toFixed(e)}%`}function N(r,e=!1){if(!r)return"N/A";const s=new Date(r);if(isNaN(s.getTime()))return"Invalid Date";const c={year:"numeric",month:"short",day:"numeric"};return e&&(c.hour="2-digit",c.minute="2-digit"),s.toLocaleDateString("en-US",c)}function A(r){try{return new URL(r),!0}catch{return!1}}export{b as a,C as b,N as c,M as d,k as f,A as i,I as u};
//# sourceMappingURL=helpers-CK_3Qtj6.js.map
