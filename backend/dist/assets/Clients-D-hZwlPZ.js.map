{"version":3,"file":"Clients-D-hZwlPZ.js","sources":["../../node_modules/lucide-react/dist/esm/icons/circle-arrow-left.js","../../node_modules/lucide-react/dist/esm/icons/circle-arrow-right.js","../../node_modules/lucide-react/dist/esm/icons/dollar-sign.js","../../node_modules/lucide-react/dist/esm/icons/phone-off.js","../../node_modules/lucide-react/dist/esm/icons/shield-question-mark.js","../../src/components/dropCowboy/MetricsCards.jsx","../../src/components/dropCowboy/ClientsTable.jsx","../../src/components/dropCowboy/ClientsDropCowboyDashboard.jsx","../../src/components/mautic/MauticEmailsSection.jsx","../../src/components/mautic/MauticCampaignsSection.jsx","../../src/components/dropCowboy/DropCowboyServiceStats.jsx","../../src/components/mautic/MauticServiceStats.jsx","../../src/components/ClientServicesSection.jsx","../../src/pages/Clients.jsx"],"sourcesContent":["/**\n * @license lucide-react v0.552.0 - ISC\n *\n * This source code is licensed under the ISC license.\n * See the LICENSE file in the root directory of this source tree.\n */\n\nimport createLucideIcon from '../createLucideIcon.js';\n\nconst __iconNode = [\n  [\"circle\", { cx: \"12\", cy: \"12\", r: \"10\", key: \"1mglay\" }],\n  [\"path\", { d: \"m12 8-4 4 4 4\", key: \"15vm53\" }],\n  [\"path\", { d: \"M16 12H8\", key: \"1fr5h0\" }]\n];\nconst CircleArrowLeft = createLucideIcon(\"circle-arrow-left\", __iconNode);\n\nexport { __iconNode, CircleArrowLeft as default };\n//# sourceMappingURL=circle-arrow-left.js.map\n","/**\n * @license lucide-react v0.552.0 - ISC\n *\n * This source code is licensed under the ISC license.\n * See the LICENSE file in the root directory of this source tree.\n */\n\nimport createLucideIcon from '../createLucideIcon.js';\n\nconst __iconNode = [\n  [\"circle\", { cx: \"12\", cy: \"12\", r: \"10\", key: \"1mglay\" }],\n  [\"path\", { d: \"m12 16 4-4-4-4\", key: \"1i9zcv\" }],\n  [\"path\", { d: \"M8 12h8\", key: \"1wcyev\" }]\n];\nconst CircleArrowRight = createLucideIcon(\"circle-arrow-right\", __iconNode);\n\nexport { __iconNode, CircleArrowRight as default };\n//# sourceMappingURL=circle-arrow-right.js.map\n","/**\n * @license lucide-react v0.552.0 - ISC\n *\n * This source code is licensed under the ISC license.\n * See the LICENSE file in the root directory of this source tree.\n */\n\nimport createLucideIcon from '../createLucideIcon.js';\n\nconst __iconNode = [\n  [\"line\", { x1: \"12\", x2: \"12\", y1: \"2\", y2: \"22\", key: \"7eqyqh\" }],\n  [\"path\", { d: \"M17 5H9.5a3.5 3.5 0 0 0 0 7h5a3.5 3.5 0 0 1 0 7H6\", key: \"1b0p4s\" }]\n];\nconst DollarSign = createLucideIcon(\"dollar-sign\", __iconNode);\n\nexport { __iconNode, DollarSign as default };\n//# sourceMappingURL=dollar-sign.js.map\n","/**\n * @license lucide-react v0.552.0 - ISC\n *\n * This source code is licensed under the ISC license.\n * See the LICENSE file in the root directory of this source tree.\n */\n\nimport createLucideIcon from '../createLucideIcon.js';\n\nconst __iconNode = [\n  [\n    \"path\",\n    {\n      d: \"M10.1 13.9a14 14 0 0 0 3.732 2.668 1 1 0 0 0 1.213-.303l.355-.465A2 2 0 0 1 17 15h3a2 2 0 0 1 2 2v3a2 2 0 0 1-2 2 18 18 0 0 1-12.728-5.272\",\n      key: \"1wngk7\"\n    }\n  ],\n  [\"path\", { d: \"M22 2 2 22\", key: \"y4kqgn\" }],\n  [\n    \"path\",\n    {\n      d: \"M4.76 13.582A18 18 0 0 1 2 4a2 2 0 0 1 2-2h3a2 2 0 0 1 2 2v3a2 2 0 0 1-.8 1.6l-.468.351a1 1 0 0 0-.292 1.233 14 14 0 0 0 .244.473\",\n      key: \"10hv5p\"\n    }\n  ]\n];\nconst PhoneOff = createLucideIcon(\"phone-off\", __iconNode);\n\nexport { __iconNode, PhoneOff as default };\n//# sourceMappingURL=phone-off.js.map\n","/**\n * @license lucide-react v0.552.0 - ISC\n *\n * This source code is licensed under the ISC license.\n * See the LICENSE file in the root directory of this source tree.\n */\n\nimport createLucideIcon from '../createLucideIcon.js';\n\nconst __iconNode = [\n  [\n    \"path\",\n    {\n      d: \"M20 13c0 5-3.5 7.5-7.66 8.95a1 1 0 0 1-.67-.01C7.5 20.5 4 18 4 13V6a1 1 0 0 1 1-1c2 0 4.5-1.2 6.24-2.72a1.17 1.17 0 0 1 1.52 0C14.51 3.81 17 5 19 5a1 1 0 0 1 1 1z\",\n      key: \"oel41y\"\n    }\n  ],\n  [\"path\", { d: \"M9.1 9a3 3 0 0 1 5.82 1c0 2-3 3-3 3\", key: \"mhlwft\" }],\n  [\"path\", { d: \"M12 17h.01\", key: \"p32p05\" }]\n];\nconst ShieldQuestionMark = createLucideIcon(\"shield-question-mark\", __iconNode);\n\nexport { __iconNode, ShieldQuestionMark as default };\n//# sourceMappingURL=shield-question-mark.js.map\n","import { TrendingUp, CheckCircle, XCircle, DollarSign, ShieldQuestion } from 'lucide-react';\nimport { useAuth } from '../../contexts/AuthContext.jsx'\n\nconst MetricCard = ({ title, value, subtitle, icon: Icon, color = 'blue', clickable = false, onClick }) => {\n  const colorClasses = {\n    blue: { text: 'text-blue-600', bg: 'bg-blue-50', border: 'border-blue-100' },\n    green: { text: 'text-green-600', bg: 'bg-green-50', border: 'border-green-100' },\n    red: { text: 'text-red-600', bg: 'bg-red-50', border: 'border-red-100' },\n    purple: { text: 'text-purple-600', bg: 'bg-purple-50', border: 'border-purple-100' },\n    orange: { text: 'text-orange-600', bg: 'bg-orange-50', border: 'border-orange-100' },\n  };\n\n  const colors = colorClasses[color];\n\n  return (\n    <div\n      className={`bg-white rounded-xl border border-gray-200/60 p-2 transition-all duration-300 inline-flex flex-col \n      ${clickable ? 'cursor-pointer hover:shadow-md hover:border-blue-300 active:scale-[0.98]' : 'hover:shadow-sm'}\n      `}\n      onClick={clickable ? onClick : undefined}\n    >\n      <div className=\"flex items-start justify-between gap-2 mb-1\">\n        <div>\n          <p className=\"text-xs font-semibold text-gray-500 uppercase tracking-wide\">{title}</p>\n          <h3 className=\"text-xl font-bold text-gray-900 mb-1\">{value}</h3>\n          {subtitle && <p className=\"text-xs text-gray-500 font-medium\">{subtitle}</p>}\n\n        </div>\n        {Icon && (\n          <div className={`p-2 rounded-lg ${colors.bg} ${colors.border} border`}>\n            <Icon size={16} className={colors.text} strokeWidth={2.5} />\n          </div>\n        )}\n      </div>\n    </div>\n  );\n};\n\nconst MetricsCards = ({ metrics, onMetricClick, viewLevel }) => {\n  const { user } = useAuth();\n  const showCostForSuperadmin = user && user.role === 'superadmin';\n\n  if (!metrics || !metrics.overall) {\n    return (\n      <div className=\"flex gap-4 overflow-x-auto py-1\">\n        {[...Array(5)].map((_, i) => (\n          <div key={i} className=\"bg-white rounded-xl border border-gray-200/60 p-5 animate-pulse min-w-[220px] flex-shrink-0\">\n            <div className=\"h-3 bg-gray-200 rounded w-1/2 mb-3\"></div>\n            <div className=\"h-7 bg-gray-200 rounded w-3/4 mb-2\"></div>\n            <div className=\"h-2 bg-gray-200 rounded w-1/3\"></div>\n          </div>\n        ))}\n      </div>\n    );\n  }\n\n  const { overall } = metrics;\n  const successRate = overall.averageSuccessRate || 0;\n  const failureRate = overall.totalSent > 0 ? ((overall.failedSends / overall.totalSent) * 100) : 0;\n  const otherRate = overall.totalSent > 0 ? ((overall.otherStatus / overall.totalSent) * 100) : 0;\n\n  return (\n    // Use a horizontal single-line layout with horizontal scrolling on small viewports\n    <div className={`grid ${showCostForSuperadmin ? 'grid-cols-5' : 'grid-cols-4'} gap-4 overflow-x-auto py-1`}>\n      <MetricCard\n        title=\"Total VoiceMails Sent\"\n        value={overall.totalSent.toLocaleString()}\n        subtitle={`${overall.totalSent} Ringless voicemails`}\n        icon={TrendingUp}\n        color=\"blue\"\n        clickable={viewLevel === 'campaign'}\n        onClick={() => viewLevel === 'campaign' && onMetricClick('all')}\n      />\n      <MetricCard\n        title=\"Successful Deliveries\"\n        value={overall.successfulDeliveries.toLocaleString()}\n        subtitle={`${successRate.toFixed(1)}% delivery rate`}\n        icon={CheckCircle}\n        color=\"green\"\n        clickable={viewLevel === 'campaign'}\n        onClick={() => viewLevel === 'campaign' && onMetricClick('success')}\n      />\n      <MetricCard\n        title=\"Failed Deliveries\"\n        value={overall.failedSends.toLocaleString()}\n        subtitle={`${failureRate.toFixed(1)}% failure rate`}\n        icon={XCircle}\n        color=\"red\"\n        clickable={viewLevel === 'campaign'}\n        onClick={() => viewLevel === 'campaign' && onMetricClick('failure')}\n      />\n      <MetricCard\n        title=\"Other Status\"\n        value={overall.otherStatus?.toLocaleString() || '0'}\n        subtitle={`${otherRate.toFixed(1)}% other status`}\n        icon={ShieldQuestion}\n        color=\"orange\"\n        clickable={viewLevel === 'campaign'}\n        onClick={() => viewLevel === 'campaign' && onMetricClick('other')}\n      />\n      {showCostForSuperadmin && (\n        <MetricCard\n          title=\"Total Campaign Cost\"\n          value={`$${(overall.totalCost || 0).toFixed(2)}`}\n          subtitle={`$${(overall.totalCost / overall.totalSent || 0).toFixed(4)} per voicemail`}\n          icon={DollarSign}\n          color=\"purple\"\n        />\n      )}\n    </div>\n  );\n};\n\nexport default MetricsCards;","import React, { useState, useEffect, useRef, useMemo } from \"react\";\nimport { Loader2 } from \"lucide-react\";\nimport MetricsCards from \"./MetricsCards\";\nimport useViewLevel from \"../../zustand/useViewLevel\";\n\n\nconst ClientsTable = () => {\n  const [serverRecords, setServerRecords] = useState([]);\n  const [totalRecords, setTotalRecords] = useState(0);\n  const [loadingPage, setLoadingPage] = useState(false);\n\n  const { dropcowboy, setDCViewLevel, setDCSelectedClient, setDCSelectedCampaign } = useViewLevel();\n  const { viewLevel, selectedClient, selectedCampaign, campaigns } = dropcowboy;\n\n  const groupBy = (arr, keyFn) =>\n    arr.reduce((acc, item) => {\n      const key = keyFn(item);\n      if (!acc[key]) acc[key] = [];\n      acc[key].push(item);\n      return acc;\n    }, {});\n\n  // Refs to capture/restore scroll ratio when changing pages\n  const tableContainerRef = useRef(null);\n  const scrollRatioRef = useRef(0);\n  const maintainScrollRef = useRef(false);\n  const [fadeIn, setFadeIn] = useState(true);\n\n  const [statusFilter, setStatusFilter] = useState(\"all\");\n  const [dateFilters, setDateFilters] = useState({\n    startDate: \"\",\n    endDate: \"\",\n  });\n  const [appliedDateFilters, setAppliedDateFilters] = useState({\n    startDate: \"\",\n    endDate: \"\",\n  });\n  const [fetchLoading, setFetchLoading] = useState(false);\n  const [fetchMessage, setFetchMessage] = useState(\"\");\n  const [allRecords, setAllRecords] = useState([]);\n\n  const [currentPage, setCurrentPage] = useState(1);\n  const [recordsPerPage] = useState(50);\n  const [paginatedRecords, setPaginatedRecords] = useState([]);\n  const [totalPages, setTotalPages] = useState(1);\n\n  // Small reusable skeleton row used during fetch or pagination\n  const SkeletonRow = ({ compact = false }) => (\n    <tr className=\"opacity-100 animate-pulse\">\n      <td className=\"sticky left-0 bg-white px-3 py-3 border-r border-gray-200 z-10\">\n        <div className=\"h-3 bg-gray-200 rounded w-20\"></div>\n      </td>\n      <td className=\"px-3 py-3\">\n        <div className=\"h-3 bg-gray-200 rounded w-32\" />\n      </td>\n      <td className=\"px-3 py-3 whitespace-nowrap\">\n        <div className=\"h-3 bg-gray-200 rounded w-24\" />\n      </td>\n      <td className=\"px-3 py-3 whitespace-nowrap\">\n        <div className=\"h-3 bg-gray-200 rounded w-20\" />\n      </td>\n      <td className=\"px-3 py-3 whitespace-nowrap\">\n        <div className=\"h-3 bg-gray-200 rounded w-16\" />\n      </td>\n      <td className=\"px-3 py-3\">\n        <div className=\"h-3 bg-gray-200 rounded w-16\" />\n      </td>\n      <td className=\"px-3 py-3\">\n        <div className=\"h-3 bg-gray-200 rounded w-16\" />\n      </td>\n      <td className=\"px-3 py-3\">\n        <div className=\"h-3 bg-gray-200 rounded w-28\" />\n      </td>\n    </tr>\n  );\n\n  // If campaigns prop is passed (from App.jsx filtered by client), use it as a fallback initial load\n  useEffect(() => {\n    if (campaigns && campaigns.length > 0) {\n      const records = campaigns.flatMap((c) => {\n        const clientName = c.client || \"Unknown\";\n        const campaign = c.campaignName || \"\";\n\n        return c.records.map((record) => ({\n          ...record,\n          client: clientName,\n          campaign: campaign.trim(),\n          status: record.status?.trim()?.toLowerCase() || \"other\",\n        }));\n      });\n\n      const filtered = selectedClient\n        ? records.filter((r) => r.client === selectedClient) // selectedClient here is actually selectedClient's name\n        : records;\n\n      setAllRecords(filtered);\n      setTotalRecords(filtered.length);\n\n    }\n  }, [campaigns]);\n\n  useEffect(() => {\n    const offset = (currentPage - 1) * recordsPerPage;\n    setServerRecords(allRecords.slice(offset, offset + recordsPerPage));\n  }, [allRecords, currentPage, recordsPerPage]);\n\n  // When currentPage changes, animate rows and restore scroll position (or scroll to top)\n  useEffect(() => {\n    const container = tableContainerRef.current;\n    setFadeIn(false);\n    // small delay to allow DOM update\n    const t = setTimeout(() => {\n      setFadeIn(true);\n      if (container) {\n        try {\n          if (maintainScrollRef.current) {\n            const maxAfter = Math.max(\n              0,\n              container.scrollHeight - container.clientHeight\n            );\n            container.scrollTop = Math.round(scrollRatioRef.current * maxAfter);\n          } else {\n            container.scrollTo({ top: 0, behavior: \"smooth\" });\n          }\n        } catch (e) { }\n      }\n    }, 60);\n    return () => clearTimeout(t);\n  }, [currentPage]);\n\n  // Server-side pagination: current page records come from serverRecords, totalRecords tracks full count\n  const currentRecords = serverRecords;\n\n  const getStatusBadge = (status) => {\n    const statusLower = status?.toLowerCase() || \"\";\n    if ([\"sent\", \"success\", \"delivered\"].includes(statusLower)) {\n      return (\n        <span className=\"px-2 py-1 text-xs font-medium rounded-full bg-green-100 text-green-800\">\n          Delivered\n        </span>\n      );\n    } else if ([\"failed\", \"failure\", \"error\"].includes(statusLower)) {\n      return (\n        <span className=\"px-2 py-1 text-xs font-medium rounded-full bg-red-100 text-red-800\">\n          Failed\n        </span>\n      );\n    }\n    return (\n      <span className=\"px-2 py-1 text-xs font-medium rounded-full bg-gray-100 text-gray-800\">\n        {status || \"Unknown\"}\n      </span>\n    );\n  };\n\n  // Page input state for 'Go to page'\n  const [gotoPageInput, setGotoPageInput] = useState(\"\");\n  const [gotoInvalid, setGotoInvalid] = useState(false);\n\n  const handleGoto = () => {\n    const n = parseInt(gotoPageInput, 10);\n    if (Number.isNaN(n)) return;\n    if (n < 1 || n > totalPages) {\n      setGotoInvalid(true);\n      return;\n    }\n    const page = n;\n    setCurrentPage(gotoPageInput);\n    setGotoPageInput(\"\");\n    setGotoInvalid(false);\n    try {\n      window.localStorage.setItem(\"dc_records_page\", String(page));\n    } catch (e) { }\n  };\n\n  // Clear invalid state when input changes\n  useEffect(() => {\n    if (gotoInvalid) setGotoInvalid(false);\n  }, [gotoPageInput]);\n\n  useEffect(() => {\n    setCurrentPage(1);\n  }, [selectedCampaign]);\n\n  // üîπ Filters applied to metrics (no status filter)\n  const filteredRecordsForMetrics = useMemo(() => {\n    let records = allRecords;\n\n    // View-level filtering\n    if (viewLevel === \"client\" && selectedClient) {\n      records = records.filter((r) => r.client === selectedClient);\n    } else if (viewLevel === \"campaign\" && selectedClient && selectedCampaign) {\n      records = records.filter(\n        (r) => r.client === selectedClient && r.campaignName === selectedCampaign\n      );\n    }\n\n    // Date filtering (applied only after Save)\n    if (appliedDateFilters.startDate || appliedDateFilters.endDate) {\n      records = records.filter((r) => {\n        const recordDate = new Date(r.date);\n        if (\n          appliedDateFilters.startDate &&\n          recordDate < new Date(appliedDateFilters.startDate)\n        )\n          return false;\n        if (\n          appliedDateFilters.endDate &&\n          recordDate > new Date(appliedDateFilters.endDate)\n        )\n          return false;\n        return true;\n      });\n    }\n\n    return records;\n  }, [allRecords, viewLevel, selectedClient, selectedCampaign, appliedDateFilters]);\n\n  // üîπ Filters applied to table (includes status)\n  const filteredRecordsForTable = useMemo(() => {\n    let records = filteredRecordsForMetrics;\n\n    // Apply status filtering separately\n    if (statusFilter !== \"all\") {\n      if (statusFilter === \"other\") {\n        records = records.filter(\n          (r) => ![\"success\", \"failure\"].includes(r.status)\n        );\n      } else {\n        records = records.filter((r) => r.status === statusFilter);\n      }\n    }\n\n    return records;\n  }, [filteredRecordsForMetrics, statusFilter]);\n\n  const metrics = useMemo(() => {\n    const totalSent = filteredRecordsForMetrics.length;\n    const successfulDeliveries = filteredRecordsForMetrics.filter(\n      (r) => r.status === \"success\"\n    ).length;\n    const failedSends = filteredRecordsForMetrics.filter(\n      (r) => r.status === \"failure\"\n    ).length;\n    const otherStatus = filteredRecordsForMetrics.filter(\n      (r) => ![\"success\", \"failure\"].includes(r.status)\n    ).length;\n\n    return {\n      overall: {\n        totalSent,\n        successfulDeliveries,\n        failedSends,\n        otherStatus,\n        averageSuccessRate:\n          totalSent > 0 ? (successfulDeliveries / totalSent) * 100 : 0,\n      },\n    };\n  }, [filteredRecordsForMetrics]);\n\n  useEffect(() => {\n    if (!selectedClient || !selectedCampaign || allRecords.length === 0) return;\n\n    // 1Ô∏è‚É£ Filter the records for the selected client + campaign\n    const campaignRecords = filteredRecordsForTable.filter(\n      (r) => r.client === selectedClient && r.campaignName === selectedCampaign\n    );\n\n    // 2Ô∏è‚É£ Pagination logic\n    const startIndex = (currentPage - 1) * recordsPerPage;\n    const endIndex = startIndex + recordsPerPage;\n\n    setPaginatedRecords(campaignRecords.slice(startIndex, endIndex));\n    setTotalPages(Math.ceil(campaignRecords.length / recordsPerPage));\n  }, [selectedClient, selectedCampaign, currentPage, filteredRecordsForTable]);\n\n  return (\n    <div className=\"bg-white rounded-xl shadow-sm border border-gray-200\">\n      {/* Header */}\n      <div className=\"px-6 py-5 border-b border-gray-200 bg-gradient-to-r from-gray-50 to-white\">\n        <div className=\"flex items-center justify-between mb-4\">\n          <h3 className=\"text-xl font-bold text-gray-900\">\n            Voicemail Campaign Records\n          </h3>\n          <button\n            onClick={async () => {\n              try {\n                setFetchLoading(true);\n                setFetchMessage(\"Refreshing data...\");\n                // await fetchPage(currentPage || 1);\n                setFetchMessage(\"Data refreshed successfully\");\n              } catch (err) {\n                setFetchMessage(\"Error: \" + (err.message || \"unknown\"));\n              } finally {\n                setFetchLoading(false);\n                setTimeout(() => setFetchMessage(\"\"), 3000);\n              }\n            }}\n            disabled={fetchLoading}\n            className=\"inline-flex items-center gap-2 px-4 py-2 text-sm font-medium rounded-lg text-white bg-blue-600 hover:bg-blue-700 disabled:bg-gray-300 disabled:text-gray-500 disabled:cursor-not-allowed transition-colors shadow-sm\"\n          >\n            {fetchLoading ? (\n              <Loader2 className=\"animate-spin\" size={16} />\n            ) : (\n              \"Refresh Data\"\n            )}\n          </button>\n        </div>\n\n        {/* All Filters in One Row */}\n        {viewLevel !== \"root\" && (\n          <div className=\"flex items-center gap-3 flex-wrap\">\n            {/* Start Date */}\n            <input\n              type=\"date\"\n              value={dateFilters.startDate}\n              onChange={(e) =>\n                setDateFilters((prev) => ({\n                  ...prev,\n                  startDate: e.target.value,\n                }))\n              }\n              className=\"px-3 py-2.5 border border-gray-300 rounded-lg text-sm focus:ring-2 focus:ring-blue-500 focus:border-blue-500\"\n              aria-label=\"Start date\"\n              title=\"From date\"\n            />\n\n            <span className=\"text-sm text-gray-500 font-medium\">to</span>\n\n            {/* End Date */}\n            <input\n              type=\"date\"\n              value={dateFilters.endDate}\n              onChange={(e) =>\n                setDateFilters((prev) => ({\n                  ...prev,\n                  endDate: e.target.value,\n                }))\n              }\n              className=\"px-3 py-2.5 border border-gray-300 rounded-lg text-sm focus:ring-2 focus:ring-blue-500 focus:border-blue-500\"\n              aria-label=\"End date\"\n              title=\"To date\"\n            />\n\n            {/* Save Button */}\n            <button\n              onClick={() =>\n                setAppliedDateFilters({\n                  startDate: dateFilters.startDate,\n                  endDate: dateFilters.endDate,\n                })\n              }\n              className=\"px-3 py-2.5 text-sm font-semibold bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors\"\n              title=\"Apply date filter\"\n            >\n              Save\n            </button>\n\n            {/* Clear Button */}\n            <button\n              onClick={() => {\n                setDateFilters({ startDate: \"\", endDate: \"\" });\n                setAppliedDateFilters({ startDate: \"\", endDate: \"\" });\n              }}\n              className=\"px-3 py-2.5 text-sm font-medium text-gray-700 bg-gray-100 rounded-lg hover:bg-gray-200 transition-colors\"\n              title=\"Clear date filter\"\n            >\n              Clear\n            </button>\n          </div>\n        )}\n\n      </div>\n\n      <MetricsCards\n        metrics={metrics}\n        onMetricClick={(status) => {\n          if (viewLevel === \"campaign\") {\n            // Apply status filter for leaf node view\n            setStatusFilter(status);\n            setCurrentPage(1);\n          }\n        }}\n        viewLevel={viewLevel}\n      />\n\n      {/* Table - vertically scrollable viewport with sticky pagination footer */}\n      <div\n        className=\"overflow-x-auto overflow-y-auto relative\"\n        ref={tableContainerRef}\n      >\n        {/* Hierarchical Table Section */}\n        <div className=\"overflow-x-auto rounded-xl border border-gray-200 shadow-sm bg-white\">\n          {/* Drilldown Header / Breadcrumb */}\n          <div className=\"flex items-center justify-between px-4 py-3 border-b border-gray-200 bg-gray-50\">\n            <div className=\"flex items-center gap-2 text-sm font-medium text-gray-600\">\n              {viewLevel === \"root\" && <span>üìä All Clients</span>}\n              {viewLevel === \"client\" && (\n                <>\n                  <span>Client: {selectedClient}</span>\n                </>\n              )}\n              {viewLevel === \"campaign\" && (\n                <>\n                  <button\n                    onClick={() => {\n                      setDCViewLevel(\"client\");\n                      setDCSelectedCampaign(null);\n                    }}\n                    className=\"text-blue-600 hover:underline\"\n                  >\n                    ‚Üê Back\n                  </button>\n                  <span>/ Campaign: {selectedCampaign}</span>\n                </>\n              )}\n            </div>\n          </div>\n\n          {/* Table */}\n          <div className=\"max-h-[500px] overflow-y-auto\">\n            <table className=\"w-full min-w-max border-collapse\">\n              <thead className=\"bg-gradient-to-r from-gray-50 to-gray-100 border-b-2 border-gray-300 sticky top-0 z-30\">\n                {viewLevel === \"root\" && (\n                  <tr>\n                    <th className=\"px-4 py-3 text-left text-xs font-bold uppercase text-gray-700\">\n                      Client\n                    </th>\n                    <th className=\"px-4 py-3 text-left text-xs font-bold uppercase text-gray-700\">\n                      Total Campaigns\n                    </th>\n                    <th className=\"px-4 py-3 text-left text-xs font-bold uppercase text-gray-700\">\n                      Total Voicemails sent\n                    </th>\n                    <th className=\"px-4 py-3 text-left text-xs font-bold uppercase text-gray-700\">\n                      Success\n                    </th>\n                    <th className=\"px-4 py-3 text-left text-xs font-bold uppercase text-gray-700\">\n                      Failure\n                    </th>\n                    <th className=\"px-4 py-3 text-left text-xs font-bold uppercase text-gray-700\">\n                      Other\n                    </th>\n                  </tr>\n                )}\n\n                {viewLevel === \"client\" && (\n                  <tr>\n                    <th className=\"px-4 py-3 text-left text-xs font-bold uppercase text-gray-700\">\n                      Campaign\n                    </th>\n                    <th className=\"px-4 py-3 text-left text-xs font-bold uppercase text-gray-700\">\n                      Total Voicemails sent\n                    </th>\n                    <th className=\"px-4 py-3 text-left text-xs font-bold uppercase text-gray-700\">\n                      Success\n                    </th>\n                    <th className=\"px-4 py-3 text-left text-xs font-bold uppercase text-gray-700\">\n                      Failure\n                    </th>\n                    <th className=\"px-4 py-3 text-left text-xs font-bold uppercase text-gray-700\">\n                      Other\n                    </th>\n                  </tr>\n                )}\n\n                {viewLevel === \"campaign\" && (\n                  <tr>\n                    <th className=\"px-4 py-3 text-left text-xs font-bold uppercase text-gray-700\">\n                      Phone\n                    </th>\n                    <th className=\"px-4 py-3 text-left text-xs font-bold uppercase text-gray-700\">\n                      Status\n                    </th>\n                    <th className=\"px-4 py-3 text-left text-xs font-bold uppercase text-gray-700\">\n                      Date\n                    </th>\n                    <th className=\"px-4 py-3 text-left text-xs font-bold uppercase text-gray-700\">\n                      First Name\n                    </th>\n                    <th className=\"px-4 py-3 text-left text-xs font-bold uppercase text-gray-700\">\n                      Last Name\n                    </th>\n                    <th className=\"px-4 py-3 text-left text-xs font-bold uppercase text-gray-700\">\n                      Email\n                    </th>\n                  </tr>\n                )}\n              </thead>\n\n              <tbody className=\"divide-y divide-gray-100 text-sm text-gray-700\">\n                {(() => {\n                  if (fetchLoading || loadingPage) {\n                    return [...Array(recordsPerPage)].map((_, i) => (\n                      <SkeletonRow key={i} />\n                    ));\n                  }\n\n                  if (!currentRecords?.length) {\n                    return (\n                      <tr>\n                        <td\n                          colSpan=\"6\"\n                          className=\"py-16 text-center text-gray-400 text-sm\"\n                        >\n                          üì≠ No records found\n                        </td>\n                      </tr>\n                    );\n                  }\n\n                  // Root Level ‚Üí Group by Client\n                  if (viewLevel === \"root\") {\n                    const clientGroups = groupBy(\n                      allRecords,\n                      (r) => (r.client && r.client.trim()) || \"Unknown Client\"\n                    );\n                    return Object.entries(clientGroups).map(\n                      ([client, records]) => {\n                        const total = records.length;\n                        const success = records.filter(\n                          (r) => r.status?.toLowerCase() === \"success\"\n                        ).length;\n                        const failed = records.filter(\n                          (r) => r.status?.toLowerCase() === \"failure\"\n                        ).length;\n                        const other = records.filter(\n                          (r) => ![\"success\", \"failure\"].includes(r.status)\n                        ).length;\n\n                        return (\n                          <tr\n                            key={client}\n                            className=\"hover:bg-blue-50 cursor-pointer transition-all\"\n                            onClick={() => {\n                              setDCSelectedClient(client);\n                              setDCViewLevel(\"client\");\n                            }}\n                          >\n                            <td className=\"px-4 py-3 font-semibold text-gray-800\">\n                              {client}\n                            </td>\n                            <td className=\"px-4 py-3\">\n                              {new Set(records.map((r) => r.campaignId)).size}\n                            </td>\n                            <td className=\"px-4 py-3\">{total}</td>\n                            <td className=\"px-4 py-3\">{success}</td>\n                            <td className=\"px-4 py-3\">{failed}</td>\n                            <td className=\"px-4 py-3\">{other}</td>\n                          </tr>\n                        );\n                      }\n                    );\n                  }\n\n                  // Client Level ‚Üí Group by Campaign\n                  if (viewLevel === \"client\" && selectedClient) {\n                    const campaignGroups = groupBy(\n                      filteredRecordsForTable,\n                      (r) => r.campaignName || \"Unknown Campaign\"\n                    );\n\n                    return Object.entries(campaignGroups).map(\n                      ([campaign, records]) => {\n                        const total = records.length;\n                        const success = records.filter(\n                          (r) => r.status?.toLowerCase() === \"success\"\n                        ).length;\n                        const failed = records.filter(\n                          (r) => r.status?.toLowerCase() === \"failure\"\n                        ).length;\n                        const other = records.filter(\n                          (r) => ![\"success\", \"failure\"].includes(r.status)\n                        ).length;\n\n                        return (\n                          <tr\n                            key={campaign}\n                            className=\"hover:bg-blue-50 cursor-pointer transition-all\"\n                            onClick={() => {\n                              setDCSelectedCampaign(campaign);\n                              setDCViewLevel(\"campaign\");\n                              // fetchPage(1, campaign)\n                            }}\n                          >\n                            <td className=\"px-4 py-3 font-medium\">{campaign}</td>\n                            <td className=\"px-4 py-3\">{total}</td>\n                            <td className=\"px-4 py-3\">{success}</td>\n                            <td className=\"px-4 py-3\">{failed}</td>\n                            <td className=\"px-4 py-3\">{other}</td>\n                          </tr>\n                        );\n                      }\n                    );\n                  }\n\n                  // Campaign Level ‚Üí Show individual records\n                  if (viewLevel === \"campaign\" && selectedCampaign) {\n                    // Update total pages dynamically based on filtered results\n                    const totalFilteredPages = Math.ceil(\n                      filteredRecordsForTable.length / recordsPerPage\n                    );\n\n                    // Ensure current page is valid (in case filters reduce total pages)\n                    const safePage = Math.min(\n                      currentPage,\n                      totalFilteredPages || 1\n                    );\n                    if (safePage !== currentPage) setCurrentPage(safePage);\n\n                    const paginatedRecords = filteredRecordsForTable.slice(\n                      (safePage - 1) * recordsPerPage,\n                      safePage * recordsPerPage\n                    );\n\n                    return paginatedRecords.map((record, i) => (\n                      <tr\n                        key={i}\n                        className=\"hover:bg-blue-50 cursor-pointer transition-all\"\n                      >\n                        <td className=\"px-4 py-3\">{record.phoneNumber}</td>\n                        <td className=\"px-4 py-3\">\n                          {getStatusBadge(record.status)}\n                        </td>\n                        <td className=\"px-4 py-3\">\n                          {new Date(record.date).toLocaleDateString('en-US', {\n                            month: 'short',\n                            day: 'numeric',\n                            year: 'numeric'\n                          })}\n                        </td>\n                        <td className=\"px-4 py-3\">{record.firstName}</td>\n                        <td className=\"px-4 py-3\">{record.lastName}</td>\n                        <td className=\"px-4 py-3\">{record.email}</td>\n                      </tr>\n                    ));\n                  }\n                })()}\n              </tbody>\n            </table>\n          </div>\n        </div>\n\n        {/* Sticky pagination footer inside table viewport */}\n        {viewLevel === \"campaign\" && paginatedRecords.length > 0 && (\n          <div className=\"sticky bottom-0 left-0 right-0 bg-gradient-to-r from-gray-50 to-white backdrop-blur-sm border-t-2 border-gray-200 px-6 py-4 flex items-center justify-between z-10 shadow-lg\">\n            <div className=\"text-sm text-gray-700 font-medium\">\n              Showing{\" \"}\n              <span className=\"font-bold text-blue-600\">\n                {(currentPage - 1) * recordsPerPage + 1}\n              </span>{\" \"}\n              to{\" \"}\n              <span className=\"font-bold text-blue-600\">\n                {Math.min(currentPage * recordsPerPage, filteredRecordsForTable.length)}\n              </span>{\" \"}\n              of{\" \"}\n              <span className=\"font-bold text-blue-600\">\n                {filteredRecordsForTable.length}\n              </span>{\" \"}\n              records\n            </div>\n\n            <div className=\"flex items-center gap-2\">\n              <button\n                onClick={() => setCurrentPage(1)}\n                disabled={currentPage === 1}\n                className=\"px-3 py-2 text-sm font-semibold text-gray-700 bg-white border border-gray-300 rounded-lg hover:bg-blue-50 disabled:opacity-40 disabled:cursor-not-allowed transition-all shadow-sm\"\n                title=\"First Page\"\n              >\n                ¬´¬´\n              </button>\n\n              <button\n                onClick={() => setCurrentPage(Math.max(1, currentPage - 1))}\n                disabled={currentPage === 1}\n                className=\"px-4 py-2 text-sm font-semibold text-gray-700 bg-white border border-gray-300 rounded-lg hover:bg-blue-50 disabled:opacity-40 disabled:cursor-not-allowed transition-all shadow-sm\"\n              >\n                Previous\n              </button>\n\n              <div\n                className=\"px-4 py-2 text-sm font-bold text-gray-900 bg-blue-50 border border-blue-200 rounded-lg\"\n                title={`Total pages: ${totalPages}`}\n              >\n                Page {currentPage} of {totalPages}\n              </div>\n\n              <button\n                onClick={() =>\n                  setCurrentPage(Math.min(totalPages, currentPage + 1))\n                }\n                disabled={currentPage === totalPages}\n                className=\"px-4 py-2 text-sm font-semibold text-gray-700 bg-white border border-gray-300 rounded-lg hover:bg-blue-50 disabled:opacity-40 disabled:cursor-not-allowed transition-all shadow-sm\"\n              >\n                Next\n              </button>\n\n              <button\n                onClick={() => setCurrentPage(totalPages)}\n                disabled={currentPage === totalPages}\n                className=\"px-3 py-2 text-sm font-semibold text-gray-700 bg-white border border-gray-300 rounded-lg hover:bg-blue-50 disabled:opacity-40 disabled:cursor-not-allowed transition-all shadow-sm\"\n                title=\"Last Page\"\n              >\n                ¬ª¬ª\n              </button>\n\n              <div className=\"flex items-center gap-2 ml-3 pl-3 border-l-2 border-gray-300\">\n                <span className=\"text-xs text-gray-600 font-medium\">\n                  Jump to:\n                </span>\n                <input\n                  type=\"number\"\n                  min=\"1\"\n                  max={totalPages}\n                  value={gotoPageInput}\n                  onChange={(e) => setGotoPageInput(e.target.value)}\n                  onKeyDown={(e) => {\n                    if (e.key === \"Enter\") handleGoto();\n                  }}\n                  placeholder=\"Page #\"\n                  className={`w-20 px-3 py-2 rounded-lg text-sm font-medium border focus:ring-2 focus:ring-blue-500 ${gotoInvalid\n                    ? \"border-red-500 ring-1 ring-red-300\"\n                    : \"border-gray-300\"\n                    }`}\n                />\n                <button\n                  onClick={handleGoto}\n                  className=\"px-4 py-2 text-sm font-semibold bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors shadow-sm\"\n                >\n                  Go\n                </button>\n              </div>\n            </div>\n          </div>\n        )}\n      </div>\n    </div>\n  );\n};\n\nexport default ClientsTable;\n","/**\n * Drop Cowboy Dashboard Container Component\n * \n * Clean, modular implementation of Drop Cowboy dashboard\n * Uses custom hooks and service layer for separation of concerns\n */\n\nimport React, { useState, useEffect } from 'react';\nimport { Activity, AlertCircle, RefreshCw } from 'lucide-react';\nimport { format, parseISO } from 'date-fns';\nimport { toast } from 'react-toastify';\nimport ErrorBoundary from './ErrorBoundary';\nimport { useMetrics, useSyncLogs, useManualFetch } from '../../hooks/dropCowboy/useDropCowboy';\nimport { extractUniqueClients } from '../../utils/dropCowboy/helpers';\nimport ClientsTable from './ClientsTable';\nimport useViewLevel from '../../zustand/useViewLevel';\n\n/**\n * Main Drop Cowboy Dashboard Component\n * Embeddable in the main app's Services page\n * \n * @param {Array} clientCampaigns - Optional: Filter to specific campaign IDs for a client\n * @param {String} clientName - Optional: Display client name in header\n */\nexport default function ClientsDropCowboyDashboard({ clientCampaigns = null, clientName = null }) {\n    const [clientFilter, setClientFilter] = useState(clientName || 'All');\n    const [clientOptions, setClientOptions] = useState(['All']);\n\n    // Use custom hooks for data fetching - pass campaign filter if provided\n    const initialFilters = clientCampaigns ? { campaignIds: clientCampaigns } : {};\n    const { metrics, loading, error, refetch: refetchMetrics, setFilters, filters } = useMetrics(initialFilters);\n    const { syncLogs, refetch: refetchSyncLogs } = useSyncLogs(10);\n    const { triggerFetch, isFetching, error: fetchError } = useManualFetch();\n\n    const { dropcowboy, setDCCampaigns, setDCSelectedClient, setDCMetrics } = useViewLevel();\n    const { savedMetrics } = dropcowboy;\n\n    // Extract unique clients when metrics change\n    useEffect(() => {\n        if (metrics?.campaigns) {\n            const clients = extractUniqueClients(metrics.campaigns);\n            setClientOptions(['All', ...clients]);\n\n            // if coming in from a client page, auto-select that client\n            if (clientName && clients.includes(clientName)) {\n                setClientFilter(clientName);\n            }\n        }\n        \n        // Filter campaigns by clientName if provided\n        const filteredCampaigns = clientName && metrics?.campaigns\n            ? metrics.campaigns.filter(c => c.client === clientName)\n            : metrics?.campaigns;\n        \n        setDCCampaigns(filteredCampaigns);\n        setDCMetrics(metrics);\n        setDCSelectedClient(clientName);\n    }, [metrics, clientName]);\n\n    // Auto-refresh data every 50 minutes\n    useEffect(() => {\n        const interval = setInterval(() => {\n            refetchMetrics();\n            refetchSyncLogs();\n        }, 50 * 60 * 1000);\n        return () => clearInterval(interval);\n    }, [refetchMetrics, refetchSyncLogs]);\n\n    // Handle manual SFTP fetch\n    const handleFetchNow = async () => {\n        toast.info('Starting SFTP sync... This may take 30-60 seconds.', { autoClose: 3000 });\n\n        const result = await triggerFetch();\n\n        if (result.success) {\n            // Reload data after successful fetch\n            await refetchMetrics();\n            await refetchSyncLogs();\n\n            if (result.data?.warning) {\n                toast.warning(result.data.warning, { autoClose: 5000 });\n            } else if (result.data?.filesDownloaded > 0) {\n                toast.success(`Successfully fetched ${result.data.filesDownloaded} files from SFTP!`, { autoClose: 5000 });\n            } else {\n                toast.info('Sync completed - using existing data.', { autoClose: 3000 });\n            }\n        } else {\n            toast.error('Failed to fetch data: ' + (result.error || 'Unknown error'), { autoClose: 5000 });\n        }\n    };\n\n    return (\n        <ErrorBoundary>\n            <div className=\"py-6 sm:py-8\">\n                {/* Error Messages */}\n                {(error || fetchError) && (\n                    <div className=\"mb-6 bg-red-50 border border-red-200 rounded-lg p-4 flex items-start\">\n                        <AlertCircle className=\"text-red-600 mr-3 flex-shrink-0 mt-0.5\" size={18} />\n                        <p className=\"text-sm text-red-800 leading-relaxed\">\n                            {error || fetchError}\n                        </p>\n                    </div>\n                )}\n\n                {/* Minimal Action Bar */}\n                <div className=\"mb-6 flex items-center justify-between gap-4 bg-white p-3 rounded-lg shadow-sm border border-gray-200\">\n                    <div className=\"flex items-center gap-4\">\n                        {/* Last Sync Info - Compact */}\n                        {syncLogs.length > 0 && syncLogs[0] && (\n                            <div className=\"text-xs text-gray-500\">\n                                Last sync: {format(parseISO(syncLogs[0].timestamp), 'MMM dd, h:mm a')}\n                            </div>\n                        )}\n                    </div>\n\n                    {/* Action Buttons */}\n                    <div className=\"flex items-center gap-2\">\n                        <button\n                            onClick={handleFetchNow}\n                            disabled={isFetching}\n                            className=\"flex items-center gap-2 px-3 py-1.5 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors disabled:opacity-50 disabled:cursor-not-allowed text-sm\"\n                        >\n                            <RefreshCw className={`w-2 h-2 ${isFetching ? 'animate-spin' : ''}`} />\n                            {isFetching ? 'Fetching...' : 'Fetch from SFTP'}\n                        </button>\n                    </div>\n                </div>\n\n                {/* Loading State */}\n                {(savedMetrics?.length === 0) ? (\n                    <div className=\"flex items-center justify-center h-96\">\n                        <div className=\"text-center\">\n                            <Activity className=\"animate-spin mx-auto mb-4 text-blue-600\" size={40} />\n                            <p className=\"text-gray-600 text-sm font-medium\">Loading dashboard...</p>\n                        </div>\n                    </div>\n                ) : (\n                    <div className=\"space-y-6\">\n                        {/* All Records Table */}\n                        <ClientsTable />\n                    </div>\n                )}\n            </div>\n        </ErrorBoundary>\n    );\n}","import { useState, useEffect, useRef, useMemo } from \"react\";\nimport { Mail, ArrowLeftCircle, ArrowRightCircle, Eye, Users, TrendingUp, Calendar } from \"lucide-react\";\nimport axios from \"axios\";\n\n\nconst MauticEmailsSection = ({ campaigns, selectedCampaign, setSelectedCampaign, goBackToCampaigns }) => {\n\n    // draft values allow user to change dates without immediately applying\n    const [draftFromDate, setDraftFromDate] = useState(\"\");\n    const [draftToDate, setDraftToDate] = useState(\"\");\n    // applied values used by the fetch and filters\n    const [appliedFromDate, setAppliedFromDate] = useState(\"\");\n    const [appliedToDate, setAppliedToDate] = useState(\"\");\n    // eslint-disable-next-line no-unused-vars\n    const [emailReports, setEmailReports] = useState([]);\n    const [loadingReports, setLoadingReports] = useState(false);\n    const [emailReportsIndex, setEmailReportsIndex] = useState(new Map());\n\n    const fromDateRef = useRef(null);\n    const toDateRef = useRef(null);\n\n    // Helper: get reports for a specific mauticEmail that have a particular date field within range\n    const reportsForEmailByFieldInRange = (emailId, field, email) => {\n        const entry = emailReportsIndex.get(String(emailId));\n\n        // New aggregate format\n        if (entry && typeof entry.sentCount === \"number\") {\n            const count = field === 'dateSent' ? entry.sentCount : entry.readCount;\n            return new Array(count).fill(null);\n        }\n\n        if (appliedFromDate || appliedToDate) {\n            return [];\n        }\n    };\n\n    const openPicker = (ref) => {\n        if (!ref?.current) return;\n        // showPicker is supported in some Chromium browsers; fallback to focus().\n        if (typeof ref.current.showPicker === 'function') {\n            try { ref.current.showPicker(); } catch (err) { console.debug(err); }\n        }\n        if (typeof ref.current.focus === 'function') {\n            ref.current.focus();\n        }\n    };\n\n    // Fetch email reports AND filtered emails when campaign or applied dates change\n    useEffect(() => {\n        if (!selectedCampaign?.clientId) return;\n\n        const fetchData = async () => {\n            setLoadingReports(true);\n            try {\n                const params = new URLSearchParams();\n                if (appliedFromDate) params.append('fromDate', appliedFromDate);\n                if (appliedToDate) params.append('toDate', appliedToDate);\n\n                // Fetch reports\n                const baseUrl = import.meta.env.VITE_API_URL || \"\";\n                const reportsRes = await axios.get(`${baseUrl}/api/mautic/clients/${selectedCampaign.clientId}/email-reports?${params}`);\n\n                const reports = reportsRes.data.data || [];\n\n                // Detect if backend returned aggregated counts\n                const isAggregated = reports.length > 0;\n\n                const reportIndex = new Map();\n\n                if (isAggregated) {\n                    // New format: aggregated by eId\n                    for (const r of reports) {\n                        reportIndex.set(String(r.eId), { sentCount: r.sentCount || 0, readCount: r.readCount || 0 });\n                    }\n                }\n\n                setEmailReports(reports);\n                setEmailReportsIndex(reportIndex);\n\n            } catch (error) {\n                console.error('Error fetching email data:', error);\n                setEmailReports([]);\n            } finally {\n                setLoadingReports(false);\n            }\n        };\n\n        fetchData();\n    }, [selectedCampaign?.clientId, appliedFromDate, appliedToDate]);\n\n    const [initialLoadDone, setInitialLoadDone] = useState(false);\n    useEffect(() => {\n        if (!loadingReports && !initialLoadDone) {\n            setInitialLoadDone(true);\n        }\n    }, [loadingReports]);\n\n    // Calculate stats from actual email reports (date-filtered)\n    const getCampaignStats = () => {\n        if (!selectedCampaign) {\n            return { campaignSent: 0, campaignRead: 0, readPercentage: 0 };\n        }\n\n        // If date filter is active, use stats aggregated from `emailReports`\n        if (appliedFromDate || appliedToDate) {\n            // Aggregate counts from emailReports by matching report.eId -> mauticEmailId\n            const aggregateCountsFromReportsForEmail = (email) => {\n                // Count sends by reports with a `dateSent` in range\n                const sentReports = reportsForEmailByFieldInRange(email.mauticEmailId, 'dateSent', email);\n                const sent = sentReports.length;\n                // Count reads by reports with a `dateRead` in range\n                const readReports = reportsForEmailByFieldInRange(email.mauticEmailId, 'dateRead', email);\n                const read = readReports.length;\n                return { sent, read };\n            };\n\n            let campaignSent = 0;\n            let campaignRead = 0;\n            selectedCampaign.emails.forEach(e => {\n                const { sent, read } = aggregateCountsFromReportsForEmail(e);\n                campaignSent += sent;\n                campaignRead += read;\n            });\n\n            const readPercentage = campaignSent ? ((campaignRead / campaignSent) * 100).toFixed(2) : 0;\n            return { campaignSent, campaignRead, readPercentage };\n        }\n\n        // No date filter - use original aggregate stats from MauticEmail\n        const campaignSent = selectedCampaign.emails.reduce((sum, e) => sum + (e.sentCount || 0), 0);\n        const campaignRead = selectedCampaign.emails.reduce((sum, e) => sum + (e.readCount || 0), 0);\n        const readPercentage = campaignSent ? ((campaignRead / campaignSent) * 100).toFixed(2) : 0;\n\n        return { campaignSent, campaignRead, readPercentage };\n    };\n\n    // no need to call getCampaignStats again and again\n    const campaignStats = useMemo(\n        () => getCampaignStats(),\n        [selectedCampaign, emailReports, emailReportsIndex, appliedFromDate, appliedToDate]\n    );\n\n    // Get stats for individual emails (date-filtered)\n    const getEmailStats = (email) => {\n        // If date filter is active, use aggregated stats from `emailReports`\n        if (appliedFromDate || appliedToDate) {\n            const sent = reportsForEmailByFieldInRange(email.mauticEmailId, 'dateSent', email).length;\n            const read = reportsForEmailByFieldInRange(email.mauticEmailId, 'dateRead', email).length;\n            const readRate = sent ? ((read / sent) * 100).toFixed(2) : 0;\n            return { sent, read, readRate };\n        }\n\n        // No date filter - use original aggregate stats\n        const sent = email.sentCount || 0;\n        const read = email.readCount || 0;\n        const readRate = sent ? ((read / sent) * 100).toFixed(2) : 0;\n\n        return { sent, read, readRate };\n    };\n\n    const navigateCampaign = (direction) => {\n        const currentIndex = campaigns.findIndex(\n            (c) => c.id === selectedCampaign?.id\n        );\n        if (direction === \"next\" && currentIndex < campaigns.length - 1) {\n            setSelectedCampaign(campaigns[currentIndex + 1]);\n        } else if (direction === \"prev\" && currentIndex > 0) {\n            setSelectedCampaign(campaigns[currentIndex - 1]);\n        }\n    };\n\n    const filteredSegments = selectedCampaign?.segments?.filter(seg => {\n        if (!appliedFromDate && !appliedToDate) return true;\n        if (!seg.dateAdded) return false;\n\n        const segDate = new Date(seg.dateAdded);\n\n        if (appliedFromDate) {\n            const from = new Date(appliedFromDate);\n            from.setHours(0, 0, 0, 0);\n            if (segDate < from) return false;\n        }\n\n        if (appliedToDate) {\n            const to = new Date(appliedToDate);\n            to.setHours(23, 59, 59, 999);\n            if (segDate > to) return false;\n        }\n\n        return true;\n    });\n\n    return (\n        <div className=\"animate-fade-in\">\n            <div className=\"flex items-center justify-between mb-6\">\n                <button onClick={goBackToCampaigns} className=\"flex items-center gap-2 text-gray-600 hover:text-gray-900 transition-colors\">\n                    <ArrowLeftCircle className=\"w-6 h-6\" />\n                    <span className=\"font-medium\">Back to Campaigns</span>\n                </button>\n\n                <div className=\"flex items-center gap-2\">\n                    <button\n                        onClick={() => navigateCampaign('prev')}\n                        disabled={campaigns.findIndex(c => c.id === selectedCampaign?.id) === 0}\n                        className=\"p-2 rounded-lg border border-gray-300 hover:bg-gray-50 disabled:opacity-30 disabled:cursor-not-allowed transition-colors\"\n                        title=\"Previous Campaign\"\n                    >\n                        <ArrowLeftCircle className=\"w-5 h-5\" />\n                    </button>\n                    <button\n                        onClick={() => navigateCampaign('next')}\n                        disabled={campaigns.findIndex(c => c.id === selectedCampaign?.id) === campaigns.length - 1}\n                        className=\"p-2 rounded-lg border border-gray-300 hover:bg-gray-50 disabled:opacity-30 disabled:cursor-not-allowed transition-colors\"\n                        title=\"Next Campaign\"\n                    >\n                        <ArrowRightCircle className=\"w-5 h-5\" />\n                    </button>\n                </div>\n            </div>\n\n            <div className=\"mb-8\">\n                <div className=\"flex items-center gap-3 mb-2\">\n                    <h1 className=\"text-3xl font-bold text-gray-900\">{selectedCampaign?.name}</h1>\n                    {!selectedCampaign?.isPublished && (\n                        <span className=\"px-3 py-1 text-sm rounded-full bg-gray-200 text-gray-600\">Unpublished</span>\n                    )}\n                </div>\n                {selectedCampaign?.description && <p className=\"text-gray-500 mt-2\">{selectedCampaign?.description}</p>}\n            </div>\n\n            {/* Date Range Filter */}\n            <div className=\"rounded-xl shadow-md p-5 mb-6 bg-gradient-to-br from-green-50 to-green-100 border border-green-200\">\n                <div className=\"flex flex-col md:flex-row items-start md:items-end gap-3\">\n                    <div className=\"flex flex-col\">\n                        <label className=\"text-xs font-semibold text-gray-700 mb-1\">From Date</label>\n                        <div className=\"flex items-center\">\n                            <input\n                                ref={fromDateRef}\n                                type=\"date\"\n                                value={draftFromDate}\n                                onChange={(e) => setDraftFromDate(e.target.value)}\n                                className={`hide-date-icon px-4 py-2 border-2 border-gray-300 rounded-lg text-sm focus:border-green-700 bg-white font-medium text-black`}\n                            />\n                            <button\n                                type=\"button\"\n                                onClick={() => openPicker(fromDateRef)}\n                                title=\"Open date picker\"\n                                className=\"-ml-8 p-2 rounded-md text-gray-600 hover:text-black transition-colors\"\n                            >\n                                <Calendar className=\"w-4 h-4\" />\n                            </button>\n                        </div>\n                    </div>\n\n                    <div className=\"flex flex-col\">\n                        <label className=\"text-xs font-semibold text-gray-700 mb-1\">To Date</label>\n                        <div className=\"flex items-center\">\n                            <input\n                                ref={toDateRef}\n                                type=\"date\"\n                                value={draftToDate}\n                                onChange={(e) => setDraftToDate(e.target.value)}\n                                className={` hide-date-icon px-4 py-2 border-2 border-gray-300 rounded-lg text-sm focus:border-green-700 bg-white font-medium text-black`}\n                            />\n                            <button\n                                type=\"button\"\n                                onClick={() => openPicker(toDateRef)}\n                                title=\"Open date picker\"\n                                className=\"-ml-8 p-2 rounded-md text-gray-600 hover:text-black transition-colors\"\n                            >\n                                <Calendar className=\"w-4 h-4\" />\n                            </button>\n                        </div>\n                    </div>\n\n                    <div className=\"flex items-center gap-2\">\n                        <button\n                            onClick={() => {\n                                setAppliedFromDate(draftFromDate);\n                                setAppliedToDate(draftToDate);\n                            }}\n                            className=\"px-4 py-2 bg-gradient-to-r from-green-600 to-green-700 text-white rounded-lg text-sm font-semibold hover:from-green-700 hover:to-green-800 shadow-md hover:shadow-lg transition-all\"\n                        >\n                            Apply\n                        </button>\n\n                        <button\n                            onClick={() => {\n                                setDraftFromDate('');\n                                setDraftToDate('');\n                                setAppliedFromDate('');\n                                setAppliedToDate('');\n                            }}\n                            className=\"px-4 py-2 bg-gradient-to-r from-gray-600 to-gray-700 text-white rounded-lg text-sm font-semibold hover:from-gray-700 hover:to-gray-800 shadow-md hover:shadow-lg transition-all\"\n                        >\n                            Clear\n                        </button>\n                    </div>\n                </div>\n            </div>\n\n            {/* Stats Overview Cards */}\n            <div className=\"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4 mb-8\">\n                <div className=\"bg-gradient-to-br from-primary-500 to-primary-700 rounded-xl p-3\">\n                    <div className=\"flex items-center gap-2 mb-2\">\n                        <Users className=\"w-4 h-4 text-white\" />\n                        <div className=\"text-sm text-white font-semibold\">Total Segments</div>\n                    </div>\n                    <div className=\"text-2xl font-bold text-white\">\n                        {filteredSegments?.length}\n                    </div>\n                </div>\n\n                <div className=\"bg-gradient-to-br from-secondary-500 to-secondary-700 rounded-xl p-3\">\n                    <div className=\"flex items-center gap-2 mb-2\">\n                        <Mail className=\"w-4 h-4 text-white\" />\n                        <div className=\"text-sm text-white font-semibold\">Total Emails</div>\n                    </div>\n                    <div className=\"text-2xl font-bold text-white\">\n                        {selectedCampaign?.emails?.length || 0}\n                    </div>\n                </div>\n\n                {selectedCampaign?.isPublished && (\n                    <>\n                        <div className=\"bg-gradient-to-br from-accent-600 to-accent-800 rounded-xl p-3\">\n                            <div className=\"flex items-center gap-2 mb-2\">\n                                <Mail className=\"w-4 h-4 text-white\" />\n                                <div className=\"text-sm text-white font-bold uppercase tracking-wide\">\n                                    Emails Sent\n                                </div>\n                            </div>\n                            <div className=\"text-2xl font-bold text-white\">\n                                {!initialLoadDone ? '...' : getCampaignStats().campaignSent.toLocaleString()}\n                            </div>\n                            <div className=\"text-xs text-white mt-2 font-medium\">Total deliveries</div>\n                        </div>\n\n                        <div className=\"bg-gradient-to-br from-secondary-700 to-secondary-900 rounded-xl p-3\">\n                            <div className=\"flex items-center gap-2 mb-2\">\n                                <Eye className=\"w-4 h-4 text-white\" />\n                                <div className=\"text-sm text-white font-bold uppercase tracking-wide\">\n                                    Emails Read\n                                </div>\n                            </div>\n                            <div className=\"text-2xl font-bold text-white\">\n                                {!initialLoadDone ? '...' : getCampaignStats().campaignRead.toLocaleString()}\n                            </div>\n                            <div className=\"text-xs text-white mt-2 font-medium\">Total opens</div>\n                        </div>\n                    </>\n                )}\n            </div>\n\n            {/* Overall Read Rate */}\n            {selectedCampaign?.isPublished && (\n                <div className=\"mb-8\">\n                    <div className={`rounded-2xl p-4 shadow-xl border-2 \n                        ${campaignStats.readPercentage > 75\n                            ? \"bg-green-50 border-green-400\"\n                            : campaignStats.readPercentage > 50\n                                ? \"bg-yellow-50 border-yellow-400\"\n                                : \"bg-red-50 border-red-400\"\n                        }\n                        transition-colors duration-300`}\n                    >\n\n                        {/* Header */}\n                        <div className=\"flex items-center justify-between mb-4\">\n                            <div className=\"flex items-center gap-4\">\n                                <div className={`p-3 rounded-lg shadow-inner\n                                    ${campaignStats.readPercentage > 75\n                                        ? \"bg-green-200\"\n                                        : campaignStats.readPercentage > 50\n                                            ? \"bg-yellow-200\"\n                                            : \"bg-red-200\"\n                                    }`}\n                                >\n                                    <Eye\n                                        className={`w-5 h-5 \n                                        ${campaignStats.readPercentage > 75\n                                                ? \"text-green-800\"\n                                                : campaignStats.readPercentage > 50\n                                                    ? \"text-yellow-800\"\n                                                    : \"text-red-800\"\n                                            }`}\n                                    />\n                                </div>\n                                <div>\n                                    <h3 className=\"text-xl font-semibold text-gray-900\">Overall Read Rate</h3>\n                                    <p className=\"text-gray-500 text-sm mt-1\">\n                                        Based on all emails in this campaign\n                                    </p>\n                                </div>\n                            </div>\n\n                            {/* Percentage number */}\n                            <div className=\"text-2xl font-extrabold\">\n                                <span\n                                    className={\n                                        campaignStats.readPercentage > 75\n                                            ? \"text-green-900\"\n                                            : campaignStats.readPercentage > 50\n                                                ? \"text-yellow-900\"\n                                                : \"text-red-900\"\n                                    }\n                                >\n                                    {campaignStats.readPercentage}%\n                                </span>\n                            </div>\n                        </div>\n\n                        {/* Progress Bar */}\n                        <div className=\"w-full bg-gray-200 rounded-full h-3 overflow-hidden\">\n                            <div\n                                className={`h-3 rounded-full transition-all duration-500\n                                ${campaignStats.readPercentage > 75\n                                        ? \"bg-green-500\"\n                                        : campaignStats.readPercentage > 50\n                                            ? \"bg-yellow-400\"\n                                            : \"bg-red-500\"\n                                    }`}\n                                style={{\n                                    width: `${campaignStats.readPercentage}%`,\n                                }}\n                            ></div>\n                        </div>\n                    </div>\n                </div>\n            )}\n\n            {/* Individual Email Performance */}\n            {selectedCampaign?.emails?.length > 0 && selectedCampaign?.isPublished && (\n                <div>\n                    <h2 className=\"text-2xl font-bold text-gray-900 mb-6 flex items-center gap-2\">\n                        <Mail className=\"w-7 h-7 text-blue-600\" />\n                        Individual Email Performance\n                    </h2>\n\n                    <div className=\"bg-white rounded-xl shadow-lg border border-gray-200 overflow-hidden\">\n                        <div className=\"overflow-x-auto\">\n                            <table className=\"min-w-full divide-y divide-gray-200\">\n                                <thead className=\"bg-gradient-to-r from-gray-50 to-gray-100\">\n                                    <tr>\n                                        <th className=\"px-4 py-3 text-left text-xs font-bold text-gray-700 uppercase tracking-wider\">\n                                            Email\n                                        </th>\n                                        <th className=\"px-4 py-3 text-center text-xs font-bold text-blue-700 uppercase tracking-wider\">\n                                            <div className=\"flex items-center justify-center gap-1\">\n                                                <Mail className=\"w-4 h-4\" />\n                                                Sent\n                                            </div>\n                                        </th>\n                                        <th className=\"px-4 py-3 text-center text-xs font-bold text-green-700 uppercase tracking-wider\">\n                                            <div className=\"flex items-center justify-center gap-1\">\n                                                <Eye className=\"w-4 h-4\" />\n                                                Read\n                                            </div>\n                                        </th>\n                                        <th className=\"px-4 py-3 text-center text-xs font-bold text-purple-700 uppercase tracking-wider\">\n                                            <div className=\"flex items-center justify-center gap-1\">\n                                                <TrendingUp className=\"w-4 h-4\" />\n                                                Read Rate\n                                            </div>\n                                        </th>\n                                    </tr>\n                                </thead>\n\n                                <tbody className=\"bg-white divide-y divide-gray-100\">\n                                    {selectedCampaign?.emails?.map((email, index) => {\n                                        const stats = getEmailStats(email);\n\n                                        return (\n                                            <tr\n                                                key={email.id}\n                                                className={`hover:bg-blue-50 transition-colors ${index % 2 === 0 ? \"bg-white\" : \"bg-gray-50\"}`}\n                                            >\n                                                <td className=\"px-4 py-3\">\n                                                    <div className=\"flex items-center gap-2\">\n                                                        <Mail className=\"w-4 h-4 text-gray-400\" />\n                                                        <span className=\"text-sm font-medium text-gray-700 truncate\">\n                                                            {email.name}\n                                                        </span>\n                                                    </div>\n                                                </td>\n\n                                                <td className=\"px-4 py-3 text-center\">\n                                                    <span className=\"text-sm font-semibold text-blue-800\">\n                                                        {!initialLoadDone ? '...' : stats.sent.toLocaleString()}\n                                                    </span>\n                                                </td>\n\n                                                <td className=\"px-4 py-3 text-center\">\n                                                    <span className=\"text-sm font-semibold text-green-800\">\n                                                        {!initialLoadDone ? '...' : stats.read.toLocaleString()}\n                                                    </span>\n                                                </td>\n\n                                                <td className=\"px-4 py-3 text-center\">\n                                                    <span\n                                                        className={`inline-flex items-center justify-center px-3 py-1 rounded-full text-xs font-bold ${stats.readRate > 75\n                                                            ? \"bg-green-100 text-green-800\"\n                                                            : stats.readRate > 50\n                                                                ? \"bg-yellow-100 text-yellow-800\"\n                                                                : \"bg-red-100 text-red-800\"\n                                                            }`}\n                                                    >\n                                                        {!initialLoadDone ? '...' : `${stats.readRate}%`}\n                                                    </span>\n                                                </td>\n                                            </tr>\n                                        );\n                                    })}\n                                </tbody>\n\n                                {/* Table Footer Totals */}\n                                <tfoot className=\"bg-gradient-to-r from-blue-100 to-purple-100 border-t-2 border-blue-300\">\n                                    <tr>\n                                        <td className=\"px-4 py-3 font-bold text-gray-900 text-sm\">\n                                            Total ({selectedCampaign?.emails?.length} Emails)\n                                        </td>\n\n                                        <td className=\"px-4 py-3 text-center\">\n                                            <span className=\"text-lg font-extrabold text-blue-900\">\n                                                {!initialLoadDone ? '...' : getCampaignStats().campaignSent.toLocaleString()}\n                                            </span>\n                                        </td>\n\n                                        <td className=\"px-4 py-3 text-center\">\n                                            <span className=\"text-lg font-extrabold text-green-900\">\n                                                {!initialLoadDone ? '...' : getCampaignStats().campaignRead.toLocaleString()}\n                                            </span>\n                                        </td>\n\n                                        <td className=\"px-4 py-3 text-center\">\n                                            <span\n                                                className={`inline-flex items-center px-3 py-1 rounded font-extrabold text-sm ${getCampaignStats().readPercentage > 75\n                                                    ? \"bg-green-200 text-green-900\"\n                                                    : getCampaignStats().readPercentage > 50\n                                                        ? \"bg-yellow-200 text-yellow-900\"\n                                                        : \"bg-red-200 text-red-900\"\n                                                    }`}\n                                            >\n                                                {!initialLoadDone ? '...' : `${getCampaignStats().readPercentage}%`}\n                                            </span>\n                                        </td>\n                                    </tr>\n                                </tfoot>\n                            </table>\n                        </div>\n                    </div>\n                </div>\n            )}\n        </div>\n    )\n}\n\nexport default MauticEmailsSection;","import { useState, useRef, useEffect } from \"react\";\nimport { Mail, ArrowLeft, Activity, Users, BarChart3, TrendingUp, Calendar } from \"lucide-react\";\nimport axios from \"axios\";\n\n\nconst MauticCampaignsSection = ({ campaigns, selectedClient, loadingCampaigns, goBackToServices, openCampaignDetails }) => {\n    // draft values (user can change but they don't apply until Submit)\n    const [draftFromDate, setDraftFromDate] = useState(\"\");\n    const [draftToDate, setDraftToDate] = useState(\"\");\n    // applied values used for filtering\n    const [appliedFromDate, setAppliedFromDate] = useState(\"\");\n    const [appliedToDate, setAppliedToDate] = useState(\"\");\n    const [emailReports, setEmailReports] = useState([]);\n    const [loadingReports, setLoadingReports] = useState(false);\n    const [emailReportsIndex, setEmailReportsIndex] = useState(new Map());\n\n    const fromDateRef = useRef(null);\n    const toDateRef = useRef(null);\n\n    // Helper: get reports for a specific mauticEmail that have a particular date field within range\n    const reportsForEmailByFieldInRange = (emailId, field, email) => {\n        const entry = emailReportsIndex.get(String(emailId));\n\n        // New aggregate format\n        if (entry && typeof entry.sentCount === \"number\") {\n            const count = field === 'dateSent' ? entry.sentCount : entry.readCount;\n            return new Array(count).fill(null);\n        }\n\n        if (appliedFromDate || appliedToDate) {\n            return [];\n        }\n    };\n\n    const openPicker = (ref) => {\n        if (!ref?.current) return;\n        if (typeof ref.current.showPicker === 'function') {\n            try { ref.current.showPicker(); } catch (err) { console.debug(err); }\n        }\n        if (typeof ref.current.focus === 'function') ref.current.focus();\n    };\n\n    // Fetch email reports when client or applied dates change\n    useEffect(() => {\n        if (!selectedClient?.id) return;\n\n        const fetchReports = async () => {\n            setLoadingReports(true);\n            try {\n                const params = new URLSearchParams();\n                if (appliedFromDate) params.append('fromDate', appliedFromDate);\n                if (appliedToDate) params.append('toDate', appliedToDate);\n\n                // Fetch reports\n                const baseUrl = import.meta.env.VITE_API_URL || \"\";\n                const response = await axios.get(`${baseUrl}/api/mautic/clients/${selectedClient.mauticApiId}/email-reports?${params}`);\n\n                const reports = response.data.data || [];\n\n                // Detect if backend returned aggregated counts\n                const isAggregated = reports.length > 0;\n\n                const reportIndex = new Map();\n\n                if (isAggregated) {\n                    // New format: aggregated by eId\n                    for (const r of reports) {\n                        reportIndex.set(String(r.eId), { sentCount: r.sentCount || 0, readCount: r.readCount || 0 });\n                    }\n                }\n\n                setEmailReports(reports);\n                setEmailReportsIndex(reportIndex);\n\n            } catch (error) {\n                console.error('Error fetching email reports:', error);\n                setEmailReports([]);\n            } finally {\n                setLoadingReports(false);\n            }\n        };\n\n        fetchReports();\n    }, [selectedClient?.id, appliedFromDate, appliedToDate]);\n\n    const [initialLoadDone, setInitialLoadDone] = useState(false);\n    useEffect(() => {\n        if (!loadingReports && !initialLoadDone) setInitialLoadDone(true);\n    }, [loadingReports]);\n\n    const getAllCampaignsEmailsSent = (campaigns) => {\n        if (!Array.isArray(campaigns)) return 0;\n        // If date filter is active, use email reports\n        if (appliedFromDate || appliedToDate) {\n            let total = 0;\n            campaigns.forEach(campaign => {\n                campaign.emails.forEach(email => {\n                    total += reportsForEmailByFieldInRange(email.mauticEmailId, 'dateSent', email).length;\n                });\n            });\n            return total;\n        }\n        // No filter - use aggregate counts\n        const allCampaignsEmailsSent = campaigns.reduce((a, c) => a + getCampaignEmailsSent(c), 0);\n        return allCampaignsEmailsSent;\n    };\n\n    const getCampaignEmailsSent = (campaign) => {\n        if (!campaign) return 0;\n\n        // If date filter is active, use email reports\n        if (appliedFromDate || appliedToDate) {\n            let total = 0;\n            campaign.emails.forEach(email => {\n                total += reportsForEmailByFieldInRange(email.mauticEmailId, 'dateSent', email).length;\n            });\n            return total;\n        }\n        // No filter - use aggregate counts\n        const campaignEmailsSent = campaign.emails.reduce((a, e) => a + (e.sentCount || 0), 0);\n        return campaignEmailsSent;\n    };\n\n    // Get unique emails across all campaigns (avoid double-counting)\n    const getUniqueEmailsCount = (campaigns) => {\n        const uniqueEmailIds = new Set();\n        campaigns.forEach(campaign => {\n            campaign.emails.forEach(email => {\n                uniqueEmailIds.add(email.mauticEmailId);\n            });\n        });\n        return uniqueEmailIds.size;\n    };\n\n    return (\n        <div className=\"animate-fade-in\">\n            <button\n                onClick={goBackToServices}\n                className=\"flex items-center gap-2 text-gray-600 hover:text-gray-900 mb-6\"\n            >\n                <ArrowLeft className=\"w-5 h-5\" />\n                <span className=\"font-medium\">Back to {selectedClient?.name} Services</span>\n            </button>\n\n            <div className=\"mb-8\">\n                <h1 className=\"text-3xl font-bold text-gray-900\">Autovation Campaigns</h1>\n                <p className=\"text-gray-500 mt-2\">Viewing campaigns for <span className=\"font-semibold\">{selectedClient?.name}</span></p>\n            </div>\n\n            {loadingCampaigns ? (\n                <div className=\"flex justify-center items-center py-12\"><div className=\"text-gray-500\">Loading campaigns...</div></div>\n            ) : campaigns.length === 0 ? (\n                <div className=\"flex justify-center items-center py-12\"><div className=\"text-gray-400\">No campaigns found.</div></div>\n            ) : (\n                <>\n                    {/* Date Range Filter */}\n                    <div className=\"rounded-xl shadow-md p-5 mb-6 bg-gradient-to-br from-green-50 to-green-100 border border-green-200\">\n                        <div className=\"flex flex-col md:flex-row items-start md:items-end gap-3\">\n                            <div className=\"flex items-center gap-2\">\n                                <div className=\"flex flex-col\">\n                                    <label className=\"text-xs font-semibold text-gray-700 mb-1\">From Date</label>\n                                    <div className=\"flex items-center\">\n                                        <input\n                                            ref={fromDateRef}\n                                            type=\"date\"\n                                            value={draftFromDate}\n                                            onChange={(e) => setDraftFromDate(e.target.value)}\n                                            className={`hide-date-icon px-4 py-2 border-2 border-gray-300 rounded-lg text-sm focus:border-green-700 bg-white font-medium text-black`}\n                                        />\n                                        <button\n                                            type=\"button\"\n                                            onClick={() => openPicker(fromDateRef)}\n                                            title=\"Open date picker\"\n                                            className=\"-ml-8 transparent p-2 rounded-md text-gray-600 hover:text-black transition-colors\"\n                                        >\n                                            <Calendar className=\"w-4 h-4\" />\n                                        </button>\n                                    </div>\n                                </div>\n                            </div>\n\n                            <div className=\"flex items-center gap-2\">\n                                <div className=\"flex flex-col\">\n                                    <label className=\"text-xs font-semibold text-gray-700 mb-1\">To Date</label>\n                                    <div className=\"flex items-center\">\n                                        <input\n                                            ref={toDateRef}\n                                            type=\"date\"\n                                            value={draftToDate}\n                                            onChange={(e) => setDraftToDate(e.target.value)}\n                                            className={`hide-date-icon px-4 py-2 border-2 border-gray-300 rounded-lg text-sm focus:border-green-700 bg-white font-medium text-black`}\n                                        />\n                                        <button\n                                            type=\"button\"\n                                            onClick={() => openPicker(toDateRef)}\n                                            title=\"Open date picker\"\n                                            className=\"-ml-8 p-2 rounded-md text-gray-600 hover:text-black transition-colors\"\n                                        >\n                                            <Calendar className=\"w-4 h-4\" />\n                                        </button>\n                                    </div>\n                                </div>\n                            </div>\n\n                            <div className=\"flex items-center gap-2\">\n                                <button\n                                    onClick={() => {\n                                        // apply the draft dates\n                                        setAppliedFromDate(draftFromDate);\n                                        setAppliedToDate(draftToDate);\n                                    }}\n                                    className=\"px-4 py-2 bg-gradient-to-r from-green-600 to-green-700 text-white rounded-lg text-sm font-semibold hover:from-green-700 hover:to-green-800 shadow-md hover:shadow-lg transition-all\"\n                                >\n                                    Apply\n                                </button>\n\n                                <button\n                                    onClick={() => {\n                                        setDraftFromDate('');\n                                        setDraftToDate('');\n                                        setAppliedFromDate('');\n                                        setAppliedToDate('');\n                                    }}\n                                    className=\"px-4 py-2 bg-gradient-to-r from-gray-600 to-gray-700 text-white rounded-lg text-sm font-semibold hover:from-gray-700 hover:to-gray-800 shadow-md hover:shadow-lg transition-all\"\n                                >\n                                    Clear\n                                </button>\n                            </div>\n                        </div>\n                    </div>\n\n                    {/* Total Summary */}\n                    <div className=\"bg-gradient-to-br from-blue-50 to-purple-50 rounded-xl shadow-xl border-2 border-blue-300 overflow-hidden\">\n                        <div className=\"p-3 bg-gradient-to-r from-primary-600 to-primary-800\">\n                            <div className=\"flex items-center gap-3\">\n                                <BarChart3 className=\"w-4 h-4 text-white\" />\n                                <h3 className=\"text-xl font-bold text-white\">Overall Campaign Summary</h3>\n                            </div>\n                        </div>\n                        <div className=\"p-4\">\n                            <div className=\"grid grid-cols-2 md:grid-cols-4 gap-4\">\n                                <div className=\"bg-gradient-to-br from-primary-500 to-primary-700 rounded-xl p-3\">\n                                    <div className=\"flex items-center gap-2 mb-2\">\n                                        <Activity className=\"w-3 h-3 text-white\" />\n                                        <div className=\"text-xs text-white font-bold uppercase\">Total Campaigns</div>\n                                    </div>\n                                    <div className=\"text-2xl font-extrabold text-white\">{campaigns.length}</div>\n                                </div>\n                                <div className=\"bg-gradient-to-br from-secondary-500 to-secondary-700 rounded-xl p-3\">\n                                    <div className=\"flex items-center gap-2 mb-2\">\n                                        <Users className=\"w-3 h-3 text-white\" />\n                                        <div className=\"text-xs text-white font-bold uppercase\">Total Segments</div>\n                                    </div>\n                                    <div className=\"text-2xl font-extrabold text-white\">{campaigns[0]?.segments?.length || 0}</div>\n                                </div>\n                                <div className=\"bg-gradient-to-br from-accent-600 to-accent-800 rounded-xl p-3\">\n                                    <div className=\"flex items-center gap-2 mb-2\">\n                                        <Mail className=\"w-3 h-3 text-white\" />\n                                        <div className=\"text-xs text-white font-bold uppercase\">Total Emails</div>\n                                    </div>\n                                    <div className=\"text-2xl font-extrabold text-white\">{getUniqueEmailsCount(campaigns)}</div>\n                                </div>\n                                <div className=\"bg-gradient-to-br from-secondary-700 to-secondary-900 rounded-xl p-3\">\n                                    <div className=\"flex items-center gap-2 mb-2\">\n                                        <Mail className=\"w-3 h-3 text-white\" />\n                                        <div className=\"text-xs text-white font-bold uppercase\">Total Emails Sent</div>\n                                    </div>\n                                    <div className=\"text-2xl font-extrabold text-white\">\n                                        {!initialLoadDone ? '...' : getAllCampaignsEmailsSent(campaigns).toLocaleString()}\n                                    </div>\n                                </div>\n                            </div>\n                        </div>\n                    </div>\n\n                    {/* Campaigns Table - Compact Row View */}\n                    <div className=\"bg-white rounded-xl shadow-lg border border-gray-200 overflow-hidden mt-8\">\n                        <div className=\"overflow-x-auto\">\n                            <table className=\"min-w-full divide-y divide-gray-200\">\n                                <thead className=\"bg-gradient-to-r from-gray-50 to-gray-100\">\n                                    <tr>\n                                        <th className=\"px-4 py-3 text-left text-xs font-bold text-gray-700 uppercase tracking-wider\">\n                                            Campaign Name\n                                        </th>\n                                        <th className=\"px-4 py-3 text-center text-xs font-bold text-purple-700 uppercase tracking-wider\">\n                                            <div className=\"flex items-center justify-center gap-1\">\n                                                <Mail className=\"w-4 h-4\" />\n                                                Emails\n                                            </div>\n                                        </th>\n                                        <th className=\"px-4 py-3 text-center text-xs font-bold text-gray-700 uppercase tracking-wider\">\n                                            <div className=\"flex items-center justify-center gap-1\">\n                                                <Mail className=\"w-4 h-4\" />\n                                                Emails Sent\n                                            </div>\n                                        </th>\n                                        <th className=\"px-4 py-3 text-center text-xs font-bold text-green-700 uppercase tracking-wider\">\n                                            <div className=\"flex items-center justify-center gap-1\">\n                                                <TrendingUp className=\"w-4 h-4\" />\n                                                Read Rate\n                                            </div>\n                                        </th>\n                                    </tr>\n                                </thead>\n                                <tbody className=\"bg-white divide-y divide-gray-100\">\n                                    {campaigns.map((campaign, index) => {\n                                        // Calculate sent/read using date-filtered reports if filter is active\n                                        let campaignSent, campaignRead;\n                                        if (appliedFromDate || appliedToDate) {\n                                            campaignSent = 0;\n                                            campaignRead = 0;\n                                            campaign.emails.forEach(email => {\n                                                campaignSent += reportsForEmailByFieldInRange(email.mauticEmailId, 'dateSent', email).length;\n                                                campaignRead += reportsForEmailByFieldInRange(email.mauticEmailId, 'dateRead', email).length;\n                                            });\n                                        } else {\n                                            campaignSent = campaign.emails.reduce((a, e) => a + e.sentCount, 0);\n                                            campaignRead = campaign.emails.reduce((a, e) => a + e.readCount, 0);\n                                        }\n                                        const readPercentage = campaignSent ? ((campaignRead / campaignSent) * 100).toFixed(2) : 0;\n\n                                        return (\n                                            <tr\n                                                key={campaign.id}\n                                                className={`hover:bg-blue-50 transition-colors cursor-pointer ${index % 2 === 0 ? 'bg-white' : 'bg-gray-50'}`}\n                                                onClick={() => openCampaignDetails(campaign)}\n                                            >\n                                                <td className=\"px-4 py-3\">\n                                                    <div className=\"flex items-center gap-2\">\n                                                        <Activity className=\"w-4 h-4 text-purple-600\" />\n                                                        <div>\n                                                            <div className=\"font-semibold text-gray-900 text-sm\">{campaign.name}</div>\n                                                            {!campaign.isPublished && (\n                                                                <span className=\"inline-block mt-1 px-2 py-0.5 text-xs font-semibold rounded-full bg-amber-100 text-amber-700\">\n                                                                    Unpublished\n                                                                </span>\n                                                            )}\n                                                        </div>\n                                                    </div>\n                                                </td>\n                                                <td className=\"px-4 py-3 text-center\">\n                                                    <span className=\"text-sm font-bold text-purple-800\">{campaign.emails.length}</span>\n                                                </td>\n                                                <td className=\"px-4 py-3 text-center\">\n                                                    <span className=\"text-sm font-bold text-gray-800\">{!initialLoadDone ? '...' : getCampaignEmailsSent(campaign).toLocaleString()}</span>\n                                                </td>\n                                                <td className=\"px-4 py-3 text-center\">\n                                                    {campaign.isPublished ? (\n                                                        <span className={`inline-flex items-center px-2 py-1 rounded text-xs font-bold ${readPercentage > 75\n                                                            ? \"bg-green-100 text-green-800\"\n                                                            : readPercentage > 50\n                                                                ? \"bg-yellow-100 text-yellow-800\"\n                                                                : \"bg-red-100 text-red-800\"\n                                                            }`}>\n                                                            {!initialLoadDone ? '...' : readPercentage}%\n                                                        </span>\n                                                    ) : (\n                                                        <span className=\"text-gray-400 text-xs\">N/A</span>\n                                                    )}\n                                                </td>\n                                            </tr>\n                                        );\n                                    })}\n                                </tbody>\n                            </table>\n                        </div>\n                    </div>\n                </>\n            )}\n        </div>\n    )\n}\n\nexport default MauticCampaignsSection;","\nimport { toast } from 'react-toastify';\nimport { useMetrics, useSyncLogs, useManualFetch } from '../../hooks/dropCowboy/useDropCowboy';\n\nimport React, { useState, useEffect, useMemo } from \"react\";\nimport { AlertCircle, RefreshCw, Activity } from 'lucide-react';\nimport useViewLevel from \"../../zustand/useViewLevel\";\nimport ErrorBoundary from './ErrorBoundary.jsx';\nimport MetricsCards from './MetricsCards.jsx';\nimport { format, parseISO } from 'date-fns';\n\n\nconst DropCowboyServiceStats = ({ selectedClient }) => {\n    // Use custom hooks for data fetching\n    const { metrics, loading, error, refetch: refetchMetrics } = useMetrics({});\n    const { syncLogs, refetch: refetchSyncLogs } = useSyncLogs(10);\n    const { triggerFetch, isFetching, error: fetchError } = useManualFetch();\n\n    const { dropcowboy, setDCCampaigns, setDCMetrics } = useViewLevel();\n    const { campaigns, savedMetrics } = dropcowboy;\n    const [allRecords, setAllRecords] = useState([]);\n\n    useEffect(() => {\n        setDCCampaigns(metrics?.campaigns);\n        setDCMetrics(metrics);\n    }, [metrics]);\n\n    // Handle manual SFTP fetch\n    const handleFetchNow = async () => {\n        toast.info('Starting SFTP sync... This may take 30-60 seconds.', { autoClose: 3000 });\n\n        const result = await triggerFetch();\n\n        if (result.success) {\n            // Reload data after successful fetch\n            await refetchMetrics();\n            await refetchSyncLogs();\n\n            if (result.data?.warning) {\n                toast.warning(result.data.warning, { autoClose: 5000 });\n            } else if (result.data?.filesDownloaded > 0) {\n                toast.success(`Successfully fetched ${result.data.filesDownloaded} files from SFTP!`, { autoClose: 5000 });\n            } else {\n                toast.info('Sync completed - using existing data.', { autoClose: 3000 });\n            }\n        } else {\n            toast.error('Failed to fetch data: ' + (result.error || 'Unknown error'), { autoClose: 5000 });\n        }\n    };\n\n    // If campaigns prop is passed, use it as a fallback initial load\n    useEffect(() => {\n        if (campaigns && campaigns.length > 0) {\n            const records = campaigns.flatMap((campaign) => {\n                const clientName = campaign.client || \"Unknown\";\n                const segment = campaign.campaignName || \"\";\n\n                return campaign.records.map((record) => ({\n                    ...record,\n                    client: clientName,\n                    segment: segment.trim(),\n                    status: record.status?.trim()?.toLowerCase() || \"other\",\n                }));\n            });\n\n            setAllRecords(records);\n            \n        }\n    }, [campaigns]);\n\n    // üîπ Filters applied to metrics (no status filter)\n    const filteredRecordsForMetrics = useMemo(() => {\n        let records = allRecords.filter((r) => r.client === selectedClient.name);\n\n        return records;\n    }, [allRecords, selectedClient]);\n\n    const metricsStats = useMemo(() => {\n        const totalSent = filteredRecordsForMetrics.length;\n        const successfulDeliveries = filteredRecordsForMetrics.filter(\n            (r) => r.status === \"success\"\n        ).length;\n        const failedSends = filteredRecordsForMetrics.filter(\n            (r) => r.status === \"failure\"\n        ).length;\n        const otherStatus = filteredRecordsForMetrics.filter(\n            (r) => ![\"success\", \"failure\"].includes(r.status)\n        ).length;\n\n        return {\n            overall: {\n                totalSent,\n                successfulDeliveries,\n                failedSends,\n                otherStatus,\n                averageSuccessRate:\n                    totalSent > 0 ? (successfulDeliveries / totalSent) * 100 : 0,\n            },\n        };\n    }, [filteredRecordsForMetrics]);\n\n    if (!metricsStats || !metricsStats.overall) {\n        return (\n            <div className=\"flex gap-4 overflow-x-auto py-1\">\n                {[...Array(5)].map((_, i) => (\n                    <div key={i} className=\"bg-white rounded-xl border border-gray-200/60 p-5 animate-pulse min-w-[220px] flex-shrink-0\">\n                        <div className=\"h-3 bg-gray-200 rounded w-1/2 mb-3\"></div>\n                        <div className=\"h-7 bg-gray-200 rounded w-3/4 mb-2\"></div>\n                        <div className=\"h-2 bg-gray-200 rounded w-1/3\"></div>\n                    </div>\n                ))}\n            </div>\n        );\n    }\n\n    return (\n        <ErrorBoundary>\n            {/* Error Messages */}\n            {(error || fetchError) && (\n                <div className=\"mb-6 bg-red-50 border border-red-200 rounded-lg p-4 flex items-start\">\n                    <AlertCircle className=\"text-red-600 mr-3 flex-shrink-0 mt-0.5\" size={18} />\n                    <p className=\"text-sm text-red-800 leading-relaxed\">\n                        {error || fetchError}\n                    </p>\n                </div>\n            )}\n\n            {/* Minimal Action Bar */}\n            <div className=\"mb-1 flex items-center justify-between gap-4 bg-white py-1 px-2 rounded-lg shadow-sm border border-gray-200\">\n                <div className=\"flex items-center gap-4\">\n                    {/* Last Sync Info - Compact */}\n                    {syncLogs.length > 0 && syncLogs[0] && (\n                        <div className=\"text-xs text-gray-500\">\n                            Last sync: {format(parseISO(syncLogs[0].timestamp), 'MMM dd, h:mm a')}\n                        </div>\n                    )}\n                </div>\n\n                {/* Action Buttons */}\n                <div className=\"flex items-center gap-2\">\n                    <button\n                        onClick={handleFetchNow}\n                        disabled={isFetching}\n                        className=\"flex items-center gap-2 px-3 py-1.5 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors disabled:opacity-50 disabled:cursor-not-allowed text-sm\"\n                    >\n                        <RefreshCw className={`w-2 h-2 ${isFetching ? 'animate-spin' : ''}`} />\n                        {isFetching ? 'Fetching...' : 'Fetch from SFTP'}\n                    </button>\n                </div>\n            </div>\n\n            {/* Loading State */}\n            {savedMetrics?.length === 0  ? (\n                <div className=\"flex items-center justify-center\">\n                    <div className=\"text-center\">\n                        <Activity className=\"animate-spin mx-auto mb-4 text-blue-600\" size={40} />\n                        <p className=\"text-gray-600 text-sm font-medium\">Loading dashboard...</p>\n                    </div>\n                </div>\n            ) : (\n                <MetricsCards metrics={metricsStats} />\n            )}\n        </ErrorBoundary>\n    )\n}\n\nexport default DropCowboyServiceStats","import { Mail, List, Send } from 'lucide-react';\nimport { formatNumber } from '../../utils/mautic';\n\n\nconst MauticServiceStats = ({ selectedClient }) => {\n    const cards = [\n        {\n            title: 'Total Emails',\n            value: formatNumber(selectedClient.totalEmails),\n            icon: Mail,\n            color: 'bg-indigo-500',\n        },\n        {\n            title: 'Total Campaigns',\n            value: formatNumber(selectedClient.totalCampaigns || 0),\n            icon: Send,\n            color: 'bg-purple-500',\n        },\n        {\n            title: 'Total Segments',\n            value: formatNumber(selectedClient.totalSegments),\n            icon: List,\n            color: 'bg-green-500',\n        }\n    ];\n\n    return (\n        <div className=\"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-2\">\n            {cards.map((card, index) => {\n                const Icon = card.icon;\n                return (\n                    <div\n                        key={index}\n                        className=\"bg-white rounded-lg shadow-sm border border-gray-200 p-3 hover:shadow-md transition-shadow\"\n                    >\n                        <div className=\"flex items-start justify-between\">\n                            <div className=\"flex-1\">\n                                <p className=\"text-sm font-medium text-gray-600 mb-1\">\n                                    {card.title}\n                                </p>\n                                <p className=\"text-xl font-bold text-gray-900\">\n                                    {card.value}\n                                </p>\n                            </div>\n                            <div className={`${card.color} p-3 rounded-lg`}>\n                                <Icon className=\"text-white\" size={20} />\n                            </div>\n                        </div>\n                    </div>\n                );\n            })}\n        </div>\n    );\n}\n\nexport default MauticServiceStats","import { Mail, PhoneOff, ArrowLeft } from \"lucide-react\";\nimport DropCowboyServiceStats from \"./dropCowboy/DropCowboyServiceStats\";\nimport MauticServiceStats from \"./mautic/MauticServiceStats\";\nimport useViewLevel from \"../zustand/useViewLevel\";\n\nconst ClientServicesSection = ({ selectedClient, goBackToClients, openMauticCampaigns, openDropcowboyCampaigns }) => {\n\n    const { selectedService, setSelectedService } = useViewLevel();\n    if (selectedService === null) {\n        setSelectedService(selectedClient.services[0] || 'mautic');\n    }\n\n    return (\n        <div className=\"animate-fade-in\">\n            {/* Back Button */}\n            <button\n                onClick={goBackToClients}\n                className=\"flex items-center gap-2 text-gray-600 hover:text-gray-900 mb-4\"\n            >\n                <ArrowLeft className=\"w-5 h-5\" />\n                <span className=\"font-medium\">Back to Clients</span>\n            </button>\n\n            {/* Service selector for metric cards */}\n            <div className=\"bg-white border-b border-gray-200 sticky z-40\">\n                <div className=\"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8\">\n                    <div className=\"flex items-center gap-2\">\n                        <span className=\"text-sm font-medium text-gray-500 py-4\">Service Stats:</span>\n                        <nav className=\"flex space-x-4\" aria-label=\"Services\">\n                            {selectedClient.services.includes('mautic') ?\n                                <button\n                                    onClick={() => setSelectedService('mautic')}\n                                    className={`\n                  flex items-center gap-2 px-4 py-4 border-b-2 font-medium text-sm transition-colors\n                  ${selectedService === 'mautic'\n                                            ? 'border-blue-500 text-blue-600'\n                                            : 'border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300'\n                                        }\n                `}\n                                >\n                                    <span className=\"text-lg\"></span>\n                                    <span>Autovation</span>\n                                </button>\n                                : <></>\n                            }\n\n                            {selectedClient.services.includes('dropcowboy') ?\n                                <button\n                                    onClick={() => setSelectedService('dropcowboy')}\n                                    className={`\n                  flex items-center gap-2 px-4 py-4 border-b-2 font-medium text-sm transition-colors\n                  ${selectedService === 'dropcowboy'\n                                            ? 'border-blue-500 text-blue-600'\n                                            : 'border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300'\n                                        }\n                `}\n                                >\n                                    <span className=\"text-lg\"></span>\n                                    <span>Ringless Voicemail</span>\n                                </button>\n                                : <></>\n                            }\n                        </nav>\n                    </div>\n                </div>\n            </div>\n\n            {/* metrics in service level view */}\n            <div className=\"my-2 flex flex-col w-full p-1 bg-blue-50 border border-gray-100 rounded-md\">\n                {selectedService === 'dropcowboy' && <DropCowboyServiceStats selectedClient={selectedClient} />}\n\n                {selectedService === 'mautic' && <MauticServiceStats selectedClient={selectedClient} />}\n            </div>\n\n            {/* Header */}\n            <div className=\"mb-6\">\n                <h1 className=\"text-3xl font-bold text-gray-900\">Select Service</h1>\n                <p className=\"text-gray-500 mt-20s0 text-sm\">\n                    Choose a service for <span className=\"font-semibold\">{selectedClient.name}</span>\n                </p>\n            </div>\n\n            {/* Services Table */}\n            <div className=\"overflow-x-auto\">\n                <table className=\"min-w-full divide-y divide-gray-200\">\n                    <thead className=\"bg-gray-50\">\n                        <tr>\n                            <th className=\"px-4 py-3 text-left text-sm font-semibold text-gray-700\">Service</th>\n                            <th className=\"px-4 py-3 text-left text-sm font-semibold text-gray-700\">Description</th>\n                            <th className=\"px-4 py-3 text-center text-sm font-semibold text-gray-700\">Status</th>\n                        </tr>\n                    </thead>\n                    <tbody className=\"bg-white divide-y divide-gray-200\">\n                        {/* Mautic Service */}\n                        <tr\n                            className={`transition-colors ${selectedClient.services.includes('mautic') ? 'hover:bg-gray-50 cursor-pointer' : 'cursor-not-allowed opacity-70 bg-gray-200 hover:bg-gray-200'}`}\n                            onClick={selectedClient.services.includes('mautic') ? openMauticCampaigns : undefined}\n                        >\n                            <td className=\"px-4 py-3 flex items-center gap-3\">\n                                <div className=\"p-3 bg-blue-100 rounded-lg\">\n                                    <Mail className=\"w-6 h-6 text-blue-600\" />\n                                </div>\n                                <span className=\"text-gray-900 font-medium\">Autovation</span>\n                            </td>\n                            <td className=\"px-4 py-3 text-gray-600\">Email Marketing Campaigns</td>\n                            <td className=\"px-4 py-3 text-center\">\n                                <span className=\"flex items-center justify-center gap-2\">\n                                    <span className={`w-3 h-3 rounded-full ${selectedClient.isActive ? \"bg-green-500\" : \"bg-gray-400\"}`}></span>\n                                    <span className=\"text-sm font-medium\">\n                                        {selectedClient.isActive ? \"Active\" : \"Inactive\"}\n                                    </span>\n                                </span>\n                            </td>\n                        </tr>\n\n                        {/* Ringless Voicemail Service */}\n                        <tr\n                            className={`transition-colors ${selectedClient.services.includes('dropcowboy') ? 'hover:bg-gray-50 cursor-pointer' : 'cursor-not-allowed opacity-70 bg-gray-100 hover:bg-gray-100'}`}\n                            onClick={selectedClient.services.includes('dropcowboy') ? openDropcowboyCampaigns : undefined}\n                        >\n                            <td className=\"px-4 py-3 flex items-center gap-3\">\n                                <div className=\"p-3 bg-green-100 rounded-lg\">\n                                    <PhoneOff className=\"w-6 h-6 text-green-500\" />\n                                </div>\n                                <span className=\"text-gray-900 font-medium\">Ringless Voicemail</span>\n                            </td>\n                            <td className=\"px-4 py-3 text-gray-600\">Voicemail Campaigns</td>\n                            <td className=\"px-4 py-3 text-center\">\n                                <span className=\"flex items-center justify-center gap-2\">\n                                    <span className={`w-3 h-3 rounded-full ${selectedClient.isActive ? \"bg-green-500\" : \"bg-gray-400\"}`}></span>\n                                    <span className=\"text-sm font-medium\">\n                                        {selectedClient.isActive ? \"Active\" : \"Inactive\"}\n                                    </span>\n                                </span>\n                            </td>\n                        </tr>\n                    </tbody>\n                </table>\n            </div>\n        </div>\n    )\n}\n\nexport default ClientServicesSection","import { useState, useEffect } from \"react\";\nimport axios from \"axios\";\nimport { useAuth } from \"../contexts/AuthContext\";\nimport { ArrowLeft } from \"lucide-react\";\nimport ClientsDropCowboyDashboard from \"../components/dropCowboy/ClientsDropCowboyDashboard\";\nimport MauticEmailsSection from \"../components/mautic/MauticEmailsSection\";\nimport MauticCampaignsSection from \"../components/mautic/MauticCampaignsSection\";\nimport useViewLevel from \"../zustand/useViewLevel\";\nimport ClientServicesSection from \"../components/ClientServicesSection\";\nimport { usePermissions } from \"../utils/permissions\";\n\nconst Clients = () => {\n    const {\n        view, setView,\n        selectedClient, setSelectedClient,\n        setSelectedService,\n        selectedCampaign, setSelectedCampaign,\n        campaigns, setCampaigns,\n        loadingCampaigns, setLoadingCampaigns\n    } = useViewLevel();\n\n    const { user } = useAuth();\n    const { hasFullAccess, hasPermission, isTeamManager } = usePermissions(user);\n    const [clients, setClients] = useState([]);\n    const [loading, setLoading] = useState(true);\n\n    const canManageTeam = isTeamManager;\n    const [showAssignModal, setShowAssignModal] = useState(false);\n    const [selectedClientForAssign, setSelectedClientForAssign] = useState(null);\n    // users list replaced by managers/employees endpoints\n    const [managers, setManagers] = useState([]);\n    const [employeesForManager, setEmployeesForManager] = useState({});\n    const [searchTerm, setSearchTerm] = useState(\"\");\n    const [filterStatus, setFilterStatus] = useState(\"all\");\n    const [currentPage, setCurrentPage] = useState(1);\n    const [itemsPerPage] = useState(10);\n    const [assignData, setAssignData] = useState({\n        managerId: \"\",\n        userIds: [],\n    });\n\n    const fetchClients = async () => {\n        try {\n            // Fetch both Mautic and all clients (with assignments)\n            const [mauticRes, clientsRes] = await Promise.all([\n                axios.get(\"/api/mautic/clients\"),\n                axios.get(\"/api/clients\"),\n            ]);\n\n            const mauticClients = (mauticRes.data?.data || []).map((c) => ({\n                ...c,\n                id: c.clientId || c.id,  // keep /api/clients ID for unified display and assignment\n                mauticApiId: c.id,       // store the actual Mautic system ID separately\n                uniqueId: `mautic-${c.clientId || c.id}`,\n                services: [\"mautic\"],\n            }));\n\n\n            const allClients = clientsRes.data || [];\n\n            // Extract dropcowboy clients (existing logic)\n            const dropCowboyClients = allClients\n                .filter((cl) => cl.clientType === \"dropcowboy\")\n                .map((c) => ({\n                    ...c,\n                    // `id` here is already the main Client id\n                    uniqueId: `dropcowboy-${c.id}`,\n                    services: [\"dropcowboy\"],\n                }));\n\n            const assignmentsByName = new Map();\n            const assignmentsByClientId = new Map();\n\n            for (const c of allClients) {\n                const key = c.name?.trim().toLowerCase();\n                if (key) {\n                    const existing = assignmentsByName.get(key) || [];\n                    const newOnes = c.assignments || [];\n\n                    // merge by unique userId\n                    const merged = new Map([\n                        ...existing.map(a => [a.userId || a.user?.id, a]),\n                        ...newOnes.map(a => [a.userId || a.user?.id, a]),\n                    ]);\n\n                    assignmentsByName.set(key, Array.from(merged.values()));\n                }\n\n                // Also index assignments by main client id when available\n                if (c.id) {\n                    assignmentsByClientId.set(c.id, c.assignments || []);\n                }\n            }\n\n            // Attach assignments to Mautic clients if found\n            mauticClients.forEach((client) => {\n                // Prefer assignments linked by main client id (more reliable), fallback to name matching\n                let assignments = null;\n                if (client.clientId) {\n                    assignments = assignmentsByClientId.get(client.clientId);\n                }\n\n                if (!assignments || assignments.length === 0) {\n                    const key = (client.name || '').trim().toLowerCase();\n                    assignments = assignmentsByName.get(key);\n                }\n\n                if (assignments && assignments.length > 0) {\n                    client.assignments = assignments;\n                }\n            });\n\n            // Merge both services by normalized name\n            const mergedMap = new Map();\n\n            [...mauticClients, ...dropCowboyClients].forEach((client) => {\n                const key = client.name.trim().toLowerCase();\n\n                if (!mergedMap.has(key)) {\n                    mergedMap.set(key, {\n                        ...client,\n                    });\n                } else {\n                    const existing = mergedMap.get(key);\n\n                    // Combine unique assignments by userId\n                    const indexAssignments = (arr) =>\n                        (arr || []).map((a) => [a.userId || a.user?.id || a.id, a]);\n\n                    const combinedAssignmentsMap = new Map([\n                        ...indexAssignments(existing.assignments),\n                        ...indexAssignments(client.assignments),\n                    ]);\n\n                    const merged = {\n                        ...existing,\n                        id: existing.id || client.id,\n                        mauticApiId: existing.mauticApiId || client.mauticApiId || null,\n                        mauticUrl: existing.mauticUrl || client.mauticUrl,\n                        isActive: existing.isActive ?? client.isActive ?? true,\n                        services: Array.from(\n                            new Set([...(existing.services || []), ...(client.services || [])])\n                        ),\n                        assignments: Array.from(combinedAssignmentsMap.values()),\n                        hasMautic:\n                            (existing.services || []).includes(\"mautic\") ||\n                            (client.services || []).includes(\"mautic\"),\n                        hasDropcowboy:\n                            (existing.services || []).includes(\"dropcowboy\") ||\n                            (client.services || []).includes(\"dropcowboy\"),\n                    };\n                    mergedMap.set(key, merged);\n                }\n            });\n\n            // 5Ô∏è‚É£ Final combined list\n            let combinedClients = Array.from(mergedMap.values());\n\n            // For non-full-access users, restrict visibility based on permissions\n            if (!hasFullAccess()) {\n                if (canManageTeam()) {\n                    // Team managers can see clients they created or are assigned to\n                    combinedClients = combinedClients.filter((c) => {\n                        const createdByThisUser = c.createdBy?.id === user.id;\n                        const assignedToUser = (c.assignments || []).some(a => (a.user?.id || a.userId) === user.id);\n                        return createdByThisUser || assignedToUser;\n                    });\n                } else {\n                    // Regular users - only assigned clients\n                    combinedClients = combinedClients.filter((c) => (c.assignments || []).some(a => (a.user?.id || a.userId) === user.id));\n                }\n            }\n\n            // Only display clients that have Mautic/automation service\n            combinedClients = combinedClients.filter(c =>\n                (c.services || []).includes('mautic') || c.hasMautic\n            );\n\n            setClients(combinedClients);\n        } catch (error) {\n            console.error(\"Error fetching clients:\", error);\n        } finally {\n            setLoading(false);\n        }\n    };\n\n    useEffect(() => {\n        fetchClients();\n        // Fetch managers if user can manage clients\n        if (canManageTeam()) {\n            fetchManagers();\n        }\n    }, [user]);\n\n    const fetchManagers = async () => {\n        try {\n            const response = await axios.get(\"/api/clients/assignment/managers\");\n            setManagers(response.data.managers || response.data || []);\n        } catch (error) {\n            console.error(\"Error fetching managers:\", error);\n        }\n    };\n\n    const fetchEmployeesForManager = async (managerId) => {\n        if (!managerId) return [];\n        try {\n            const response = await axios.get(\n                `/api/clients/assignment/managers/${managerId}/employees`\n            );\n            const employees = response.data.employees || [];\n            setEmployeesForManager((prev) => ({ ...prev, [managerId]: employees }));\n            return employees;\n        } catch (error) {\n            console.error(\"Error fetching employees for manager:\", error);\n            return [];\n        }\n    };\n\n    const fetchAllEmployees = async () => {\n        // For superadmin: fetch all employees (and managers) list\n        try {\n            const response = await axios.get(`/api/superadmin/employees`);\n            const employees = (response.data?.data || []).map((e) => ({\n                id: e.id,\n                name: e.name,\n                email: e.email,\n                role: e.role,\n            }));\n            setEmployeesForManager((prev) => ({ ...prev, all: employees }));\n            return employees;\n        } catch (err) {\n            console.error(\"Error fetching all employees:\", err);\n            return [];\n        }\n    };\n\n    const openServiceSelection = (client) => {\n        setSelectedClient(client);\n        setView(\"services\");\n    };\n\n    const openMauticCampaigns = async () => {\n        setView(\"campaigns\");\n        setLoadingCampaigns(true);\n\n        try {\n            const mauticApiId = selectedClient.mauticApiId; // ‚úÖ use this, not selectedClient.id\n            if (!mauticApiId) {\n                console.warn(\"No Mautic API ID found for this client\");\n                setLoadingCampaigns(false);\n                return;\n            }\n            const baseUrl = import.meta.env.VITE_API_URL || \"\";\n            const [campaignsRes, segmentsRes, emailsRes] = await Promise.all([\n                axios.get(`${baseUrl}/api/mautic/clients/${mauticApiId}/campaigns`),\n                axios.get(`${baseUrl}/api/mautic/clients/${mauticApiId}/segments`),\n                axios.get(`${baseUrl}/api/mautic/clients/${mauticApiId}/emails`),\n            ]);\n\n            const segmentsData = segmentsRes.data.data;\n            const emailsData = emailsRes.data.data;\n\n            const campaignsWithDetails = campaignsRes.data.data.map((c) => {\n                const campaignEmails = emailsData.filter((e) =>\n                    e.name.toLowerCase().includes(c.name.toLowerCase().split(\":\")[0])\n                );\n                return { ...c, emails: campaignEmails, segments: segmentsData };\n            });\n\n            setCampaigns(campaignsWithDetails);\n        } catch (error) {\n            console.error(\"Error fetching campaigns:\", error);\n        } finally {\n            setLoadingCampaigns(false);\n        }\n    };\n\n    const openDropcowboyCampaigns = () => {\n        setView(\"dropcowboy\");\n    };\n\n    const openCampaignDetails = (campaign) => {\n        setSelectedCampaign(campaign);\n        setView(\"details\");\n    };\n\n    const goBackToClients = () => {\n        setView(\"clients\");\n        setSelectedClient(null);\n        setSelectedService(null);\n        setSelectedCampaign(null);\n    };\n\n    const goBackToServices = () => {\n        setView(\"services\");\n        setSelectedCampaign(null);\n    };\n\n    const goBackToCampaigns = () => {\n        setView(\"campaigns\");\n        setSelectedCampaign(null);\n    };\n\n    const handleAssign = async (e) => {\n        e.preventDefault();\n        try {\n            // Manager optional; employees can be multiple\n            const mgrId = assignData.managerId ? parseInt(assignData.managerId) : null;\n            const userIds = assignData.userIds || [];\n\n            if (!mgrId && userIds.length === 0) {\n                throw new Error('Please select at least a manager or an employee');\n            }\n\n            // Assign manager first (if provided)\n            if (mgrId) {\n                try {\n                    await axios.post(`/api/clients/${selectedClientForAssign.id}/assign`, { userId: mgrId });\n                } catch (mgrErr) {\n                    console.warn('Manager assign warning:', mgrErr?.response?.data || mgrErr.message);\n                }\n            }\n\n            // Assign all selected employees\n            for (const uid of userIds) {\n                try {\n                    await axios.post(`/api/clients/${selectedClientForAssign.id}/assign`, { userId: uid });\n                } catch (uErr) {\n                    console.warn('Employee assign warning:', uErr?.response?.data || uErr.message);\n                }\n            }\n\n            setShowAssignModal(false);\n            setAssignData({ managerId: \"\", userIds: [] });\n            setSelectedClientForAssign(null);\n            fetchClients();\n        } catch (error) {\n            console.error(\"Error assigning client:\", error);\n            alert(error.response?.data?.message || \"Error assigning client\");\n        }\n    };\n\n    const handleUnassign = async (clientId, userId, assignmentClientId = null) => {\n        if (!window.confirm('Unassign this user from the client?')) return;\n        try {\n            const clientToUse = assignmentClientId || clientId;\n            await axios.delete(`/api/clients/${clientToUse}/assign/${userId}`);\n            fetchClients();\n        } catch (err) {\n            console.error('Error unassigning user:', err);\n            alert(err.response?.data?.message || 'Failed to unassign user');\n        }\n    };\n\n    const openAssignModal = (client) => {\n        setSelectedClientForAssign(client);\n        const initialData = { managerId: \"\", userIds: [] };\n        // If user is a team manager but not full access, pre-select themselves\n        if (canManageTeam() && !hasFullAccess()) {\n            initialData.managerId = user.id.toString();\n        }\n        setAssignData(initialData);\n        // Preload employees if manager is pre-selected\n        if (initialData.managerId) {\n            fetchEmployeesForManager(parseInt(initialData.managerId));\n        }\n        setShowAssignModal(true);\n    };\n\n    const getManagers = () => {\n        const assignedUserIds =\n            selectedClientForAssign?.assignments?.map((a) => a.userId) || [];\n        // Non-full access team managers only see themselves\n        if (canManageTeam() && !hasFullAccess()) {\n            return managers.filter((m) => m.id === user.id && !assignedUserIds.includes(m.id));\n        }\n        return managers.filter((m) => !assignedUserIds.includes(m.id));\n    };\n\n    const getEmployeesUnderManager = (managerId) => {\n        if (!managerId) return [];\n        const assignedUserIds =\n            selectedClientForAssign?.assignments?.map((a) => a.userId) || [];\n        const cached = employeesForManager[managerId];\n        if (cached) {\n            return cached.filter((emp) => !assignedUserIds.includes(emp.id));\n        }\n        // Trigger async fetch and return empty until data arrives\n        fetchEmployeesForManager(parseInt(managerId));\n        return [];\n    };\n\n    const getEmployeesForSuperadminOrAdmin = () => {\n        const assignedUserIds =\n            selectedClientForAssign?.assignments?.map((a) => a.userId) || [];\n        const cached = employeesForManager['all'];\n        if (cached) return cached.filter((emp) => !assignedUserIds.includes(emp.id));\n        fetchAllEmployees();\n        return [];\n    };\n\n    const getFilteredClients = () => {\n        let filtered = clients;\n        if (searchTerm) {\n            filtered = filtered.filter((client) =>\n                client.name.toLowerCase().includes(searchTerm.toLowerCase())\n            );\n        }\n        if (filterStatus !== \"all\") {\n            filtered = filtered.filter((client) =>\n                filterStatus === \"active\" ? client.isActive : !client.isActive\n            );\n        }\n        return filtered;\n    };\n\n    const filteredClients = getFilteredClients();\n    const totalPages = Math.ceil(filteredClients.length / itemsPerPage);\n    const startIndex = (currentPage - 1) * itemsPerPage;\n    const endIndex = startIndex + itemsPerPage;\n    const currentClients = filteredClients.slice(startIndex, endIndex);\n\n    // Users who can assign clients are those with Clients.Update permission or team management\n    const canAssignClients = hasPermission('Clients', 'Update') || canManageTeam();\n\n    if (loading) {\n        return (\n            <div className=\"flex justify-center items-center h-64\">Loading...</div>\n        );\n    }\n\n    return (\n        <div className=\"container mx-auto px-4 pb-8 transition-all duration-300\">\n            {/* VIEW 1: CLIENTS LIST */}\n            {view === \"clients\" && (\n                <div className=\"animate-fade-in\">\n                    <div className=\"mb-8\">\n                        <h1 className=\"text-3xl font-bold text-gray-900\">Clients</h1>\n                        <p className=\"text-gray-500 mt-2 text-sm\">\n                            View and manage client assignments\n                        </p>\n                    </div>\n\n                    {/* Stats */}\n                    <div className=\"grid grid-cols-1 sm:grid-cols-3 gap-4 mb-6\">\n                        <div className=\"bg-white rounded-lg border border-gray-200 p-4\">\n                            <div className=\"text-sm text-gray-600\">Total Clients</div>\n                            <div className=\"text-2xl font-bold text-gray-900 mt-1\">\n                                {filteredClients.length}\n                            </div>\n                        </div>\n                        <div className=\"bg-white rounded-lg border border-gray-200 p-4\">\n                            <div className=\"text-sm text-gray-600\">Active</div>\n                            <div className=\"text-2xl font-bold text-green-600 mt-1\">\n                                {filteredClients.filter((c) => c.isActive).length}\n                            </div>\n                        </div>\n                        <div className=\"bg-white rounded-lg border border-gray-200 p-4\">\n                            <div className=\"text-sm text-gray-600\">Inactive</div>\n                            <div className=\"text-2xl font-bold text-gray-400 mt-1\">\n                                {filteredClients.filter((c) => !c.isActive).length}\n                            </div>\n                        </div>\n                    </div>\n\n                    {/* Filters */}\n                    <div className=\"bg-white rounded-lg shadow-md p-4 mb-6\">\n                        <div className=\"grid grid-cols-1 md:grid-cols-3 gap-4\">\n                            <div className=\"md:col-span-2\">\n                                <label className=\"block text-sm font-medium text-gray-700 mb-2\">\n                                    Search\n                                </label>\n                                <input\n                                    type=\"text\"\n                                    placeholder=\"Search by name...\"\n                                    value={searchTerm}\n                                    onChange={(e) => {\n                                        setSearchTerm(e.target.value);\n                                        setCurrentPage(1);\n                                    }}\n                                    className=\"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500\"\n                                />\n                            </div>\n                            <div>\n                                <label className=\"block text-sm font-medium text-gray-700 mb-2\">\n                                    Status\n                                </label>\n                                <select\n                                    value={filterStatus}\n                                    onChange={(e) => {\n                                        setFilterStatus(e.target.value);\n                                        setCurrentPage(1);\n                                    }}\n                                    className=\"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500\"\n                                >\n                                    <option value=\"all\">All Clients</option>\n                                    <option value=\"active\">Active Only</option>\n                                    <option value=\"inactive\">Inactive Only</option>\n                                </select>\n                            </div>\n                        </div>\n                    </div>\n\n                    {/* Clients Table */}\n                    <div className=\"overflow-x-auto\">\n                        <table className=\"min-w-full divide-y divide-gray-200\">\n                            <thead className=\"bg-gray-50\">\n                                <tr>\n                                    <th className=\"px-4 py-3 text-left text-sm font-semibold text-gray-700\">\n                                        Client\n                                    </th>\n                                    <th className=\"px-4 py-3 text-left text-sm font-semibold text-gray-700\">\n                                        Assigned\n                                    </th>\n                                    <th className=\"px-4 py-3 text-center text-sm font-semibold text-gray-700\">\n                                        Status\n                                    </th>\n                                    <th className=\"px-4 py-3 text-center text-sm font-semibold text-gray-700\">\n                                        Actions\n                                    </th>\n                                </tr>\n                            </thead>\n                            <tbody className=\"bg-white divide-y divide-gray-200\">\n                                {currentClients.map((client) => (\n                                    <tr\n                                        key={client.uniqueId}\n                                        onClick={() => openServiceSelection(client)}\n                                        className=\"hover:bg-gray-50 cursor-pointer transition-colors\"\n                                    >\n                                        {/* Client Name + Avatar */}\n                                        <td className=\"px-4 py-3 flex items-center gap-3\">\n                                            <div className=\"h-10 w-10 bg-blue-100 rounded-full flex items-center justify-center\">\n                                                <span className=\"text-blue-600 font-semibold\">\n                                                    {client.name.charAt(0).toUpperCase()}\n                                                </span>\n                                            </div>\n                                            <span className=\"text-gray-900 font-medium\">\n                                                {client.name}\n                                            </span>\n                                        </td>\n\n                                        {/* Assigned */}\n                                        <td className=\"px-4 py-3 text-gray-600 text-sm\">\n                                            {client.assignments && client.assignments.length > 0 ? (\n                                                <div className=\"flex flex-col gap-1\">\n                                                    {client.assignments\n                                                        .slice()\n                                                        .sort((x, y) => {\n                                                            // Sort by isTeamManager: managers first, then employees\n                                                            const isManagerX = x.user?.customRole?.fullAccess || x.user?.customRole?.isTeamManager || ['superadmin', 'admin', 'manager'].includes(x.user?.role);\n                                                            const isManagerY = y.user?.customRole?.fullAccess || y.user?.customRole?.isTeamManager || ['superadmin', 'admin', 'manager'].includes(y.user?.role);\n                                                            return (isManagerX === isManagerY) ? 0 : isManagerX ? -1 : 1;\n                                                        })\n                                                        .map((a) => {\n                                                            // Check if user is a team manager using customRole.isTeamManager or fullAccess\n                                                            const isManager = a.user?.customRole?.fullAccess || a.user?.customRole?.isTeamManager || ['superadmin', 'admin', 'manager'].includes(a.user?.role);\n                                                            const badgeClass = isManager\n                                                                ? 'bg-purple-100 text-purple-800 border border-purple-200'\n                                                                : 'bg-green-100 text-green-800 border border-green-200';\n                                                            const roleLabel = isManager ? 'Manager' : 'Employee';\n                                                            return (\n                                                                <div key={a.id || a.user?.id} className=\"flex items-center gap-2\" onClick={(e) => e.stopPropagation()}>\n                                                                    <span className={`inline-flex items-center gap-2 px-2 py-1 rounded-md text-sm ${badgeClass}`}>\n                                                                        <span className=\"font-medium\">\n                                                                            {a.user?.name || a.userName || \"Unknown\"}\n                                                                        </span>\n                                                                        <span className=\"text-xs px-1.5 py-0.5 rounded bg-opacity-50\">\n                                                                            {roleLabel}\n                                                                        </span>\n                                                                    </span>\n                                                                    {canAssignClients && !(user?.role === 'manager' && (a.user?.id || a.userId) === user.id) && (\n                                                                        <button\n                                                                            onClick={(e) => {\n                                                                                e.stopPropagation();\n                                                                                // Use the assignment's own clientId (if available) when unassigning,\n                                                                                // otherwise fall back to the merged client id\n                                                                                handleUnassign(client.id, a.userId, a.clientId);\n                                                                            }}\n                                                                            title=\"Unassign\"\n                                                                            className=\"text-red-500 hover:text-red-700 px-1\"\n                                                                        >\n                                                                            √ó\n                                                                        </button>\n                                                                    )}\n                                                                </div>\n                                                            );\n                                                        })}\n                                                </div>\n                                            ) : (\n                                                \"-\"\n                                            )}\n                                        </td>\n\n                                        {/* Status */}\n                                        <td className=\"px-4 py-3 text-center\">\n                                            <span className=\"flex items-center justify-center gap-2\">\n                                                <span\n                                                    className={`w-3 h-3 rounded-full ${client.isActive ? \"bg-green-500\" : \"bg-gray-400\"\n                                                        }`}\n                                                ></span>\n\n                                                <span className=\"text-sm font-medium\">\n                                                    {client.isActive ? \"Active\" : \"Inactive\"}\n                                                </span>\n                                            </span>\n                                        </td>\n\n                                        {/* Actions */}\n                                        <td className=\"px-4 py-3 flex justify-center gap-2\">\n                                            {canAssignClients && (\n                                                <button\n                                                    onClick={(e) => {\n                                                        e.stopPropagation();\n                                                        openAssignModal(client);\n                                                    }}\n                                                    className=\"px-3 py-1 bg-green-50 text-green-600 rounded-lg hover:bg-green-100\"\n                                                >\n                                                    <svg\n                                                        className=\"w-5 h-5\"\n                                                        fill=\"none\"\n                                                        stroke=\"currentColor\"\n                                                        viewBox=\"0 0 24 24\"\n                                                    >\n                                                        <path\n                                                            strokeLinecap=\"round\"\n                                                            strokeLinejoin=\"round\"\n                                                            strokeWidth=\"2\"\n                                                            d=\"M18 9v3m0 0v3m0-3h3m-3 0h-3m-2-5a4 4 0 11-8 0 4 4 0 018 0zM3 20a6 6 0 0112 0v1H3v-1z\"\n                                                        />\n                                                    </svg>\n                                                </button>\n                                            )}\n                                        </td>\n                                    </tr>\n                                ))}\n                            </tbody>\n                        </table>\n                    </div>\n\n                    {/* Pagination */}\n                    {totalPages > 1 && (\n                        <div className=\"mt-6 flex justify-center gap-2\">\n                            <button\n                                onClick={() => setCurrentPage((prev) => Math.max(prev - 1, 1))}\n                                disabled={currentPage === 1}\n                                className=\"px-4 py-2 border rounded-lg hover:bg-gray-50 disabled:opacity-50\"\n                            >\n                                Previous\n                            </button>\n                            {[...Array(totalPages)].map((_, idx) => (\n                                <button\n                                    key={idx + 1}\n                                    onClick={() => setCurrentPage(idx + 1)}\n                                    className={`px-4 py-2 rounded-lg ${currentPage === idx + 1\n                                        ? \"bg-blue-600 text-white\"\n                                        : \"border hover:bg-gray-50\"\n                                        }`}\n                                >\n                                    {idx + 1}\n                                </button>\n                            ))}\n                            <button\n                                onClick={() =>\n                                    setCurrentPage((prev) => Math.min(prev + 1, totalPages))\n                                }\n                                disabled={currentPage === totalPages}\n                                className=\"px-4 py-2 border rounded-lg hover:bg-gray-50 disabled:opacity-50\"\n                            >\n                                Next\n                            </button>\n                        </div>\n                    )}\n                </div>\n            )}\n\n            {/* VIEW 2: SERVICE SELECTION (TABLE/ROW STYLE) */}\n            {view === 'services' && selectedClient && (\n                <ClientServicesSection\n                    selectedClient={selectedClient}\n                    goBackToClients={goBackToClients}\n                    openMauticCampaigns={openMauticCampaigns}\n                    openDropcowboyCampaigns={openDropcowboyCampaigns}\n                />\n            )}\n\n            {/* VIEW 3: MAUTIC CAMPAIGNS LIST */}\n            {view === 'campaigns' && selectedClient && (\n                <MauticCampaignsSection\n                    campaigns={campaigns}\n                    selectedClient={selectedClient}\n                    loadingCampaigns={loadingCampaigns}\n                    goBackToServices={goBackToServices}\n                    openCampaignDetails={openCampaignDetails}\n                />\n            )}\n\n            {/* VIEW 4: CAMPAIGN DETAILS */}\n            {view === 'details' && selectedClient && selectedCampaign && (\n                <MauticEmailsSection\n                    campaigns={campaigns}\n                    selectedCampaign={selectedCampaign}\n                    setSelectedCampaign={setSelectedCampaign}\n                    goBackToCampaigns={goBackToCampaigns}\n                />\n            )}\n\n            {/* VIEW 5: DROPCOWBOY CAMPAIGNS LIST */}\n            {view === \"dropcowboy\" && selectedClient && (\n                <div className=\"animate-fade-in\">\n                    <button\n                        onClick={goBackToServices}\n                        className=\"flex items-center gap-2 text-gray-600 hover:text-gray-900 mb-6\"\n                    >\n                        <ArrowLeft className=\"w-5 h-5\" />\n                        <span className=\"font-medium\">Back to {selectedClient.name} Services</span>\n                    </button>\n\n                    <h2 className=\"text-xl font-semibold mb-4\">\n                        {selectedClient.name} ‚Äî Ringless Voicemail Dashboard\n                    </h2>\n\n                    <ClientsDropCowboyDashboard clientName={selectedClient.name} />\n                </div>\n            )}\n\n            {/* Assign Modal */}\n            {showAssignModal && (\n                <div className=\"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4 z-50\">\n                    <div className=\"bg-white rounded-lg max-w-md w-full p-6\">\n                        <h2 className=\"text-2xl font-bold mb-4\">Assign Client</h2>\n                        <p className=\"text-gray-600 mb-4\">\n                            Assign <strong>{selectedClientForAssign?.name}</strong> to:\n                        </p>\n                        <form onSubmit={handleAssign} className=\"space-y-4\">\n                            {([\"superadmin\", \"admin\", \"manager\"].includes(user?.role)) && (\n                                <div>\n                                    <label className=\"block text-sm font-medium text-gray-700 mb-1\">\n                                        Manager\n                                    </label>\n                                    {assignData.managerId ? (\n                                        <div className=\"flex items-center gap-2 mb-2\">\n                                            <span className=\"inline-flex items-center gap-2 bg-purple-100 text-purple-800 px-3 py-2 rounded-lg border border-purple-200\">\n                                                <span className=\"text-xs font-semibold bg-purple-600 text-white px-1.5 py-0.5 rounded\">Manager</span>\n                                                <span className=\"font-medium\">\n                                                    {managers.find(m => m.id === parseInt(assignData.managerId))?.name || 'Selected'}\n                                                </span>\n                                                <button \n                                                    type=\"button\" \n                                                    onClick={() => setAssignData({ ...assignData, managerId: \"\" })} \n                                                    className=\"text-purple-600 hover:text-purple-800 ml-1\"\n                                                >\n                                                    ‚úï\n                                                </button>\n                                            </span>\n                                        </div>\n                                    ) : (\n                                        <select\n                                            value={assignData.managerId}\n                                            onChange={(e) => {\n                                                const mid = e.target.value;\n                                                setAssignData({ ...assignData, managerId: mid });\n                                                if (mid) fetchEmployeesForManager(parseInt(mid));\n                                            }}\n                                            className=\"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500\"\n                                        >\n                                            <option value=\"\">(Optional) Select Manager</option>\n                                            {getManagers().map((manager) => (\n                                                <option key={manager.id} value={manager.id}>\n                                                    {manager.name} ({manager.email})\n                                                </option>\n                                            ))}\n                                        </select>\n                                    )}\n                                </div>\n                            )}\n\n                            {(assignData.managerId || user?.role === 'superadmin' || user?.role === 'admin') && (\n                                <div>\n                                    <label className=\"block text-sm font-medium text-gray-700 mb-1\">\n                                        Employee(s)\n                                    </label>\n                                    {/* Selected employees as chips */}\n                                    <div className=\"flex flex-wrap gap-2 mb-2\">\n                                        {(assignData.userIds || []).map((uid) => {\n                                            const allCandidates = (assignData.managerId\n                                                ? employeesForManager[assignData.managerId] || []\n                                                : employeesForManager['all'] || []);\n                                            const emp = allCandidates.find((e) => e.id === uid) || { id: uid, name: `User ${uid}` };\n                                            return (\n                                                <span key={uid} className=\"inline-flex items-center gap-2 bg-blue-50 text-blue-800 px-3 py-2 rounded-lg border border-blue-200\">\n                                                    <span className=\"text-xs font-semibold bg-blue-600 text-white px-1.5 py-0.5 rounded\">Employee</span>\n                                                    <span className=\"font-medium\">{emp.name}</span>\n                                                    <button type=\"button\" onClick={() => setAssignData({ ...assignData, userIds: assignData.userIds.filter(i => i !== uid) })} className=\"text-blue-600 hover:text-blue-800 ml-1\">‚úï</button>\n                                                </span>\n                                            );\n                                        })}\n                                    </div>\n                                    <select\n                                        defaultValue=\"\"\n                                        onChange={(e) => {\n                                            const val = e.target.value ? parseInt(e.target.value, 10) : null;\n                                            if (!val) return;\n                                            if (!assignData.userIds.includes(val)) {\n                                                setAssignData({ ...assignData, userIds: [...assignData.userIds, val] });\n                                            }\n                                            // reset selection\n                                            e.target.value = '';\n                                        }}\n                                        className=\"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500\"\n                                    >\n                                        <option value=\"\">Add employee...</option>\n                                        {(assignData.managerId\n                                            ? getEmployeesUnderManager(assignData.managerId)\n                                            : getEmployeesForSuperadminOrAdmin()\n                                        ).map((emp) => (\n                                            <option key={emp.id} value={emp.id}>\n                                                {emp.name} ({emp.email})\n                                            </option>\n                                        ))}\n                                    </select>\n                                </div>\n                            )}\n                            <div className=\"flex justify-end gap-2 pt-4\">\n                                <button\n                                    type=\"button\"\n                                    onClick={() => {\n                                        setShowAssignModal(false);\n                                        setSelectedClientForAssign(null);\n                                        setAssignData({ managerId: \"\", userIds: [] });\n                                    }}\n                                    className=\"px-4 py-2 border rounded-lg hover:bg-gray-50\"\n                                >\n                                    Cancel\n                                </button>\n                                <button\n                                    type=\"submit\"\n                                    disabled={!(assignData.userIds?.length > 0 || assignData.managerId)}\n                                    className=\"px-4 py-2 bg-green-500 text-white rounded-lg hover:bg-green-600 disabled:opacity-50\"\n                                >\n                                    Assign\n                                </button>\n                            </div>\n                        </form>\n                    </div>\n                </div>\n            )}\n        </div>\n    );\n};\n\nexport default Clients;"],"names":["__iconNode","CircleArrowLeft","createLucideIcon","CircleArrowRight","DollarSign","PhoneOff","ShieldQuestionMark","MetricCard","title","value","subtitle","Icon","color","clickable","onClick","colors","jsx","jsxs","MetricsCards","metrics","onMetricClick","viewLevel","user","useAuth","showCostForSuperadmin","_","i","overall","successRate","failureRate","otherRate","TrendingUp","CheckCircle","XCircle","ShieldQuestion","ClientsTable","serverRecords","setServerRecords","useState","totalRecords","setTotalRecords","loadingPage","setLoadingPage","dropcowboy","setDCViewLevel","setDCSelectedClient","setDCSelectedCampaign","useViewLevel","selectedClient","selectedCampaign","campaigns","groupBy","arr","keyFn","acc","item","key","tableContainerRef","useRef","scrollRatioRef","maintainScrollRef","fadeIn","setFadeIn","statusFilter","setStatusFilter","dateFilters","setDateFilters","appliedDateFilters","setAppliedDateFilters","fetchLoading","setFetchLoading","fetchMessage","setFetchMessage","allRecords","setAllRecords","currentPage","setCurrentPage","recordsPerPage","paginatedRecords","setPaginatedRecords","totalPages","setTotalPages","SkeletonRow","compact","useEffect","records","c","clientName","campaign","record","filtered","r","offset","container","t","maxAfter","currentRecords","getStatusBadge","status","statusLower","gotoPageInput","setGotoPageInput","gotoInvalid","setGotoInvalid","handleGoto","n","page","filteredRecordsForMetrics","useMemo","recordDate","filteredRecordsForTable","totalSent","successfulDeliveries","failedSends","otherStatus","campaignRecords","startIndex","endIndex","err","Loader2","e","prev","Fragment","clientGroups","client","total","success","failed","other","campaignGroups","totalFilteredPages","safePage","ClientsDropCowboyDashboard","clientCampaigns","clientFilter","setClientFilter","clientOptions","setClientOptions","initialFilters","error","refetchMetrics","useMetrics","syncLogs","refetchSyncLogs","useSyncLogs","triggerFetch","isFetching","fetchError","useManualFetch","setDCCampaigns","setDCMetrics","savedMetrics","clients","extractUniqueClients","filteredCampaigns","interval","handleFetchNow","toast","result","ErrorBoundary","AlertCircle","format","parseISO","RefreshCw","Activity","MauticEmailsSection","setSelectedCampaign","goBackToCampaigns","draftFromDate","setDraftFromDate","draftToDate","setDraftToDate","appliedFromDate","setAppliedFromDate","appliedToDate","setAppliedToDate","emailReports","setEmailReports","loadingReports","setLoadingReports","emailReportsIndex","setEmailReportsIndex","fromDateRef","toDateRef","reportsForEmailByFieldInRange","emailId","field","email","entry","count","openPicker","ref","params","reports","axios","isAggregated","reportIndex","initialLoadDone","setInitialLoadDone","getCampaignStats","aggregateCountsFromReportsForEmail","sent","read","campaignSent","campaignRead","readPercentage","sum","campaignStats","getEmailStats","readRate","navigateCampaign","direction","currentIndex","filteredSegments","seg","segDate","from","to","ArrowLeftCircle","ArrowRightCircle","Calendar","Users","Mail","Eye","index","stats","MauticCampaignsSection","loadingCampaigns","goBackToServices","openCampaignDetails","getAllCampaignsEmailsSent","a","getCampaignEmailsSent","getUniqueEmailsCount","uniqueEmailIds","ArrowLeft","BarChart3","DropCowboyServiceStats","segment","metricsStats","MauticServiceStats","cards","formatNumber","Send","List","card","ClientServicesSection","goBackToClients","openMauticCampaigns","openDropcowboyCampaigns","selectedService","setSelectedService","Clients","view","setView","setSelectedClient","setCampaigns","setLoadingCampaigns","hasFullAccess","hasPermission","isTeamManager","usePermissions","setClients","loading","setLoading","canManageTeam","showAssignModal","setShowAssignModal","selectedClientForAssign","setSelectedClientForAssign","managers","setManagers","employeesForManager","setEmployeesForManager","searchTerm","setSearchTerm","filterStatus","setFilterStatus","itemsPerPage","assignData","setAssignData","fetchClients","mauticRes","clientsRes","mauticClients","allClients","dropCowboyClients","cl","assignmentsByName","assignmentsByClientId","existing","newOnes","merged","assignments","mergedMap","indexAssignments","combinedAssignmentsMap","combinedClients","createdByThisUser","assignedToUser","fetchManagers","response","fetchEmployeesForManager","managerId","employees","fetchAllEmployees","openServiceSelection","mauticApiId","baseUrl","campaignsRes","segmentsRes","emailsRes","segmentsData","emailsData","campaignsWithDetails","campaignEmails","handleAssign","mgrId","userIds","mgrErr","uid","uErr","handleUnassign","clientId","userId","assignmentClientId","clientToUse","openAssignModal","initialData","getManagers","assignedUserIds","m","getEmployeesUnderManager","cached","emp","getEmployeesForSuperadminOrAdmin","filteredClients","currentClients","canAssignClients","x","y","isManagerX","isManagerY","isManager","badgeClass","roleLabel","idx","mid","manager","val"],"mappings":"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","x_google_ignoreList":[0,1,2,3,4]}