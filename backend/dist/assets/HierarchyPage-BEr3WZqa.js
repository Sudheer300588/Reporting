import{B as t,ah as E,ai as L,aj as h,ak as e,aW as S,an as P}from"./index-CPERY6Kl.js";import{u as z}from"./useViewLevel-Cd5zze0o.js";import{F as O}from"./folder-open-DzDBH55X.js";function Y({onBack:p,onEmployees:x,onClients:m}){const[c,v]=t.useState(null),[y,o]=t.useState(!0),{user:r}=E(),u=L(),{employeesStates:i}=z(),{managerId:j}=i;return t.useEffect(()=>{if(r){if(!["manager","superadmin"].includes(r.role)){u("/dashboard");return}h.get(`/api/users/${j}`).then(l=>{v(l.data.user||l.data)}).catch(l=>console.error("Error fetching manager:",l)).finally(()=>o(!1))}},[j]),y?e.jsx("div",{className:"p-6",children:e.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-primary-600 mx-auto"})}):e.jsxs("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-6",children:[e.jsxs("button",{onClick:p,className:"flex items-center text-primary-600 hover:text-primary-700 mb-4",children:[e.jsx(S,{size:20,className:"mr-2"}),r.role==="superadmin"?"Back to Managers":"Back to Dashboard"]}),e.jsxs("div",{className:"flex items-center gap-3 mb-2",children:[e.jsx("h2",{className:"text-2xl font-bold capitalize",children:c?.name}),c?.role&&e.jsx("span",{className:`px-3 py-1 text-xs font-bold rounded-full tracking-wide
        ${c.role==="admin"?"bg-red-100 text-red-700":c.role==="manager"?"bg-blue-100 text-blue-700":"bg-gray-200 text-gray-700"}`,children:c.role.toUpperCase()})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsx("div",{className:"card cursor-pointer hover:shadow-lg transition-shadow bg-gradient-to-br from-primary-50 to-primary-100 border-primary-200",onClick:x,children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-semibold text-primary-900",children:"View Employees"}),e.jsx("p",{className:"text-sm text-primary-700 mt-1",children:"See team members under this manager"})]}),e.jsx(P,{size:32,className:"text-primary-600"})]})}),e.jsx("div",{className:"card cursor-pointer hover:shadow-lg transition-shadow bg-gradient-to-br from-secondary-50 to-secondary-100 border-secondary-200",onClick:m,children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-semibold text-secondary-900",children:"View Clients"}),e.jsx("p",{className:"text-sm text-secondary-700 mt-1",children:"See clients assigned to this manager"})]}),e.jsx(O,{size:32,className:"text-secondary-600"})]})})]})]})}function q({onBack:p,onEmployeeClick:x}){const[m,c]=t.useState([]),[v,y]=t.useState(null),[o,r]=t.useState(!0),{user:u}=E(),i=L(),{employeesStates:j}=z(),{managerId:l}=j;return t.useEffect(()=>{if(!u)return;const a=async()=>{try{const[d,b]=await Promise.all([h.get("/api/users"),h.get(`/api/users/${l}`)]),N=d.data.users.filter(n=>(n.role==="employee"||n.role==="telecaller")&&n.managers?.some(C=>C.id==l));c(N),y(b.data.user||b.data)}catch(d){console.error("Error fetching data:",d)}finally{r(!1)}};if(u?.role!=="manager"&&u?.role!=="superadmin"){console.warn("Access denied: not a manager or superadmin"),i("/dashboard");return}a()},[l,u]),o?e.jsx("div",{className:"p-6",children:e.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-primary-600 mx-auto"})}):e.jsxs("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-6",children:[e.jsxs("button",{onClick:p,className:"flex items-center text-primary-600 hover:text-primary-700 mb-4",children:[e.jsx(S,{size:20,className:"mr-2"}),"Back to Manager"]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6 mb-6",children:[e.jsx("div",{className:"card bg-gradient-to-br from-primary-50 to-primary-100 border-primary-200",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-primary-600",children:"Total Employees"}),e.jsx("p",{className:"text-3xl font-bold text-primary-900 mt-2",children:m.length})]}),e.jsx("div",{className:"p-3 bg-primary-200 rounded-full",children:e.jsx("svg",{className:"w-8 h-8 text-primary-600",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M17 20h5v-2a3 3 0 00-5.356-1.857M17 20H7m10 0v-2c0-.656-.126-1.283-.356-1.857M7 20H2v-2a3 3 0 015.356-1.857M7 20v-2c0-.656.126-1.283.356-1.857m0 0a5.002 5.002 0 019.288 0M15 7a3 3 0 11-6 0 3 3 0 016 0zm6 3a2 2 0 11-4 0 2 2 0 014 0zM7 10a2 2 0 11-4 0 2 2 0 014 0z"})})})]})}),e.jsx("div",{className:"card bg-gradient-to-br from-blue-50 to-blue-100 border-blue-200",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-blue-600",children:"Employees"}),e.jsx("p",{className:"text-3xl font-bold text-blue-900 mt-2",children:m.filter(a=>a.role==="employee").length})]}),e.jsx("div",{className:"p-3 bg-blue-200 rounded-full",children:e.jsx("svg",{className:"w-8 h-8 text-blue-600",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M16 7a4 4 0 11-8 0 4 4 0 018 0zM12 14a7 7 0 00-7 7h14a7 7 0 00-7-7z"})})})]})}),e.jsx("div",{className:"card bg-gradient-to-br from-indigo-50 to-indigo-100 border-indigo-200",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-indigo-600",children:"Telecallers"}),e.jsx("p",{className:"text-3xl font-bold text-indigo-900 mt-2",children:m.filter(a=>a.role==="telecaller").length})]}),e.jsx("div",{className:"p-3 bg-indigo-200 rounded-full",children:e.jsx("svg",{className:"w-8 h-8 text-indigo-600",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M3 5a2 2 0 012-2h3.28a1 1 0 01.948.684l1.498 4.493a1 1 0 01-.502 1.21l-2.257 1.13a11.042 11.042 0 005.516 5.516l1.13-2.257a1 1 0 011.21-.502l4.493 1.498a1 1 0 01.684.949V19a2 2 0 01-2 2h-1C9.716 21 3 14.284 3 6V5z"})})})]})})]}),e.jsx("div",{className:"card mb-6",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsxs("h2",{className:"text-2xl font-bold capitalize",children:["Employees under ",v?.name]}),e.jsx("p",{className:"text-sm text-gray-600 mt-1",children:v?.email})]}),e.jsxs("div",{className:"text-right",children:[e.jsx("div",{className:"text-3xl font-bold text-primary-600",children:m.length}),e.jsx("div",{className:"text-sm text-gray-500",children:"Total Employees"})]})]})}),m.length===0?e.jsxs("div",{className:"card text-center py-12",children:[e.jsx("div",{className:"text-gray-400 mb-4",children:e.jsx("svg",{className:"mx-auto h-12 w-12",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M17 20h5v-2a3 3 0 00-5.356-1.857M17 20H7m10 0v-2c0-.656-.126-1.283-.356-1.857M7 20H2v-2a3 3 0 015.356-1.857M7 20v-2c0-.656.126-1.283.356-1.857m0 0a5.002 5.002 0 019.288 0M15 7a3 3 0 11-6 0 3 3 0 016 0zm6 3a2 2 0 11-4 0 2 2 0 014 0zM7 10a2 2 0 11-4 0 2 2 0 014 0z"})})}),e.jsx("p",{className:"text-gray-500 text-lg",children:"No employees found under this manager"})]}):e.jsx("div",{className:"card overflow-hidden",children:e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"min-w-full divide-y divide-gray-200",children:[e.jsx("thead",{className:"bg-gray-50",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Name"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Email"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Role"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Status"})]})}),e.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:m.map(a=>e.jsxs("tr",{onClick:()=>x(a.id),className:"hover:bg-gray-50 transition-colors cursor-pointer",children:[e.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:e.jsx("div",{className:"font-semibold text-gray-900 capitalize",children:a.name})}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:e.jsx("div",{className:"text-sm text-gray-600",children:a.email})}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:e.jsx("span",{className:`px-2 py-1 rounded-full text-xs font-medium capitalize ${a.role==="employee"?"bg-blue-100 text-blue-700":"bg-indigo-100 text-indigo-700"}`,children:a.role})}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:e.jsx("span",{className:`px-2 py-1 inline-flex text-xs leading-5 font-semibold rounded-full ${a.isActive?"bg-green-100 text-green-800":"bg-red-100 text-red-800"}`,children:a.isActive?"Active":"Inactive"})})]},a.id))})]})})})]})}function G({onBack:p}){const[x,m]=t.useState([]),[c,v]=t.useState(null),[y,o]=t.useState(!0),{user:r}=E(),u=L(),[i,j]=t.useState(!1),[l,a]=t.useState(null),[d,b]=t.useState({userId:""}),[N,n]=t.useState([]),[C,M]=t.useState(!1),[B,F]=t.useState([]),[I,H]=t.useState(null),{employeesStates:U}=z(),{managerId:f}=U,$=async()=>{try{const[s,g]=await Promise.all([h.get("/api/clients"),h.get(`/api/users/${f}`)]),w=s.data.filter(A=>A.assignments?.some(k=>k.user.id==f&&k.user.role==="manager"));m(w),v(g.data.user||g.data)}catch(s){console.error("Error fetching data:",s)}finally{o(!1)}};t.useEffect(()=>{if(r){if(!["manager","superadmin"].includes(r?.role)){u("/dashboard");return}$(),r?.role==="manager"&&parseInt(f)===r.id&&W(f)}},[f,r]);const W=async s=>{try{const w=(await h.get(`/api/clients/assignment/managers/${s}/employees`)).data.employees||[];return n(w),w}catch(g){return console.error("Error fetching employees for manager:",g),n([]),[]}},R=async()=>{try{const w=((await h.get("/api/clients")).data||[]).filter(A=>!A.assignments?.some(k=>k.user.id==f&&k.user.role==="manager"));F(w)}catch(s){console.error("Error fetching available clients for manager assign:",s),F([])}},D=async s=>{if(s.preventDefault(),!l||!d.userId){alert("Please select an employee to assign");return}try{await h.post(`/api/clients/${l.id}/assign`,{userId:d.userId}),j(!1),a(null);const w=(await h.get("/api/clients")).data.filter(A=>A.assignments?.some(k=>k.user.id==f&&k.user.role==="manager"));m(w)}catch(g){console.error("Error assigning employee:",g),alert(g.response?.data?.message||"Failed to assign employee")}},T=async s=>{try{await h.post(`/api/clients/${s}/assign`,{userId:f}),await $(),await R()}catch(g){console.error("Error assigning manager to client:",g),alert(g.response?.data?.message||"Failed to assign manager")}},V=async s=>{if(confirm("Unassign this manager from the client?"))try{await h.delete(`/api/clients/${s}/assign/${f}`),await $()}catch(g){console.error("Error unassigning manager:",g),alert(g.response?.data?.message||"Failed to unassign manager")}};return y?e.jsx("div",{className:"p-6",children:e.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-primary-600 mx-auto"})}):e.jsxs("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-6",children:[e.jsxs("button",{onClick:p,className:"flex items-center text-primary-600 hover:text-primary-700 mb-4",children:[e.jsx(S,{size:20,className:"mr-2"}),"Back to Manager"]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6 mb-6",children:[e.jsx("div",{className:"card bg-gradient-to-br from-secondary-50 to-secondary-100 border-secondary-200",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-secondary-600",children:"Total Clients"}),e.jsx("p",{className:"text-3xl font-bold text-secondary-900 mt-2",children:x.length})]}),e.jsx("div",{className:"p-3 bg-secondary-200 rounded-full",children:e.jsx("svg",{className:"w-8 h-8 text-secondary-600",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M20 13V6a2 2 0 00-2-2H6a2 2 0 00-2 2v7m16 0v5a2 2 0 01-2 2H6a2 2 0 01-2-2v-5m16 0h-2.586a1 1 0 00-.707.293l-2.414 2.414a1 1 0 01-.707.293h-3.172a1 1 0 01-.707-.293l-2.414-2.414A1 1 0 006.586 13H4"})})})]})}),e.jsx("div",{className:"card bg-gradient-to-br from-green-50 to-green-100 border-green-200",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-green-600",children:"Active Clients"}),e.jsx("p",{className:"text-3xl font-bold text-green-900 mt-2",children:x.filter(s=>s.isActive).length})]}),e.jsx("div",{className:"p-3 bg-green-200 rounded-full",children:e.jsx("svg",{className:"w-8 h-8 text-green-600",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"})})})]})}),e.jsx("div",{className:"card bg-gradient-to-br from-red-50 to-red-100 border-red-200",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-red-600",children:"Inactive Clients"}),e.jsx("p",{className:"text-3xl font-bold text-red-900 mt-2",children:x.filter(s=>!s.isActive).length})]}),e.jsx("div",{className:"p-3 bg-red-200 rounded-full",children:e.jsx("svg",{className:"w-8 h-8 text-red-600",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M18.364 18.364A9 9 0 005.636 5.636m12.728 12.728A9 9 0 015.636 5.636m12.728 12.728L5.636 5.636"})})})]})})]}),e.jsx("div",{className:"card mb-6",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsxs("h2",{className:"text-2xl font-bold",children:["Clients under ",c?.name]}),e.jsx("p",{className:"text-sm text-gray-600 mt-1",children:c?.email})]}),e.jsxs("div",{className:"text-right",children:[e.jsx("div",{className:"text-3xl font-bold text-secondary-600",children:x.length}),e.jsx("div",{className:"text-sm text-gray-500",children:"Total Clients"})]})]})}),r?.role==="superadmin"&&e.jsx("div",{className:"mb-4 flex justify-end",children:e.jsx("button",{onClick:()=>{R(),M(!0)},className:"px-3 py-2 bg-blue-50 text-blue-600 rounded-lg hover:bg-blue-100",children:"Assign Manager to Client"})}),x.length===0?e.jsxs("div",{className:"card text-center py-12",children:[e.jsx("div",{className:"text-gray-400 mb-4",children:e.jsx("svg",{className:"mx-auto h-12 w-12",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M20 13V6a2 2 0 00-2-2H6a2 2 0 00-2 2v7m16 0v5a2 2 0 01-2 2H6a2 2 0 01-2-2v-5m16 0h-2.586a1 1 0 00-.707.293l-2.414 2.414a1 1 0 01-.707.293h-3.172a1 1 0 01-.707-.293l-2.414-2.414A1 1 0 006.586 13H4"})})}),e.jsx("p",{className:"text-gray-500 text-lg",children:"No clients assigned to this manager"})]}):e.jsx("div",{className:"card overflow-hidden",children:e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"min-w-full divide-y divide-gray-200",children:[e.jsx("thead",{className:"bg-gray-50",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Client Name"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Status"}),e.jsx("th",{className:"px-6 py-3 text-right text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Actions"})]})}),e.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:x.map(s=>e.jsxs("tr",{className:"hover:bg-gray-50 transition-colors",children:[e.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:e.jsx("div",{className:"font-semibold text-gray-900",children:s.name})}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:e.jsx("span",{className:`px-2 py-1 inline-flex text-xs leading-5 font-semibold rounded-full ${s.isActive?"bg-green-100 text-green-800":"bg-red-100 text-red-800"}`,children:s.isActive?"Active":"Inactive"})}),e.jsxs("td",{className:"px-6 py-4 whitespace-nowrap text-right",children:[r?.role==="superadmin"&&e.jsx("button",{onClick:()=>V(s.id),className:"px-3 py-1 bg-red-50 text-red-600 rounded-lg hover:bg-red-100",children:"Unassign"}),r?.role==="manager"&&parseInt(f)===r.id&&e.jsx("button",{onClick:()=>{a(s),b({userId:""}),W(f),j(!0)},className:"ml-2 px-3 py-1 bg-green-50 text-green-600 rounded-lg hover:bg-green-100",children:"Assign Employee"})]})]},s.id))})]})})}),i&&e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4 z-50",children:e.jsxs("div",{className:"bg-white rounded-lg max-w-md w-full p-6",children:[e.jsxs("h2",{className:"text-2xl font-bold mb-4",children:["Assign Employee to ",l?.name]}),e.jsxs("form",{onSubmit:D,className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Employee"}),e.jsxs("select",{value:d.userId,onChange:s=>b({userId:s.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500",children:[e.jsx("option",{value:"",children:"Select employee..."}),N.map(s=>e.jsxs("option",{value:s.id,children:[s.name," (",s.email,")"]},s.id))]})]}),e.jsxs("div",{className:"flex justify-end gap-2 pt-4",children:[e.jsx("button",{type:"button",onClick:()=>{j(!1),a(null),b({userId:""})},className:"px-4 py-2 border rounded-lg hover:bg-gray-50",children:"Cancel"}),e.jsx("button",{type:"submit",disabled:!d.userId,className:"px-4 py-2 bg-green-500 text-white rounded-lg hover:bg-green-600 disabled:opacity-50",children:"Assign"})]})]})]})}),C&&e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4 z-50",children:e.jsxs("div",{className:"bg-white rounded-lg max-w-md w-full p-6",children:[e.jsx("h2",{className:"text-2xl font-bold mb-4",children:"Assign Manager to Client"}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Client"}),e.jsxs("select",{value:I||"",onChange:s=>H(s.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500",children:[e.jsx("option",{value:"",children:"Select client..."}),B.map(s=>e.jsxs("option",{value:s.id,children:[s.name," (",s.company||s.email||"No company",")"]},s.id))]})]}),e.jsxs("div",{className:"flex justify-end gap-2 pt-4",children:[e.jsx("button",{type:"button",onClick:()=>{M(!1),H(null)},className:"px-4 py-2 border rounded-lg hover:bg-gray-50",children:"Cancel"}),e.jsx("button",{type:"button",onClick:async()=>{if(!I)return alert("Please select a client");await T(I),M(!1),H(null)},className:"px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 disabled:opacity-50",children:"Assign"})]})]})]})})]})}function J({onBack:p}){const[x,m]=t.useState([]),[c,v]=t.useState(null),[y,o]=t.useState(!0),{user:r}=E(),{employeesStates:u}=z(),{employeeId:i}=u;t.useEffect(()=>{if(!r)return;(async()=>{try{const a=await h.get(`/api/users/${i}/clients`),d=await h.get(`/api/users/${i}`),b=a.data.success?a.data.data:Array.isArray(a.data)?a.data:[],N=d.data.user||d.data;m(Array.isArray(b)?b:[]),v(N)}catch(a){console.error("Error fetching employee clients or details:",a),a.response?.status===403&&console.error("Access denied. You may not have permission to view this employee's clients."),m([])}finally{o(!1)}})()},[i,r]);const j=async l=>{if(confirm("Unassign this client from the employee?"))try{await h.delete(`/api/clients/${l}/assign/${i}`);const a=await h.get(`/api/users/${i}/clients`),d=a.data.success?a.data.data:Array.isArray(a.data)?a.data:[];m(d||[])}catch(a){console.error("Error unassigning client from employee:",a),alert(a.response?.data?.message||"Failed to unassign client")}};return y?e.jsx("div",{className:"p-6",children:e.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-primary-600 mx-auto"})}):e.jsxs("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-6",children:[e.jsxs("button",{onClick:p,className:"flex items-center text-primary-600 hover:text-primary-700 mb-4",children:[e.jsx(S,{size:20,className:"mr-2"}),r.role==="superadmin"||r.role==="manager"?"Back to Employees":"Back to Dashboard"]}),e.jsx("div",{className:"card mb-6",children:e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsxs("div",{children:[e.jsx("h2",{className:"text-2xl font-bold capitalize",children:c?`${c.name}'s Clients`:"Employee's Clients"}),c?.managers&&c.managers.length>0&&e.jsxs("div",{className:"text-sm text-gray-500",children:["Manager: ",e.jsx("strong",{children:c.managers[0].name})]}),c&&e.jsxs("div",{className:"mt-2 flex items-center gap-4 text-sm text-gray-600",children:[e.jsx("span",{children:c.email}),e.jsx("span",{className:"px-2 py-1 bg-primary-100 text-primary-700 rounded-full text-xs font-medium capitalize",children:c.role})]})]}),e.jsxs("div",{className:"text-right",children:[e.jsx("div",{className:"text-3xl font-bold text-primary-600",children:x.length}),e.jsx("div",{className:"text-sm text-gray-500",children:"Total Clients"})]})]})}),x.length===0?e.jsxs("div",{className:"card text-center py-12",children:[e.jsx("div",{className:"text-gray-400 mb-4",children:e.jsx("svg",{className:"mx-auto h-12 w-12",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M20 13V6a2 2 0 00-2-2H6a2 2 0 00-2 2v7m16 0v5a2 2 0 01-2 2H6a2 2 0 01-2-2v-5m16 0h-2.586a1 1 0 00-.707.293l-2.414 2.414a1 1 0 01-.707.293h-3.172a1 1 0 01-.707-.293l-2.414-2.414A1 1 0 006.586 13H4"})})}),e.jsx("p",{className:"text-gray-500 text-lg",children:"No clients assigned to this employee"})]}):e.jsx("div",{className:"card overflow-hidden",children:e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"min-w-full divide-y divide-gray-200",children:[e.jsx("thead",{className:"bg-gray-50",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Client Name"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Status"}),e.jsx("th",{className:"px-6 py-3 text-right text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Actions"})]})}),e.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:x.map(l=>e.jsxs("tr",{className:"hover:bg-gray-50 transition-colors",children:[e.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:e.jsx("div",{className:"font-semibold text-gray-900",children:l.name})}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:e.jsx("span",{className:`px-2 py-1 inline-flex text-xs leading-5 font-semibold rounded-full ${l.isActive?"bg-green-100 text-green-800":"bg-red-100 text-red-800"}`,children:l.isActive?"Active":"Inactive"})}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-right",children:(r?.role==="superadmin"||r?.role==="manager")&&e.jsx("button",{onClick:()=>j(l.id),className:"px-3 py-1 bg-red-50 text-red-600 rounded-lg hover:bg-red-100",children:"Unassign"})})]},l.id))})]})})})]})}function Z(){const[p,x]=t.useState([]),[m,c]=t.useState([]),[v,y]=t.useState(!0),{user:o}=E(),r=L(),{employeesStates:u,setEmpView:i,setCurrentRoute:j,setActiveManagerId:l,setActiveEmployeeId:a}=z(),{view:d,currentRoute:b}=u;t.useEffect(()=>{if(d==="list"){if(o&&(o.role==="employee"||o.role==="telecaller")){a(o.id),i("employeeClients"),y(!1);return}if(o&&o.role==="manager"){l(o.id),i("manager"),y(!1);return}h.get("/api/users").then(n=>{const C=n.data.users,M=C.filter(B=>B.role==="manager");x(M),c(C)}).catch(n=>console.error("Error fetching managers:",n)).finally(()=>y(!1))}},[d]);const N=()=>{r("/dashboard"),j("/dashboard")};return v&&d==="list"?e.jsx("div",{className:"p-6",children:e.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-primary-600 mx-auto"})}):e.jsxs("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-6",children:[d==="list"&&e.jsxs(e.Fragment,{children:[e.jsxs("button",{onClick:N,className:"flex items-center text-primary-600 hover:text-primary-700 mb-4",children:[e.jsx(S,{size:20,className:"mr-2"}),"Back to Dashboard"]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6 mb-6",children:[e.jsx("div",{className:"card bg-gradient-to-br from-purple-50 to-purple-100 border-purple-200",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-purple-600",children:"Total Managers"}),e.jsx("p",{className:"text-3xl font-bold text-purple-900 mt-2",children:p.length})]}),e.jsx("div",{className:"p-3 bg-purple-200 rounded-full",children:e.jsx("svg",{className:"w-8 h-8 text-purple-600",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 4.354a4 4 0 110 5.292M15 21H3v-1a6 6 0 0112 0v1zm0 0h6v-1a6 6 0 00-9-5.197M13 7a4 4 0 11-8 0 4 4 0 018 0z"})})})]})}),e.jsx("div",{className:"card bg-gradient-to-br from-blue-50 to-blue-100 border-blue-200",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-blue-600",children:"Total Employees"}),e.jsx("p",{className:"text-3xl font-bold text-blue-900 mt-2",children:m.filter(n=>n.role==="employee"||n.role==="telecaller").length})]}),e.jsx("div",{className:"p-3 bg-blue-200 rounded-full",children:e.jsx("svg",{className:"w-8 h-8 text-blue-600",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M17 20h5v-2a3 3 0 00-5.356-1.857M17 20H7m10 0v-2c0-.656-.126-1.283-.356-1.857M7 20H2v-2a3 3 0 015.356-1.857M7 20v-2c0-.656.126-1.283.356-1.857m0 0a5.002 5.002 0 019.288 0M15 7a3 3 0 11-6 0 3 3 0 016 0zm6 3a2 2 0 11-4 0 2 2 0 014 0zM7 10a2 2 0 11-4 0 2 2 0 014 0z"})})})]})}),e.jsx("div",{className:"card bg-gradient-to-br from-green-50 to-green-100 border-green-200",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-green-600",children:"Active Users"}),e.jsx("p",{className:"text-3xl font-bold text-green-900 mt-2",children:m.filter(n=>n.isActive).length})]}),e.jsx("div",{className:"p-3 bg-green-200 rounded-full",children:e.jsx("svg",{className:"w-8 h-8 text-green-600",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"})})})]})})]}),e.jsxs("div",{className:"card",children:[e.jsxs("div",{className:"flex items-center justify-between mb-6",children:[e.jsx("h1",{className:"text-2xl font-bold",children:"Managers"}),e.jsxs("div",{className:"text-right",children:[e.jsx("div",{className:"text-3xl font-bold text-primary-600",children:p.length}),e.jsx("div",{className:"text-sm text-gray-500",children:"Total Managers"})]})]}),p.length===0?e.jsxs("div",{className:"text-center py-12",children:[e.jsx("div",{className:"text-gray-400 mb-4",children:e.jsx("svg",{className:"mx-auto h-12 w-12",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 4.354a4 4 0 110 5.292M15 21H3v-1a6 6 0 0112 0v1zm0 0h6v-1a6 6 0 00-9-5.197M13 7a4 4 0 11-8 0 4 4 0 018 0z"})})}),e.jsx("p",{className:"text-gray-500 text-lg",children:"No managers found"})]}):e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"min-w-full divide-y divide-gray-200",children:[e.jsx("thead",{className:"bg-gray-50",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Name"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Email"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Role"})]})}),e.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:p.map(n=>e.jsxs("tr",{onClick:()=>{l(n.id),i("manager")},className:"hover:bg-gray-50 transition-colors cursor-pointer",children:[e.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:e.jsx("div",{className:"font-semibold text-gray-900 capitalize",children:n.name})}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:e.jsx("div",{className:"text-sm text-gray-600",children:n.email})}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:e.jsx("span",{className:"px-2 py-1 bg-purple-100 text-purple-700 rounded-full text-xs font-medium capitalize",children:n.role})})]},n.id))})]})})]})]}),d==="manager"&&e.jsx(Y,{onBack:o.role==="superadmin"?()=>i("list"):N,onEmployees:()=>i("managerEmployees"),onClients:()=>i("managerClients")}),d==="managerEmployees"&&e.jsx(q,{onBack:()=>i("manager"),onEmployeeClick:n=>{a(n),i("employeeClients")}}),d==="managerClients"&&e.jsx(G,{onBack:()=>i("manager")}),d==="employeeClients"&&e.jsx(J,{onBack:o&&(o.role==="employee"||o.role==="telecaller")?N:()=>i("managerEmployees")})]})}export{Z as default};
//# sourceMappingURL=HierarchyPage-BEr3WZqa.js.map
